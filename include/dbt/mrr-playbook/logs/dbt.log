

============================== 2022-12-01 01:55:48.840545 | e6cddb33-bc45-46f7-b07d-3fbb8bd2c93c ==============================
[0m01:55:48.840595 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:55:48.841891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m01:55:48.844024 [debug] [MainThread]: Tracking: tracking
[0m01:55:48.850791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37340>]}
[0m01:55:48.855627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37640>]}
[0m01:55:48.857167 [debug] [MainThread]: Flushing usage events
[0m01:55:49.275563 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2022-12-01 02:09:37.269576 | 6290eefc-feae-40b3-93b2-edab578a8787 ==============================
[0m02:09:37.269616 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:09:37.271961 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:09:37.274100 [debug] [MainThread]: Tracking: tracking
[0m02:09:37.292786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574ccd0>]}
[0m02:09:37.304506 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q5d9u8e9'
[0m02:09:37.306748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:09:37.674153 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:09:37.677131 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:09:37.943728 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:09:38.038432 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:09:43.624593 [info ] [MainThread]:   Installed from version 0.8.0
[0m02:09:43.630891 [info ] [MainThread]:   Updated version available: 0.9.6
[0m02:09:43.684100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6290eefc-feae-40b3-93b2-edab578a8787', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b57ef730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b57ef160>]}
[0m02:09:43.701392 [info ] [MainThread]: 
[0m02:09:43.707435 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:09:43.719130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5828f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5870a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cdc0>]}
[0m02:09:43.721787 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:09:48.309461 | eb86baf6-fcbe-47a5-95ab-a8adb7bad675 ==============================
[0m02:09:48.309512 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:09:48.310757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:09:48.312482 [debug] [MainThread]: Tracking: tracking
[0m02:09:48.321540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efb2b0>]}
[0m02:09:48.396370 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m02:09:48.398818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50b72d820>]}
[0m02:09:49.044295 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:09:49.049648 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:09:49.090957 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:09:49.097052 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:09:49.101204 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:09:49.104948 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:09:49.108131 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:09:49.109679 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:09:49.112469 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:09:49.114745 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:09:49.117296 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:09:49.129938 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:09:49.133613 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:09:49.137401 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:09:49.142014 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:09:49.145231 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:09:49.149089 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:09:49.151335 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:09:49.154045 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:09:49.155932 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:09:49.157755 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:09:49.167633 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:09:49.176741 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:09:49.191452 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:09:49.195432 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:09:49.198493 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:09:49.203907 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:09:49.206049 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:09:49.208251 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:09:49.210316 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:09:49.215647 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:09:49.218533 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:09:49.222500 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:09:49.233298 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:09:49.236050 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:09:49.238181 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:09:49.240334 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:09:49.242264 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:09:49.244994 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:09:49.247026 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:09:49.249735 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:09:49.252094 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:09:49.254930 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:09:49.260207 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:09:49.263474 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:09:49.266255 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:09:49.268347 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:09:49.270777 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:09:49.286729 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:09:49.350205 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:09:49.357753 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:09:49.367468 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:09:49.399673 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:09:49.406746 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:09:49.427137 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:09:49.440407 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:09:49.454176 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:09:49.472195 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:09:49.488091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:09:49.501938 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:09:49.523846 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:09:49.552040 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:09:49.570064 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:09:49.626621 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:09:49.633818 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:09:49.668021 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:09:49.691532 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:09:49.695348 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:09:49.702756 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:09:49.716062 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:09:49.729168 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:09:49.754871 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:09:49.781070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:09:49.804803 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:09:49.810263 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:09:49.816549 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:09:49.820331 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:09:49.828414 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:09:49.874247 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:09:49.893855 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:09:49.901945 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:09:49.919516 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:09:49.922156 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:09:49.926742 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:09:49.929844 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:09:49.935963 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:09:49.944529 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:09:49.948661 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:09:49.954068 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:09:49.973700 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:09:49.977156 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:09:49.980734 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:09:49.989098 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:09:49.992906 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:09:50.000994 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:09:50.004734 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:09:50.007816 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:09:50.012662 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:09:50.016054 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:09:50.021171 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:09:50.024698 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:09:50.028036 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:09:50.038876 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:09:50.043101 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:09:50.046112 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:09:50.048828 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:09:50.052000 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:09:50.094536 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:09:50.100331 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:09:50.103216 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:09:50.107007 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:09:50.110015 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:09:50.116398 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:09:50.120800 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:09:50.124754 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:09:50.141238 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:09:50.146241 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:09:50.150010 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:09:50.154008 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:09:50.157077 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:09:50.160902 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:09:50.166398 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:09:50.169286 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:09:50.172248 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:09:50.177170 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:09:50.185550 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:09:50.192795 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:09:50.202425 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:09:50.206573 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:09:50.213333 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:09:50.220886 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:09:50.231663 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:09:50.235558 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:09:50.238562 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:09:50.248450 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:09:50.252176 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:09:50.255464 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:09:50.262305 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:09:50.266328 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:09:50.272757 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:09:50.278816 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:09:50.292439 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:09:50.306375 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:09:50.310658 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:09:50.314315 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:09:50.866669 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:09:50.890069 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:09:50.895196 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:09:50.914145 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:09:50.927247 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:09:50.930760 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:09:50.970076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:09:51.213980 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:09:51.353404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509e1c2b0>]}
[0m02:09:51.398090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509f6ba30>]}
[0m02:09:51.399634 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:09:51.401244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509eadf10>]}
[0m02:09:51.403268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509f22c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509e60cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509dfa040>]}
[0m02:09:51.404408 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:44:15.479655 | 118d2093-5442-4087-afa3-04e104429da0 ==============================
[0m02:44:15.479691 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:44:15.482769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m02:44:15.485912 [debug] [MainThread]: Tracking: tracking
[0m02:44:15.502873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31db80>]}
[0m02:44:15.785171 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:44:15.788791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa2d5730>]}
[0m02:44:16.133258 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:44:16.136310 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:44:16.178139 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:44:16.183284 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:44:16.186680 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:44:16.189957 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:16.193261 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:16.194832 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:16.197395 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:16.199225 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:16.201423 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:16.214962 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:44:16.218160 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:44:16.221407 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:44:16.226281 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:44:16.229341 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:44:16.232175 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:44:16.234522 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:44:16.237180 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:44:16.239095 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:44:16.240745 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:44:16.250759 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:44:16.259953 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:44:16.273793 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:44:16.276915 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:44:16.279426 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:16.283624 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:44:16.285911 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:44:16.287851 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:16.290031 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:16.293263 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:16.295892 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:16.299555 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:44:16.309838 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:44:16.312814 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:44:16.315156 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:44:16.317575 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:44:16.319412 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:44:16.321770 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:44:16.323469 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:16.326216 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:44:16.328449 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:44:16.331381 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:44:16.333311 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:44:16.335782 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:44:16.337883 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:44:16.339870 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:44:16.342073 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:44:16.357102 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:44:16.381653 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:44:16.386431 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:44:16.391512 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:44:16.413467 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:44:16.419038 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:44:16.431286 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:44:16.439127 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:44:16.445734 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:44:16.449881 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:44:16.456091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:44:16.462409 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:44:16.473066 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:44:16.487103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:44:16.498120 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:44:16.540565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:44:16.544353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:44:16.650433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:44:16.671226 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:44:16.674976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:44:16.715630 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:44:16.722453 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:44:16.732380 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:44:16.756156 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:44:16.781754 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:44:16.800879 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:44:16.804796 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:44:16.808097 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:44:16.811451 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:44:16.818613 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:44:16.848874 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:44:16.860468 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:44:16.866511 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:44:16.869995 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:44:16.872291 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:44:16.875055 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:44:16.877005 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:44:16.882321 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:44:16.890423 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:44:16.893802 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:44:16.898502 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:44:16.915493 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:44:16.918749 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:44:16.921398 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:44:16.924204 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:44:16.926585 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:44:16.932322 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:44:16.935384 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:44:16.937635 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:44:16.940381 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:44:16.943058 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:44:16.946893 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:44:16.950374 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:44:16.955878 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:44:16.969613 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:44:16.972570 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:44:16.975019 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:44:16.977698 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:44:16.980362 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:44:17.021486 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:44:17.027171 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:44:17.029972 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:44:17.033811 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:44:17.037583 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:44:17.050510 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:44:17.054800 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:44:17.058649 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:44:17.078393 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:44:17.083402 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:44:17.087054 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:44:17.092281 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:44:17.096070 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:44:17.100365 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:44:17.105135 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:44:17.107970 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:44:17.110987 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:44:17.115954 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:44:17.123271 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:44:17.130700 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:44:17.138974 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:44:17.143810 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:44:17.149483 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:44:17.155094 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:44:17.165534 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:44:17.168970 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:44:17.171722 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:44:17.181661 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:44:17.185535 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:44:17.188722 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:44:17.195512 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:44:17.198542 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:44:17.205624 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:44:17.212537 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:44:17.228889 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:44:17.243371 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:44:17.247121 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:44:17.250519 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:44:17.792036 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:44:17.814310 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:44:17.819326 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:44:17.836354 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:44:17.855860 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:44:17.859693 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:44:17.903256 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:44:18.116095 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:44:18.237648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf962c0d0>]}
[0m02:44:18.270387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa310bb0>]}
[0m02:44:18.271823 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:44:18.274266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa3145e0>]}
[0m02:44:18.277504 [info ] [MainThread]: 
[0m02:44:18.279332 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:18.281436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:44:18.290512 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:44:18.292393 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:44:18.293807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:18.306356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:44:18.309693 [debug] [ThreadPool]: On list_*****: Close
[0m02:44:18.313052 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:44:18.322177 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:18.323329 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:44:18.324554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:18.329818 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:44:18.331145 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:18.332213 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:18.337887 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.0 seconds
[0m02:44:18.341750 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:44:18.343235 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:44:18.352058 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.353562 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.355070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:18.361448 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:18.362812 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.363969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:18.374930 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:44:18.378203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf96695e0>]}
[0m02:44:18.379582 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:18.381895 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.383007 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.385252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:18.386493 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.387585 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.388622 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.389818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.390850 [debug] [MainThread]: On master: Close
[0m02:44:18.392430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:18.394421 [info ] [MainThread]: 
[0m02:44:18.415627 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m02:44:18.417196 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m02:44:18.418967 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m02:44:18.420185 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m02:44:18.421426 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.422636 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m02:44:18.477769 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.479073 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m02:44:18.480005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:18.505065 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
[0m02:44:18.519934 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.529045 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m02:44:18.536951 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
[0m02:44:18.743297 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.746785 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m02:44:18.751343 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m02:44:18.761106 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m02:44:18.801095 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m02:44:18.802902 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.804208 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m02:44:18.806125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.807887 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.809366 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m02:44:18.811535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf9493490>]}
[0m02:44:18.813090 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.39s]
[0m02:44:18.815939 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m02:44:18.820260 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:18.821766 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.822730 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.823801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:18.848040 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:44:18.851115 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.852514 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.853865 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.855902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.857045 [debug] [MainThread]: On master: Close
[0m02:44:18.859039 [info ] [MainThread]: 
[0m02:44:18.860565 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m02:44:18.861658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:18.862676 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m02:44:18.884965 [info ] [MainThread]: 
[0m02:44:18.886419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:18.887983 [info ] [MainThread]: 
[0m02:44:18.889333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:44:18.890575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1e3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf962c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf949a550>]}
[0m02:44:18.891755 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:44:23.286518 | d7123607-9abe-412c-b02c-cfad4c01e134 ==============================
[0m02:44:23.286544 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:44:23.287604 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:44:23.288755 [debug] [MainThread]: Tracking: tracking
[0m02:44:23.297180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92b20>]}
[0m02:44:23.374408 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:44:23.376049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa74ff10>]}
[0m02:44:23.485650 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:44:23.488491 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:44:23.532302 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:44:23.537973 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:44:23.541743 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:44:23.545092 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:23.548022 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:23.549423 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:23.551908 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:23.553415 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:23.555429 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:23.566992 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:44:23.569635 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:44:23.572703 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:44:23.576871 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:44:23.580235 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:44:23.583202 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:44:23.585193 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:44:23.588573 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:44:23.590748 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:44:23.592517 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:44:23.605238 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:44:23.613791 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:44:23.627438 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:44:23.630079 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:44:23.632403 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:23.636281 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:44:23.638430 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:44:23.640576 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:23.642763 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:23.647680 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:23.650240 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:23.653814 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:44:23.663943 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:44:23.667039 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:44:23.669385 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:44:23.671398 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:44:23.673531 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:44:23.676204 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:44:23.678444 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:23.681395 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:44:23.683857 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:44:23.687020 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:44:23.689569 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:44:23.694039 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:44:23.698633 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:44:23.701935 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:44:23.705115 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:44:23.722572 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:44:23.747511 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:44:23.751875 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:44:23.756204 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:44:23.775992 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:44:23.780386 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:44:23.792399 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:44:23.800168 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:44:23.805477 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:44:23.809593 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:44:23.815999 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:44:23.821904 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:44:23.835828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:44:23.851093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:44:23.868594 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:44:23.916316 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:44:23.921576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:44:23.950109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:44:23.970335 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:44:23.973989 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:44:23.977970 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:44:23.983728 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:44:23.992678 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:44:24.015809 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:44:24.040434 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:44:24.060238 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:44:24.064005 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:44:24.067341 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:44:24.070396 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:44:24.077358 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:44:24.108996 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:44:24.121065 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:44:24.126287 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:44:24.130038 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:44:24.132557 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:44:24.135199 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:44:24.137140 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:44:24.142575 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:44:24.151781 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:44:24.155307 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:44:24.161077 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:44:24.180046 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:44:24.183401 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:44:24.186088 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:44:24.188973 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:44:24.191130 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:44:24.197210 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:44:24.200206 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:44:24.202333 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:44:24.205687 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:44:24.208732 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:44:24.214319 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:44:24.218355 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:44:24.221700 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:44:24.231133 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:44:24.233727 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:44:24.236075 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:44:24.238316 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:44:24.240816 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:44:24.280108 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:44:24.286042 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:44:24.288686 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:44:24.292629 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:44:24.295890 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:44:24.301858 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:44:24.305732 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:44:24.310643 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:44:24.326833 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:44:24.332564 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:44:24.335354 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:44:24.339107 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:44:24.342259 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:44:24.346060 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:44:24.351591 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:44:24.354430 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:44:24.357149 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:44:24.362640 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:44:24.370681 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:44:24.378084 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:44:24.386948 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:44:24.391174 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:44:24.396782 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:44:24.402600 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:44:24.413384 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:44:24.416893 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:44:24.419398 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:44:24.428554 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:44:24.432049 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:44:24.435730 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:44:24.441930 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:44:24.446040 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:44:24.452332 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:44:24.458450 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:44:24.471138 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:44:24.484453 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:44:24.495327 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:44:24.500674 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:44:25.163662 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:44:25.179745 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:44:25.184348 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:44:25.200052 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:44:25.215766 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:44:25.219021 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:44:25.264277 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:44:25.488764 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:44:25.636772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a82c90d0>]}
[0m02:44:25.640965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92b20>]}
[0m02:44:25.642690 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:44:25.644723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f00580>]}
[0m02:44:25.648084 [info ] [MainThread]: 
[0m02:44:25.650196 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:25.652411 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:44:25.663398 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:44:25.665054 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:44:25.666461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:25.674672 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:44:25.678690 [debug] [ThreadPool]: On list_*****: Close
[0m02:44:25.682783 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:44:25.694190 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:25.695812 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:44:25.697156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:25.702849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.704271 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:25.705395 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:25.709647 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m02:44:25.714451 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:44:25.716230 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:44:25.726012 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.727625 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.729069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:25.735878 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.737374 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.738628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:25.747765 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:44:25.750870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a82c3a90>]}
[0m02:44:25.752631 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:25.753957 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.755090 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.756727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:25.757889 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.759437 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.760388 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.761827 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:25.762978 [debug] [MainThread]: On master: Close
[0m02:44:25.764501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:25.766219 [info ] [MainThread]: 
[0m02:44:25.786936 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:44:25.789427 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:44:25.793286 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:44:25.795141 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:44:25.797013 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:44:25.829265 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.831042 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:44:25.834046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:25.842035 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.843698 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.845088 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01')::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01')::date))
    


[0m02:44:25.851511 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:44:25.855031 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m02:44:25.875802 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:25.876966 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m02:44:25.935874 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m02:44:25.946119 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.947121 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01' + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m02:44:25.952016 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type interval: "2018-01-01"
LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
             ^

[0m02:44:25.953226 [debug] [Thread-1  ]: On model.acme.util_months: ROLLBACK
[0m02:44:25.955124 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:25.956065 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:44:25.957319 [debug] [Thread-1  ]: Database Error in model util_months (models/utils/util_months.sql)
  invalid input syntax for type interval: "2018-01-01"
  LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
               ^
  compiled Code at target/run/acme/models/utils/util_months.sql
[0m02:44:25.958351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8259640>]}
[0m02:44:25.959455 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.util_months ........................ [[31mERROR[0m in 0.17s]
[0m02:44:25.960772 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:44:25.963221 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:25.964451 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.965494 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.966543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:25.972189 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.973369 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.974629 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.975779 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.977215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:25.978269 [debug] [MainThread]: On master: Close
[0m02:44:25.980013 [info ] [MainThread]: 
[0m02:44:25.981552 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:44:25.983078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:25.984337 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:44:25.985837 [info ] [MainThread]: 
[0m02:44:25.987114 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:44:25.988390 [info ] [MainThread]: 
[0m02:44:25.989560 [error] [MainThread]: [33mDatabase Error in model util_months (models/utils/util_months.sql)[0m
[0m02:44:25.990759 [error] [MainThread]:   invalid input syntax for type interval: "2018-01-01"
[0m02:44:25.992165 [error] [MainThread]:   LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
[0m02:44:25.993329 [error] [MainThread]:                ^
[0m02:44:25.994686 [error] [MainThread]:   compiled Code at target/run/acme/models/utils/util_months.sql
[0m02:44:25.996574 [info ] [MainThread]: 
[0m02:44:25.997841 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:44:25.999581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f2130>]}
[0m02:44:26.000853 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:28.016393 | 9bfe17d8-6e50-445c-9e21-73b13be45daa ==============================
[0m02:46:28.016427 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:28.017891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:46:28.019056 [debug] [MainThread]: Tracking: tracking
[0m02:46:28.028556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7ca0>]}
[0m02:46:28.032009 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d0__o6mr'
[0m02:46:28.033568 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:46:28.357198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:46:28.359853 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:46:28.597476 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:46:28.692949 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:46:31.853028 [info ] [MainThread]:   Installed from version 0.8.0
[0m02:46:31.856011 [info ] [MainThread]:   Updated version available: 0.9.6
[0m02:46:31.859978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bfe17d8-6e50-445c-9e21-73b13be45daa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a58068280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a581d3d90>]}
[0m02:46:31.862108 [info ] [MainThread]: 
[0m02:46:31.863829 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:46:31.866225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a58068220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580680a0>]}
[0m02:46:31.867829 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:35.513186 | c7b233d7-08b3-460f-8a37-65b699a51cd9 ==============================
[0m02:46:35.513215 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:35.514178 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:46:35.515244 [debug] [MainThread]: Tracking: tracking
[0m02:46:35.523297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c2b0>]}
[0m02:46:35.611636 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:46:35.615829 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:46:35.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c5e0>]}
[0m02:46:35.813123 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:46:35.817852 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:46:35.862345 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:46:35.866765 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:46:35.870190 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:46:35.873914 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:35.877274 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:35.878780 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:35.881161 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:35.882653 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:35.884941 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:35.896413 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:46:35.898692 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:46:35.901728 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:46:35.905893 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:46:35.909146 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:46:35.912039 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:46:35.914112 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:46:35.916691 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:46:35.918481 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:46:35.920647 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:46:35.931447 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:46:35.939634 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:46:35.953506 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:46:35.960135 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:46:35.962510 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:35.967362 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:46:35.969899 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:46:35.971850 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:35.974014 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:35.977623 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:35.980194 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:35.984235 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:46:35.994153 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:46:35.997152 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:46:35.999658 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:46:36.002191 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:46:36.004502 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:46:36.006767 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:46:36.009579 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:36.012630 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:46:36.015404 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:46:36.019274 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:46:36.022168 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:46:36.025322 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:46:36.028551 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:46:36.032015 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:46:36.036302 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:46:36.059290 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:46:36.093258 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:46:36.108045 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:46:36.114324 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:46:36.139179 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:46:36.147237 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:46:36.179613 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:46:36.210700 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:46:36.228073 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:46:36.234408 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:46:36.242944 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:46:36.252636 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:46:36.264845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:46:36.280791 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:46:36.292253 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:46:36.320829 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:46:36.324193 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:46:36.349845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:46:36.365900 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:46:36.368832 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:46:36.372385 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:46:36.378001 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:46:36.387442 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:46:36.409697 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:46:36.439409 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:46:36.464944 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:46:36.468940 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:46:36.472282 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:46:36.476033 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:46:36.483264 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:46:36.513625 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:46:36.524868 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:46:36.530328 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:46:36.534171 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:46:36.536382 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:46:36.538936 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:46:36.541184 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:46:36.547460 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:46:36.555749 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:46:36.558794 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:46:36.563804 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:46:36.580780 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:46:36.583185 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:46:36.586797 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:46:36.590026 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:46:36.592799 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:46:36.598385 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:46:36.600936 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:46:36.602959 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:46:36.605782 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:46:36.608364 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:46:36.612989 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:46:36.616311 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:46:36.619669 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:46:36.628544 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:46:36.631273 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:46:36.633386 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:46:36.635848 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:46:36.638150 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:46:36.676726 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:46:36.682047 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:46:36.685028 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:46:36.688901 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:46:36.691986 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:46:36.698121 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:46:36.701298 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:46:36.704929 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:46:36.720481 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:46:36.726070 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:46:36.729017 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:46:36.733372 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:46:36.736803 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:46:36.740486 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:46:36.745230 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:46:36.748256 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:46:36.750852 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:46:36.756080 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:46:36.764046 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:46:36.772060 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:46:36.780995 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:46:36.785186 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:46:36.790672 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:46:36.796780 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:46:36.808582 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:46:36.812086 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:46:36.814639 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:46:36.830187 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:46:36.833669 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:46:36.837076 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:46:36.843797 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:46:36.847175 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:46:36.854362 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:46:36.861381 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:46:36.876988 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:46:36.890748 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:46:36.894951 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:46:36.897898 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:46:37.390374 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:46:37.406145 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:46:37.413338 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:46:37.427952 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:46:37.439706 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:46:37.442926 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:46:37.481449 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:46:37.685081 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:46:37.799629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c25210d0>]}
[0m02:46:37.823428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c315f790>]}
[0m02:46:37.825063 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:46:37.826676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c24a0ee0>]}
[0m02:46:37.829028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c31d19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c24a0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c30bbb80>]}
[0m02:46:37.830325 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:58.578001 | 9c2e196c-e2cc-436f-bd8f-bddae5d4eadc ==============================
[0m02:46:58.578027 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:58.579352 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:46:58.580707 [debug] [MainThread]: Tracking: tracking
[0m02:46:58.586623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad7629af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9730>]}
[0m02:46:58.679907 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:46:58.682125 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:46:58.685067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad3a6e700>]}
[0m02:46:58.793894 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:46:58.797147 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:46:58.836890 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:46:58.843275 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:46:58.846382 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:46:58.849933 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:58.852861 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:58.854209 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:58.856754 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:58.858755 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:58.860916 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:58.872159 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:46:58.875539 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:46:58.879381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:46:58.883533 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:46:58.886381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:46:58.888950 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:46:58.891133 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:46:58.894011 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:46:58.896022 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:46:58.897581 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:46:58.908073 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:46:58.916203 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:46:58.930358 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:46:58.933094 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:46:58.935443 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:58.939430 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:46:58.941936 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:46:58.944335 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:58.946663 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:58.949862 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:58.952411 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:58.955940 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:46:58.965861 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:46:58.968893 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:46:58.971395 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:46:58.973631 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:46:58.976536 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:46:58.979916 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:46:58.982396 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:58.984825 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:46:58.986939 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:46:58.989716 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:46:58.991955 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:46:58.994429 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:46:58.996638 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:46:58.998459 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:46:59.000521 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:46:59.014900 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:46:59.039065 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:46:59.045004 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:46:59.049893 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:46:59.070554 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:46:59.075532 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:46:59.087250 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:46:59.095116 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:46:59.100394 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:46:59.106628 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:46:59.113709 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:46:59.119535 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:46:59.129149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:46:59.142825 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:46:59.153980 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:46:59.183260 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:46:59.186431 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:46:59.211152 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:46:59.227606 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:46:59.230607 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:46:59.234320 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:46:59.239775 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:46:59.250002 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:46:59.273439 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:46:59.298500 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:46:59.317073 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:46:59.320904 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:46:59.324227 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:46:59.327889 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:46:59.334811 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:46:59.365880 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:46:59.377274 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:46:59.382508 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:46:59.386037 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:46:59.388502 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:46:59.391204 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:46:59.393934 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:46:59.400251 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:46:59.408375 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:46:59.411926 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:46:59.416576 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:46:59.434242 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:46:59.437794 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:46:59.440997 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:46:59.444393 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:46:59.446713 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:46:59.452042 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:46:59.454507 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:46:59.456455 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:46:59.459851 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:46:59.462468 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:46:59.466218 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:46:59.469334 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:46:59.472392 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:46:59.481317 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:46:59.484071 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:46:59.486705 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:46:59.489311 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:46:59.492014 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:46:59.531401 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:46:59.536113 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:46:59.538447 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:46:59.541924 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:46:59.545275 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:46:59.550739 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:46:59.553781 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:46:59.556832 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:46:59.572569 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:46:59.576945 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:46:59.579537 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:46:59.583290 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:46:59.586263 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:46:59.589809 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:46:59.594391 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:46:59.597106 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:46:59.599783 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:46:59.604521 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:46:59.612059 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:46:59.619377 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:46:59.627720 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:46:59.631935 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:46:59.637347 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:46:59.643171 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:46:59.653289 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:46:59.656640 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:46:59.659400 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:46:59.669095 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:46:59.672277 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:46:59.675625 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:46:59.682427 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:46:59.685539 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:46:59.692759 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:46:59.698278 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:46:59.711143 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:46:59.723794 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:46:59.727586 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:46:59.731025 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:47:00.226162 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:47:00.241532 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:47:00.246092 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:47:00.260807 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:47:00.271998 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:47:00.275049 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:47:00.313941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:47:00.512804 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:47:00.647057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad15e10d0>]}
[0m02:47:00.650241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad2119df0>]}
[0m02:47:00.651382 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:47:00.652627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9640>]}
[0m02:47:00.655612 [info ] [MainThread]: 
[0m02:47:00.657207 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:47:00.659414 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:47:00.669076 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:47:00.670307 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:47:00.671603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:00.678761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:47:00.681421 [debug] [ThreadPool]: On list_*****: Close
[0m02:47:00.684451 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:47:00.695003 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:47:00.696397 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:47:00.697667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:00.707657 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.709090 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:47:00.710369 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:47:00.717803 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.01 seconds
[0m02:47:00.721554 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:47:00.723297 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:47:00.732362 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.733773 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.734850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:00.740462 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.743680 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.745854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:47:00.758650 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:47:00.762349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad15cea30>]}
[0m02:47:00.763860 [debug] [MainThread]: On master: ROLLBACK
[0m02:47:00.765226 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.766777 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.768453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:00.769641 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.770692 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.771727 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.772779 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:00.773790 [debug] [MainThread]: On master: Close
[0m02:47:00.775334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:47:00.777994 [info ] [MainThread]: 
[0m02:47:00.797186 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:47:00.798802 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:47:00.801272 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:47:00.802155 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:47:00.803352 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:47:00.830013 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:47:00.832652 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:47:00.834163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:00.840393 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.841932 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:47:00.843365 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', (2018-01-01)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', (2018-01-01)::date))
    


[0m02:47:00.847087 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot cast type integer to date
LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
                                                                ^

[0m02:47:00.848455 [debug] [Thread-1  ]: On model.acme.util_months: ROLLBACK
[0m02:47:00.851416 [debug] [Thread-1  ]: finished collecting timing info
[0m02:47:00.852781 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:47:00.854457 [debug] [Thread-1  ]: Database Error in model util_months (models/utils/util_months.sql)
  cannot cast type integer to date
  LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
                                                                  ^
[0m02:47:00.855915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ccba90>]}
[0m02:47:00.857342 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.util_months ........................ [[31mERROR[0m in 0.06s]
[0m02:47:00.859540 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:47:00.862607 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:47:00.863929 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.865025 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.866208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:47:00.872482 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.873874 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.875322 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.877071 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.879419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:00.881488 [debug] [MainThread]: On master: Close
[0m02:47:00.883288 [info ] [MainThread]: 
[0m02:47:00.884488 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m02:47:00.885797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:47:00.886942 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:47:00.888217 [info ] [MainThread]: 
[0m02:47:00.889547 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:47:00.890893 [info ] [MainThread]: 
[0m02:47:00.892115 [error] [MainThread]: [33mDatabase Error in model util_months (models/utils/util_months.sql)[0m
[0m02:47:00.893665 [error] [MainThread]:   cannot cast type integer to date
[0m02:47:00.895149 [error] [MainThread]:   LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
[0m02:47:00.896316 [error] [MainThread]:                                                                   ^
[0m02:47:00.897571 [info ] [MainThread]: 
[0m02:47:00.899452 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:47:00.900697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ce61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ce6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ccbcd0>]}
[0m02:47:00.901798 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:49:26.348495 | 8be1e5cc-a340-4c29-8934-58e332534b55 ==============================
[0m02:49:26.348548 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:26.350144 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:26.351060 [debug] [MainThread]: Tracking: tracking
[0m02:49:26.359118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0ab50>]}
[0m02:49:26.569065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:26.570287 [debug] [MainThread]: Partial parsing: updated file: acme://models/utils/util_months.sql
[0m02:49:26.593367 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:49:26.646287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:49:26.683886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d8500d0>]}
[0m02:49:26.687192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d922ca0>]}
[0m02:49:26.688652 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:49:26.689965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d8a4190>]}
[0m02:49:26.692482 [info ] [MainThread]: 
[0m02:49:26.694110 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:26.696436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:49:26.703724 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:49:26.704776 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:49:26.706279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:26.718448 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:49:26.721089 [debug] [ThreadPool]: On list_*****: Close
[0m02:49:26.724287 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:49:26.734085 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:26.735472 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:49:26.736613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:26.742724 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:49:26.744043 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:26.745496 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:49:26.749682 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m02:49:26.753290 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:49:26.754514 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:49:26.766713 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.767916 [debug] [MainThread]: On master: BEGIN
[0m02:49:26.768914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:26.779284 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:26.780695 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.781763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:26.801613 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m02:49:26.804517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d850c10>]}
[0m02:49:26.807548 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:26.808792 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.809974 [debug] [MainThread]: On master: BEGIN
[0m02:49:26.811481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:26.812696 [debug] [MainThread]: On master: COMMIT
[0m02:49:26.813686 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.814799 [debug] [MainThread]: On master: COMMIT
[0m02:49:26.816110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:26.817093 [debug] [MainThread]: On master: Close
[0m02:49:26.818529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:26.819509 [info ] [MainThread]: 
[0m02:49:26.835748 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:49:26.837421 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:49:26.839496 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:49:26.840720 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:49:26.841883 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:49:26.863365 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.865349 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:49:26.866714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:49:26.871416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:49:26.872493 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.873683 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m02:49:26.875409 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m02:49:26.878546 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m02:49:26.885329 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:26.886488 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m02:49:26.944741 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m02:49:26.950222 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.951563 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m02:49:26.963892 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:49:26.974350 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.975856 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m02:49:26.978346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:27.002917 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m02:49:27.004458 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:27.005553 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m02:49:27.007915 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:49:27.015507 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:27.016957 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m02:49:27.018647 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:49:27.021715 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:27.022998 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:49:27.024886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911cfcaf10>]}
[0m02:49:27.026292 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m02:49:27.027876 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:49:27.030813 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:27.031952 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:27.033084 [debug] [MainThread]: On master: BEGIN
[0m02:49:27.033979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:27.039215 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:27.040803 [debug] [MainThread]: On master: COMMIT
[0m02:49:27.041869 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:27.043051 [debug] [MainThread]: On master: COMMIT
[0m02:49:27.044613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:27.045740 [debug] [MainThread]: On master: Close
[0m02:49:27.047513 [info ] [MainThread]: 
[0m02:49:27.049119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:49:27.050527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:27.051715 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:49:27.053030 [info ] [MainThread]: 
[0m02:49:27.054519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:49:27.056003 [info ] [MainThread]: 
[0m02:49:27.057583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:49:27.059167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ff430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ffb20>]}
[0m02:49:27.060492 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:49:31.484535 | 0a3c389a-52e5-4c99-a284-1ec015968861 ==============================
[0m02:49:31.484567 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:31.486964 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:31.489646 [debug] [MainThread]: Tracking: tracking
[0m02:49:31.499390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01b50>]}
[0m02:49:31.740801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:49:31.742298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:49:31.752572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a6e0d0>]}
[0m02:49:31.755803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3ba7640>]}
[0m02:49:31.756970 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:49:31.758579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3ba7880>]}
[0m02:49:31.761723 [info ] [MainThread]: 
[0m02:49:31.763773 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:31.766308 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:49:31.784799 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:49:31.786273 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:49:31.787622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:31.795313 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:49:31.798690 [debug] [ThreadPool]: On list_*****: Close
[0m02:49:31.802742 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:49:31.815306 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:31.817090 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:49:31.818692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:31.824987 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:49:31.827121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:31.828621 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:49:31.834056 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:49:31.838015 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:49:31.839523 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:49:31.849411 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.851082 [debug] [MainThread]: On master: BEGIN
[0m02:49:31.852853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:31.858960 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:31.860362 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.861582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:31.871079 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:49:31.873923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3cff880>]}
[0m02:49:31.875437 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:31.877143 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.878587 [debug] [MainThread]: On master: BEGIN
[0m02:49:31.880503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:31.881892 [debug] [MainThread]: On master: COMMIT
[0m02:49:31.882993 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.884171 [debug] [MainThread]: On master: COMMIT
[0m02:49:31.885652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:31.886855 [debug] [MainThread]: On master: Close
[0m02:49:31.888560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:31.889683 [info ] [MainThread]: 
[0m02:49:31.911321 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:49:31.913285 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:49:31.915483 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:31.916771 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:49:31.918611 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:49:31.924674 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:49:31.929811 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:31.931236 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:49:31.989318 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:49:31.999208 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:32.000938 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:49:32.002470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:49:32.008761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:49:32.010740 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:32.011976 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when is_active then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when is_active then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        first_active_month = date_month as is_first_month,
        last_active_month = date_month as is_last_month

    from joined

)

select * from final
  );
[0m02:49:32.016135 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_active" does not exist
LINE 79:         min(case when is_active then date_month end) over (
                               ^

[0m02:49:32.018242 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:49:32.020052 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:32.021528 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:49:32.023478 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "is_active" does not exist
  LINE 79:         min(case when is_active then date_month end) over (
                                 ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:49:32.026854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a7c490>]}
[0m02:49:32.028988 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.11s]
[0m02:49:32.030905 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:49:32.035725 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:32.037564 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:32.038877 [debug] [MainThread]: On master: BEGIN
[0m02:49:32.040340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:32.048129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:32.050610 [debug] [MainThread]: On master: COMMIT
[0m02:49:32.053017 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:32.054333 [debug] [MainThread]: On master: COMMIT
[0m02:49:32.055958 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:32.057595 [debug] [MainThread]: On master: Close
[0m02:49:32.059837 [info ] [MainThread]: 
[0m02:49:32.062026 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m02:49:32.064135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:32.066280 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:49:32.068219 [info ] [MainThread]: 
[0m02:49:32.069774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:32.071480 [info ] [MainThread]: 
[0m02:49:32.073736 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:49:32.075511 [error] [MainThread]:   column "is_active" does not exist
[0m02:49:32.077730 [error] [MainThread]:   LINE 79:         min(case when is_active then date_month end) over (
[0m02:49:32.080907 [error] [MainThread]:                                  ^
[0m02:49:32.084795 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:49:32.087972 [info ] [MainThread]: 
[0m02:49:32.092327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:49:32.095288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3239340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3239d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a7c160>]}
[0m02:49:32.097735 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:51:56.804853 | 68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad ==============================
[0m02:51:56.804889 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:51:56.807294 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:56.808860 [debug] [MainThread]: Tracking: tracking
[0m02:51:56.814930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c7621af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c22a2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c22a2730>]}
[0m02:51:57.012835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:57.014160 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:51:57.038156 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:51:57.146182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c15349a0>]}
[0m02:51:57.149473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c20ebee0>]}
[0m02:51:57.151684 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:51:57.154004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c2037ee0>]}
[0m02:51:57.160983 [info ] [MainThread]: 
[0m02:51:57.165682 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:51:57.171504 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:51:57.194161 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:51:57.195908 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:51:57.197336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:57.208168 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:51:57.211440 [debug] [ThreadPool]: On list_*****: Close
[0m02:51:57.217336 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:51:57.228522 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:51:57.230311 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:51:57.231924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:57.238091 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.239546 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:51:57.240657 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:51:57.244721 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:51:57.248513 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:51:57.249902 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:51:57.260222 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.261774 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.263487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:57.275195 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.276895 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.278233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:51:57.299914 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m02:51:57.303129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c205cd90>]}
[0m02:51:57.304669 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:57.306064 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.307047 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.308885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:51:57.309965 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.311007 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.312370 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.313799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:57.314921 [debug] [MainThread]: On master: Close
[0m02:51:57.316634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:57.318021 [info ] [MainThread]: 
[0m02:51:57.338218 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:51:57.339754 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:51:57.342195 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.343542 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:51:57.344997 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:51:57.351853 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:51:57.356541 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:57.357922 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:51:57.420173 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:51:57.437997 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.439376 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:51:57.440655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:51:57.450694 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.465430 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.466967 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        first_active_month = date_month as is_first_month,
        last_active_month = date_month as is_last_month

    from joined

)

select * from final
  );
[0m02:51:57.506507 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "first_active_month" does not exist
LINE 88:         first_active_month = date_month as is_first_month,
                 ^

[0m02:51:57.537608 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:51:57.539942 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:57.541764 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:51:57.544026 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "first_active_month" does not exist
  LINE 88:         first_active_month = date_month as is_first_month,
                   ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:51:57.545539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c0ce9f70>]}
[0m02:51:57.547881 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.20s]
[0m02:51:57.549626 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:51:57.553189 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:51:57.554675 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.556033 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.557551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:57.563715 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.564987 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.566321 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.567624 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.569109 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:57.570475 [debug] [MainThread]: On master: Close
[0m02:51:57.572345 [info ] [MainThread]: 
[0m02:51:57.573745 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:51:57.575318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:57.576481 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:51:57.577706 [info ] [MainThread]: 
[0m02:51:57.579219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:57.580493 [info ] [MainThread]: 
[0m02:51:57.582084 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:51:57.583309 [error] [MainThread]:   column "first_active_month" does not exist
[0m02:51:57.584560 [error] [MainThread]:   LINE 88:         first_active_month = date_month as is_first_month,
[0m02:51:57.585804 [error] [MainThread]:                    ^
[0m02:51:57.587068 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:51:57.588260 [info ] [MainThread]: 
[0m02:51:57.589545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:51:57.590978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c1572a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c1572490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c0ce9ac0>]}
[0m02:51:57.592196 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:52:59.048139 | 4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c ==============================
[0m02:52:59.048196 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:52:59.049292 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:52:59.050317 [debug] [MainThread]: Tracking: tracking
[0m02:52:59.056599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3b50>]}
[0m02:52:59.245663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:52:59.247146 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:52:59.269591 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:52:59.374009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2088fd0>]}
[0m02:52:59.377306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2c26550>]}
[0m02:52:59.378561 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:52:59.379863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2b78f70>]}
[0m02:52:59.382929 [info ] [MainThread]: 
[0m02:52:59.384418 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:52:59.386622 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:52:59.403341 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:52:59.405111 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:52:59.406523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:59.413332 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:52:59.416225 [debug] [ThreadPool]: On list_*****: Close
[0m02:52:59.420244 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:52:59.438786 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:52:59.440821 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:52:59.442050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:59.447527 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.449056 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:52:59.450117 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:52:59.453776 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:52:59.458502 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:52:59.460512 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:52:59.469824 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.471638 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.472995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:59.478519 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.479966 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.481023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:52:59.492457 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:52:59.495639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2b9ceb0>]}
[0m02:52:59.497089 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:59.498384 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.499713 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.501419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:59.503130 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.504521 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.505923 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.507542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:59.509025 [debug] [MainThread]: On master: Close
[0m02:52:59.513652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:59.516590 [info ] [MainThread]: 
[0m02:52:59.536763 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:52:59.538693 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:52:59.541491 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.542849 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:52:59.544040 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:52:59.550250 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:52:59.554116 [debug] [Thread-1  ]: finished collecting timing info
[0m02:52:59.555554 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:52:59.615015 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:52:59.619455 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.620583 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:52:59.621594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:52:59.626797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.628529 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.629503 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when first_active_month = date_month then true
          else false end as is_first_month,
        case
          when last_active_month = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m02:52:59.632101 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "first_active_month" does not exist
LINE 89:           when first_active_month = date_month then true
                        ^

[0m02:52:59.633231 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:52:59.634691 [debug] [Thread-1  ]: finished collecting timing info
[0m02:52:59.635956 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:52:59.637540 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "first_active_month" does not exist
  LINE 89:           when first_active_month = date_month then true
                          ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:52:59.639231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff1829ac0>]}
[0m02:52:59.641249 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.10s]
[0m02:52:59.642763 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:52:59.646536 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:52:59.647862 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.649016 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.650090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:59.655914 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.657370 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.658445 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.659695 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.661201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:59.662295 [debug] [MainThread]: On master: Close
[0m02:52:59.663980 [info ] [MainThread]: 
[0m02:52:59.665133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:52:59.666428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:59.667495 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:52:59.668721 [info ] [MainThread]: 
[0m02:52:59.669962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:52:59.671464 [info ] [MainThread]: 
[0m02:52:59.672867 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:52:59.674268 [error] [MainThread]:   column "first_active_month" does not exist
[0m02:52:59.675642 [error] [MainThread]:   LINE 89:           when first_active_month = date_month then true
[0m02:52:59.676786 [error] [MainThread]:                           ^
[0m02:52:59.677991 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:52:59.679318 [info ] [MainThread]: 
[0m02:52:59.680489 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:52:59.681979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3190>]}
[0m02:52:59.683298 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:53:49.486996 | 91299223-e00b-48c2-8a69-55c2e1a8a0bb ==============================
[0m02:53:49.487029 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:53:49.488938 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:49.491233 [debug] [MainThread]: Tracking: tracking
[0m02:53:49.498190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513cb50>]}
[0m02:53:49.698146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:49.699495 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:53:49.721751 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:53:49.823069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f45eefd0>]}
[0m02:53:49.826711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4f77550>]}
[0m02:53:49.827993 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:53:49.829237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4ec9f70>]}
[0m02:53:49.833595 [info ] [MainThread]: 
[0m02:53:49.838026 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:49.842604 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:53:49.862607 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:53:49.864032 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:53:49.865895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:49.876094 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:53:49.879222 [debug] [ThreadPool]: On list_*****: Close
[0m02:53:49.885077 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:53:49.900287 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:49.902413 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:53:49.903901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:49.910110 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:53:49.911508 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:49.912866 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:49.916934 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:53:49.921264 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:53:49.923018 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:53:49.933927 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.936074 [debug] [MainThread]: On master: BEGIN
[0m02:53:49.937744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:49.944335 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:49.945984 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.947236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:49.960076 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:53:49.963052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4eedeb0>]}
[0m02:53:49.964415 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:49.965904 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.967031 [debug] [MainThread]: On master: BEGIN
[0m02:53:49.969125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:49.970721 [debug] [MainThread]: On master: COMMIT
[0m02:53:49.971889 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.973041 [debug] [MainThread]: On master: COMMIT
[0m02:53:49.974406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:49.975439 [debug] [MainThread]: On master: Close
[0m02:53:49.977060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:49.978317 [info ] [MainThread]: 
[0m02:53:49.999576 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:53:50.001402 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:53:50.003818 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.005536 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:53:50.007011 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:53:50.013427 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:53:50.034419 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:50.036130 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:53:50.107243 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:53:50.111819 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.112777 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:53:50.113876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:53:50.119565 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:53:50.121266 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.122730 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m02:53:50.128801 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:53:50.139947 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.141787 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m02:53:50.143816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:50.171481 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m02:53:50.174441 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.176105 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m02:53:50.180941 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:53:50.194859 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.197570 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m02:53:50.200970 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:53:50.206703 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:50.207888 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:53:50.209781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4572970>]}
[0m02:53:50.212383 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.21s]
[0m02:53:50.213567 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:53:50.216540 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:50.217946 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:50.219358 [debug] [MainThread]: On master: BEGIN
[0m02:53:50.220725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:50.226749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:50.228185 [debug] [MainThread]: On master: COMMIT
[0m02:53:50.229437 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:50.230613 [debug] [MainThread]: On master: COMMIT
[0m02:53:50.232119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:50.234970 [debug] [MainThread]: On master: Close
[0m02:53:50.237412 [info ] [MainThread]: 
[0m02:53:50.239296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:53:50.241731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:50.244319 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:53:50.246239 [info ] [MainThread]: 
[0m02:53:50.247787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:53:50.249252 [info ] [MainThread]: 
[0m02:53:50.251072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:53:50.252976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4594430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f45942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4594b20>]}
[0m02:53:50.254623 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:53:54.936531 | 882621ac-e923-4cda-85eb-a0de03201756 ==============================
[0m02:53:54.936573 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:53:54.938186 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:54.939972 [debug] [MainThread]: Tracking: tracking
[0m02:53:54.947691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548b50>]}
[0m02:53:55.126590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:53:55.127766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:53:55.136534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b50d0>]}
[0m02:53:55.140557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b3ec640>]}
[0m02:53:55.142471 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:53:55.144132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b3ec880>]}
[0m02:53:55.146681 [info ] [MainThread]: 
[0m02:53:55.148325 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:55.150289 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:53:55.180615 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:53:55.183667 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:53:55.185942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:55.198607 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:53:55.206239 [debug] [ThreadPool]: On list_*****: Close
[0m02:53:55.213154 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:53:55.245251 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:55.247796 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:53:55.249957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:55.259755 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.262247 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:55.264741 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:55.273076 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.01 seconds
[0m02:53:55.282296 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:53:55.284349 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:53:55.301193 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.303092 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.305417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:55.316263 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.319876 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.322104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:55.343946 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
[0m02:53:55.349137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b53f040>]}
[0m02:53:55.351581 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:55.354052 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.355983 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.358789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:55.361288 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.363352 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.364890 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.367281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:55.369724 [debug] [MainThread]: On master: Close
[0m02:53:55.372901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:55.375120 [info ] [MainThread]: 
[0m02:53:55.407592 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:53:55.410347 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:53:55.412941 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:53:55.414584 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:53:55.416399 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:53:55.425945 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:53:55.438040 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:55.440170 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:53:55.546772 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:53:55.553910 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:53:55.556004 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:53:55.558102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:53:55.568358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.570580 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:53:55.572825 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd(month, 1, date_month)::date as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:53:55.576744 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 14:         dateadd(month, 1, date_month)::date as date_month,
                         ^

[0m02:53:55.578421 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:53:55.580473 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:55.582106 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:53:55.584947 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  column "month" does not exist
  LINE 14:         dateadd(month, 1, date_month)::date as date_month,
                           ^
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:53:55.586989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2d2bb0>]}
[0m02:53:55.589086 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.17s]
[0m02:53:55.591473 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:53:55.597550 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:55.599560 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.601287 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.603007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:55.612365 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.614242 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.615876 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.617662 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.619812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:55.622100 [debug] [MainThread]: On master: Close
[0m02:53:55.624025 [info ] [MainThread]: 
[0m02:53:55.625464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m02:53:55.627257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:55.628706 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:53:55.630841 [info ] [MainThread]: 
[0m02:53:55.632514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:55.634689 [info ] [MainThread]: 
[0m02:53:55.636578 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:53:55.638763 [error] [MainThread]:   column "month" does not exist
[0m02:53:55.640941 [error] [MainThread]:   LINE 14:         dateadd(month, 1, date_month)::date as date_month,
[0m02:53:55.642937 [error] [MainThread]:                            ^
[0m02:53:55.644613 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:53:55.646425 [info ] [MainThread]: 
[0m02:53:55.648245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:53:55.650516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2d2070>]}
[0m02:53:55.657292 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:54:57.669217 | 15c7e76c-a97f-4c38-80a3-07256b847ba9 ==============================
[0m02:54:57.669289 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:54:57.674456 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:54:57.676314 [debug] [MainThread]: Tracking: tracking
[0m02:54:57.684363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7b5700>]}
[0m02:54:57.895973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:57.897376 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:54:57.920285 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:54:58.004580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9ceb0d0>]}
[0m02:54:58.007944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca606eb0>]}
[0m02:54:58.009303 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:54:58.011007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca554dc0>]}
[0m02:54:58.014382 [info ] [MainThread]: 
[0m02:54:58.016065 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:54:58.018211 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:54:58.034869 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:54:58.036292 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:54:58.037488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:58.046879 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:54:58.049816 [debug] [ThreadPool]: On list_*****: Close
[0m02:54:58.053172 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:54:58.062837 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:54:58.064401 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:54:58.065498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:58.071208 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.072591 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:54:58.073703 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:54:58.078675 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:54:58.082812 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:54:58.084335 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:54:58.093906 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.095816 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.099839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:58.107853 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.110195 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.112857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:58.127184 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:54:58.131002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca781b80>]}
[0m02:54:58.133184 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:58.140042 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.142749 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.148474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:58.150141 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.151741 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.152992 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.154732 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:58.156014 [debug] [MainThread]: On master: Close
[0m02:54:58.158470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:58.161352 [info ] [MainThread]: 
[0m02:54:58.184368 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:54:58.186234 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:54:58.188377 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:54:58.189464 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:54:58.190719 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:54:58.198687 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:54:58.204584 [debug] [Thread-1  ]: finished collecting timing info
[0m02:54:58.205897 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:54:58.263733 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:54:58.293203 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:54:58.295082 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:54:58.296523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:54:58.302014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.303896 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:54:58.307088 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd('month', 1, date_month)::date as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:54:58.309446 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function dateadd(unknown, integer, timestamp without time zone) does not exist
LINE 14:         dateadd('month', 1, date_month)::date as date_month,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:54:58.310919 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:54:58.312748 [debug] [Thread-1  ]: finished collecting timing info
[0m02:54:58.314065 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:54:58.316106 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  function dateadd(unknown, integer, timestamp without time zone) does not exist
  LINE 14:         dateadd('month', 1, date_month)::date as date_month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:54:58.317852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c894f0>]}
[0m02:54:58.318955 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.13s]
[0m02:54:58.320360 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:54:58.322865 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:54:58.323904 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.325013 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.326209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:58.331601 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.332934 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.334584 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.335643 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.336891 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:58.337878 [debug] [MainThread]: On master: Close
[0m02:54:58.339616 [info ] [MainThread]: 
[0m02:54:58.341375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:54:58.342643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:58.343889 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:54:58.345457 [info ] [MainThread]: 
[0m02:54:58.346789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:54:58.348115 [info ] [MainThread]: 
[0m02:54:58.349351 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:54:58.350560 [error] [MainThread]:   function dateadd(unknown, integer, timestamp without time zone) does not exist
[0m02:54:58.351565 [error] [MainThread]:   LINE 14:         dateadd('month', 1, date_month)::date as date_month,
[0m02:54:58.352599 [error] [MainThread]:                    ^
[0m02:54:58.353754 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:54:58.354959 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:54:58.356134 [info ] [MainThread]: 
[0m02:54:58.357105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:54:58.358341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c73bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c73520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c734f0>]}
[0m02:54:58.359511 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:56:30.419139 | 6800ef23-1357-4b05-80be-376d6d4c8940 ==============================
[0m02:56:30.419220 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:56:30.420044 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:56:30.422175 [debug] [MainThread]: Tracking: tracking
[0m02:56:30.427585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303cb20>]}
[0m02:56:30.603957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:56:30.605349 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:56:30.626818 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:56:30.701852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff23640d0>]}
[0m02:56:30.705128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e7e550>]}
[0m02:56:30.706733 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:56:30.708120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e84fd0>]}
[0m02:56:30.710504 [info ] [MainThread]: 
[0m02:56:30.712175 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:56:30.713951 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:56:30.729271 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:56:30.730599 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:56:30.731985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:30.737904 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:56:30.740517 [debug] [ThreadPool]: On list_*****: Close
[0m02:56:30.743360 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:56:30.752648 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:56:30.754109 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:56:30.755492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:30.760687 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:56:30.761975 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:56:30.763028 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:56:30.766549 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:56:30.770886 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:56:30.772426 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:56:30.780860 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.782117 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.783330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:30.788717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:56:30.790073 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.791263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:30.803560 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:56:30.806418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e7e400>]}
[0m02:56:30.807814 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:30.809060 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.810217 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.811800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.812967 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.814094 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.815216 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.816761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:30.817953 [debug] [MainThread]: On master: Close
[0m02:56:30.820633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:30.822094 [info ] [MainThread]: 
[0m02:56:30.837277 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:56:30.838684 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:56:30.840237 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:56:30.841169 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:56:30.842136 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:56:30.846358 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:56:30.849412 [debug] [Thread-1  ]: finished collecting timing info
[0m02:56:30.850663 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:56:30.901887 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:56:30.905951 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:56:30.907029 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:56:30.907948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:30.912437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.913552 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:56:30.914573 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd(month, 1, date_month::date) as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:56:30.916674 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 14:         dateadd(month, 1, date_month::date) as date_month,
                         ^

[0m02:56:30.917790 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:56:30.921302 [debug] [Thread-1  ]: finished collecting timing info
[0m02:56:30.923424 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:56:30.924917 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  column "month" does not exist
  LINE 14:         dateadd(month, 1, date_month::date) as date_month,
                           ^
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:56:30.926158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1a99f40>]}
[0m02:56:30.927520 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.09s]
[0m02:56:30.929030 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:56:30.931667 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:56:30.932972 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.934080 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.935304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:30.940279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.941631 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.942589 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.943662 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.945047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:30.946137 [debug] [MainThread]: On master: Close
[0m02:56:30.947729 [info ] [MainThread]: 
[0m02:56:30.949196 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:56:30.950691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:30.951718 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:56:30.952869 [info ] [MainThread]: 
[0m02:56:30.954337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:56:30.955756 [info ] [MainThread]: 
[0m02:56:30.957109 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:56:30.958532 [error] [MainThread]:   column "month" does not exist
[0m02:56:30.959884 [error] [MainThread]:   LINE 14:         dateadd(month, 1, date_month::date) as date_month,
[0m02:56:30.961040 [error] [MainThread]:                            ^
[0m02:56:30.962550 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:56:30.963626 [info ] [MainThread]: 
[0m02:56:30.964971 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:56:30.967451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff22fdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff22fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1a82f70>]}
[0m02:56:30.968746 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:57:38.006657 | e81cf26b-c5e9-44d6-84c7-fae1a91e1dff ==============================
[0m02:57:38.006684 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:57:38.008209 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:38.009840 [debug] [MainThread]: Tracking: tracking
[0m02:57:38.015382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544b20>]}
[0m02:57:38.212856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:57:38.214292 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:57:38.235782 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:57:38.312382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8686b0d0>]}
[0m02:57:38.315472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87386550>]}
[0m02:57:38.316783 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:57:38.318092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8738efd0>]}
[0m02:57:38.321272 [info ] [MainThread]: 
[0m02:57:38.323374 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:38.325655 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:57:38.342649 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:57:38.344405 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:57:38.345726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:38.352511 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:38.355598 [debug] [ThreadPool]: On list_*****: Close
[0m02:57:38.359023 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:57:38.368731 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:38.370129 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:57:38.371378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:38.377060 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.378345 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:38.379450 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:57:38.383105 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:57:38.386643 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:57:38.388222 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:57:38.397900 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.399266 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.400510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:38.406001 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.407729 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.409306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:38.418431 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:57:38.421639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87386400>]}
[0m02:57:38.423200 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:38.424716 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.425858 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.427541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:38.428518 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.429409 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.430612 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.432346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.433368 [debug] [MainThread]: On master: Close
[0m02:57:38.435456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:38.443274 [info ] [MainThread]: 
[0m02:57:38.465979 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:57:38.467725 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:57:38.469788 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:57:38.471755 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:57:38.473524 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:57:38.478920 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:57:38.482754 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:38.484230 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:57:38.551406 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:57:38.556054 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.557463 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:57:38.558888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:38.564598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.565700 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.566847 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:57:38.571355 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:57:38.580784 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.582568 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m02:57:38.584100 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:38.608413 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m02:57:38.610397 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.611403 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m02:57:38.613406 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.620638 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.621832 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m02:57:38.624086 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:57:38.626482 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:38.627448 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:57:38.628942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85f74fd0>]}
[0m02:57:38.630350 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.16s]
[0m02:57:38.631690 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:57:38.637116 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:38.640229 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.641931 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.643386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:38.648847 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.650074 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.651032 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.652122 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.653442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.654925 [debug] [MainThread]: On master: Close
[0m02:57:38.656543 [info ] [MainThread]: 
[0m02:57:38.658029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:57:38.659095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:38.659974 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:57:38.661151 [info ] [MainThread]: 
[0m02:57:38.662190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:38.663227 [info ] [MainThread]: 
[0m02:57:38.664473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:57:38.665767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85fa54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85fa5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85f9aca0>]}
[0m02:57:38.666905 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:57:43.705161 | a782aa2d-38b6-4ac3-8888-344a52799f27 ==============================
[0m02:57:43.705197 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:57:43.706496 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:43.707624 [debug] [MainThread]: Tracking: tracking
[0m02:57:43.714529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cdb20>]}
[0m02:57:43.886266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:57:43.887173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:57:43.896105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d623afd0>]}
[0m02:57:43.899321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d636f5e0>]}
[0m02:57:43.900406 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:57:43.901658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d636f820>]}
[0m02:57:43.904036 [info ] [MainThread]: 
[0m02:57:43.905541 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:43.907613 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:57:43.922159 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:57:43.924545 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:57:43.925851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:43.932040 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:43.934294 [debug] [ThreadPool]: On list_*****: Close
[0m02:57:43.937070 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:57:43.946371 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:43.947635 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:57:43.948932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:43.954414 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:57:43.955756 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:43.956980 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:57:43.960696 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m02:57:43.965216 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:57:43.967164 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:57:43.976937 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:43.978862 [debug] [MainThread]: On master: BEGIN
[0m02:57:43.980165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:43.985883 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:43.987283 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:43.988802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:43.999763 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:44.002443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d6499490>]}
[0m02:57:44.003950 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:44.005472 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.006722 [debug] [MainThread]: On master: BEGIN
[0m02:57:44.008464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.009654 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.011023 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.012269 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.013772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.015071 [debug] [MainThread]: On master: Close
[0m02:57:44.016623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:44.017853 [info ] [MainThread]: 
[0m02:57:44.036942 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m02:57:44.038663 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m02:57:44.040538 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m02:57:44.041867 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m02:57:44.043065 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m02:57:44.060050 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:57:44.072156 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m02:57:44.076328 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:44.078236 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m02:57:44.128024 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m02:57:44.132731 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:57:44.133708 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m02:57:44.134868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:44.139660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.140875 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:57:44.141870 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - previous_month_mrr as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m02:57:44.145051 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "previous_month_mrr" does not exist
LINE 30:         mrr - previous_month_mrr as mrr_change
                       ^

[0m02:57:44.146296 [debug] [Thread-1  ]: On model.acme.mrr: ROLLBACK
[0m02:57:44.147434 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:44.148402 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m02:57:44.150220 [debug] [Thread-1  ]: Database Error in model mrr (models/mrr.sql)
  column "previous_month_mrr" does not exist
  LINE 30:         mrr - previous_month_mrr as mrr_change
                         ^
  compiled Code at target/run/acme/models/mrr.sql
[0m02:57:44.151323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62468e0>]}
[0m02:57:44.152478 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.mrr ................................ [[31mERROR[0m in 0.11s]
[0m02:57:44.154141 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m02:57:44.156592 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:44.157708 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.158947 [debug] [MainThread]: On master: BEGIN
[0m02:57:44.159856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:44.164690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.165896 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.166966 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.167944 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.169093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.170246 [debug] [MainThread]: On master: Close
[0m02:57:44.171867 [info ] [MainThread]: 
[0m02:57:44.173719 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m02:57:44.175043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:44.176142 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m02:57:44.177438 [info ] [MainThread]: 
[0m02:57:44.179010 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:57:44.180174 [info ] [MainThread]: 
[0m02:57:44.181696 [error] [MainThread]: [33mDatabase Error in model mrr (models/mrr.sql)[0m
[0m02:57:44.182910 [error] [MainThread]:   column "previous_month_mrr" does not exist
[0m02:57:44.184164 [error] [MainThread]:   LINE 30:         mrr - previous_month_mrr as mrr_change
[0m02:57:44.185356 [error] [MainThread]:                          ^
[0m02:57:44.186489 [error] [MainThread]:   compiled Code at target/run/acme/models/mrr.sql
[0m02:57:44.187572 [info ] [MainThread]: 
[0m02:57:44.188603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:57:44.189646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d59c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62466d0>]}
[0m02:57:44.190717 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:58:46.063956 | 9974b9be-4c7c-4799-b27d-55f90f4428b7 ==============================
[0m02:58:46.063987 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:46.067322 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:58:46.068716 [debug] [MainThread]: Tracking: tracking
[0m02:58:46.078936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5b50>]}
[0m02:58:46.365834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:58:46.367445 [debug] [MainThread]: Partial parsing: updated file: acme://models/mrr.sql
[0m02:58:46.390101 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:58:46.414505 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:58:46.445849 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:58:46.584316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196770d0>]}
[0m02:58:46.587463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196ff400>]}
[0m02:58:46.588967 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:46.590265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1964bfd0>]}
[0m02:58:46.598692 [info ] [MainThread]: 
[0m02:58:46.601127 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:46.603434 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:58:46.620503 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:58:46.622194 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:58:46.623522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:46.631299 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:58:46.634526 [debug] [ThreadPool]: On list_*****: Close
[0m02:58:46.637710 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:46.649293 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:46.650714 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:46.651935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:46.657051 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.658289 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:46.659399 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:46.663765 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m02:58:46.668112 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:46.669899 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:46.678884 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.680574 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.682081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:46.688446 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.690063 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.691149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:46.702100 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m02:58:46.705129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196cd730>]}
[0m02:58:46.706558 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:46.708868 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.712471 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.714533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:46.716148 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.717590 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.718856 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.720262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.721788 [debug] [MainThread]: On master: Close
[0m02:58:46.723524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:46.724845 [info ] [MainThread]: 
[0m02:58:46.743139 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m02:58:46.744899 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m02:58:46.746889 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m02:58:46.748330 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m02:58:46.749823 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m02:58:46.756671 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:58:46.759906 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m02:58:46.766604 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:46.767986 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m02:58:46.822178 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m02:58:46.839016 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.840326 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m02:58:46.841547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:46.846605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.848151 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.849558 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m02:58:46.856287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:58:46.878097 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.879866 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m02:58:46.882319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:58:46.906736 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m02:58:46.908399 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.909504 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m02:58:46.912542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.920554 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.921692 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m02:58:46.923282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:58:46.925720 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:46.926916 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m02:58:46.928645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d1be80>]}
[0m02:58:46.929877 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.18s]
[0m02:58:46.931693 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m02:58:46.934726 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:46.935937 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.937066 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.937987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:46.942711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:46.943824 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.944973 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.945920 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.947172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.948167 [debug] [MainThread]: On master: Close
[0m02:58:46.950030 [info ] [MainThread]: 
[0m02:58:46.951182 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:58:46.952621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:46.953585 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m02:58:46.954705 [info ] [MainThread]: 
[0m02:58:46.955804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:46.956843 [info ] [MainThread]: 
[0m02:58:46.957893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:58:46.959028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d13610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d136a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d13790>]}
[0m02:58:46.960185 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:58:56.415066 | 6d54f8a0-b4cf-481a-b60f-22db2dc59a9e ==============================
[0m02:58:56.415095 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.417701 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.420986 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.431945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22b20>]}


============================== 2022-12-01 02:58:56.705314 | 1e085a1d-d729-4194-bb39-d29f357a68d2 ==============================
[0m02:58:56.705615 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.776751 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.786709 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.861070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92eab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92ea430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92eaac0>]}


============================== 2022-12-01 02:58:56.876464 | 9a8e7588-403c-41cb-8221-40db93c48d8a ==============================
[0m02:58:56.876725 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.880039 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.888964 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.907416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb91235af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8beac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8beac730>]}


============================== 2022-12-01 02:58:56.984086 | 60809037-edbb-4a68-8b54-f9f8c95ed283 ==============================
[0m02:58:56.984126 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.988163 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.993177 [debug] [MainThread]: Tracking: tracking
[0m02:58:57.003702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a8b50>]}
[0m02:58:57.250301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.252589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.268629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de7980d0>]}
[0m02:58:57.274434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1610>]}
[0m02:58:57.277397 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.279295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1850>]}
[0m02:58:57.284734 [info ] [MainThread]: 
[0m02:58:57.287186 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m02:58:57.290323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1430>]}
[0m02:58:57.292633 [debug] [MainThread]: Flushing usage events
[0m02:58:57.430832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.434905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.462625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bc21fa0>]}
[0m02:58:57.469095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a5b0>]}
[0m02:58:57.472233 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.474450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a7f0>]}
[0m02:58:57.480801 [info ] [MainThread]: 
[0m02:58:57.484189 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.491167 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.535598 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.538538 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.542752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.559403 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.560459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.560964 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.563954 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.562600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.568757 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m02:58:57.574119 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.576670 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.590306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a90590d0>]}
[0m02:58:57.590576 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.594948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e610>]}
[0m02:58:57.597700 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.600916 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.602187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.603758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e850>]}
[0m02:58:57.612242 [info ] [MainThread]: 
[0m02:58:57.611743 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.615570 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.615682 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.617338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.621255 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.630652 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m02:58:57.635612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a400>]}
[0m02:58:57.631042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.638795 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.641016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.642887 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.645024 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.647900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.648942 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.650479 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.652231 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.653704 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.655227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.656727 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.659258 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.661179 [debug] [MainThread]: On master: Close
[0m02:58:57.663512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.662534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5753314fa0>]}
[0m02:58:57.667397 [info ] [MainThread]: 
[0m02:58:57.664867 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.672872 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.675101 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.679073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c5b0>]}
[0m02:58:57.679848 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m02:58:57.680671 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.682540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c7f0>]}
[0m02:58:57.685436 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.685627 [info ] [MainThread]: 
[0m02:58:57.687229 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.688813 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.692283 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.693631 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m02:58:57.695546 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.696362 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.696507 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.698581 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.698623 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.700990 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.702164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.708008 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.709925 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.711068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.725115 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.728716 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m02:58:57.728853 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.732236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e3a0>]}
[0m02:58:57.733110 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.734914 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.736204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.737857 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.741135 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.750335 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.755531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.759307 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.757340 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.759971 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.760977 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.771433 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.774133 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.780210 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.787435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.798173 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.02 seconds
[0m02:58:57.798944 [debug] [MainThread]: On master: Close
[0m02:58:57.804787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.808555 [info ] [MainThread]: 
[0m02:58:57.807966 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.821096 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.824439 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.835021 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.836639 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.841996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.847298 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.852648 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m02:58:57.849662 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.861185 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m02:58:57.862419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:57.858699 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.865998 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.863791 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.867544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.868359 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.873352 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.885179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.887659 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.893229 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m02:58:57.893958 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m02:58:57.897300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c400>]}
[0m02:58:57.900280 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.902885 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.907415 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.909199 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:57.914463 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.909605 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.913993 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.915337 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m02:58:57.917821 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.919436 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m02:58:57.918534 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.945326 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.25s]
[0m02:58:57.946753 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.948665 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.950324 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.952188 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.953444 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.954975 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.954714 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m02:58:57.956437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.960265 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:57.960739 [debug] [MainThread]: On master: Close
[0m02:58:57.961994 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.964455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.967027 [info ] [MainThread]: 
[0m02:58:57.965039 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.966490 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.969738 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m02:58:57.971680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:57.980611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.981994 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:57.982460 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.985715 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m02:58:57.991387 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:57.993031 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m02:58:57.995698 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:57.997056 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.997485 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:57.998740 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:58.000349 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.006329 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.012409 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.013935 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m02:58:58.015100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.016386 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m02:58:58.021637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.023394 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.024251 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.024962 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:58:58.026616 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m02:58:58.029099 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.029617 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m02:58:58.035107 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.17s]
[0m02:58:58.037220 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:58.039381 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.039667 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.041367 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m02:58:58.043784 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.044568 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.045305 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.047040 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m02:58:58.083186 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.084863 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.088086 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m02:58:58.090511 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.093454 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.13s]
[0m02:58:58.097947 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:58.102563 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:58.104331 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.106114 [debug] [MainThread]: On master: BEGIN
[0m02:58:58.108020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:58.118227 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.120925 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.123213 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.125747 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.126248 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.134991 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m02:58:58.139394 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.190734 [debug] [MainThread]: On master: Close
[0m02:58:58.193935 [info ] [MainThread]: 
[0m02:58:58.196752 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m02:58:58.203367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:58.198502 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.199386 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.213397 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.210886 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m02:58:58.214282 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m02:58:58.222851 [info ] [MainThread]: 
[0m02:58:58.224964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.225741 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.228122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:58.232658 [info ] [MainThread]: 
[0m02:58:58.236076 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:58:58.237413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.239183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b3d9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b3990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b399040>]}
[0m02:58:58.240109 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.242426 [debug] [MainThread]: Flushing usage events
[0m02:58:58.243632 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:58:58.248078 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.254432 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.253591 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m02:58:58.257430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.262290 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.264640 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m02:58:58.265468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.266764 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m02:58:58.268427 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.271222 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:58:58.271443 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.28s]
[0m02:58:58.275635 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.282489 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:58.284553 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.286328 [debug] [MainThread]: On master: BEGIN
[0m02:58:58.287953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:58.291620 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.295372 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.296995 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.299023 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.297477 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m02:58:58.301272 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.303847 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.302596 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m02:58:58.305820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:58.308676 [debug] [MainThread]: On master: Close
[0m02:58:58.311583 [info ] [MainThread]: 
[0m02:58:58.307468 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.26s]
[0m02:58:58.313832 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:58:58.315692 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.320730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:58.322286 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.323342 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m02:58:58.325334 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m02:58:58.326603 [info ] [MainThread]: 
[0m02:58:58.328844 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.329389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:58.330288 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.332157 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.331393 [info ] [MainThread]: 
[0m02:58:58.334872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:58:58.336771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752acca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752a8b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752a8b040>]}
[0m02:58:58.339064 [debug] [MainThread]: Flushing usage events
[0m02:58:58.352566 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.361729 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.363299 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.372862 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.378942 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.380463 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m02:58:58.381880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.388569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.390262 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.391786 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m02:58:58.404519 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.408985 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.411035 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m02:58:58.413012 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m02:58:58.415388 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.09s]
[0m02:58:58.418477 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.420307 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.421768 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m02:58:58.424024 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.425470 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.427111 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.435119 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.447353 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.449380 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.455243 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.461313 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.463006 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m02:58:58.464611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.471812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.473676 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.475128 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m02:58:58.489876 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.493755 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.495432 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m02:58:58.497088 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m02:58:58.499495 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.08s]
[0m02:58:58.502235 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.503433 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.504641 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m02:58:58.506495 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.508108 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.509379 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.516781 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.528282 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.530049 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.534848 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.547237 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.548679 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m02:58:58.550155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.556920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.558679 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.559966 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m02:58:58.575958 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.581209 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.583347 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m02:58:58.585416 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m02:58:58.587457 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.08s]
[0m02:58:58.589485 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.591414 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.595462 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m02:58:58.598843 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.600679 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.602095 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.613151 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.620169 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.622187 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.628996 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.647919 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.649898 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m02:58:58.651746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.659442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.660987 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.662568 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m02:58:58.679717 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.685375 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.687622 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m02:58:58.689998 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m02:58:58.692563 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.10s]
[0m02:58:58.695028 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.696842 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.698462 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m02:58:58.700649 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.702352 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.704155 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.719411 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.727491 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.730234 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.737054 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.749050 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.751468 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m02:58:58.753437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.765224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.767535 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.769479 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m02:58:58.786583 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.792888 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.795671 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m02:58:58.797964 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m02:58:58.800547 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.10s]
[0m02:58:58.803163 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.805100 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.807009 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m02:58:58.809740 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.812261 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.813944 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.827519 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.848290 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.850714 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.859784 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.867929 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.871327 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m02:58:58.874830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.883276 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.885429 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.887231 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m02:58:58.903916 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.910960 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.914367 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m02:58:58.917500 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m02:58:58.920180 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.11s]
[0m02:58:58.929293 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.931449 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.933204 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m02:58:58.936291 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.938745 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.940725 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.950649 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.958392 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.960436 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.968288 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.977072 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.979171 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m02:58:58.980958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.990587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.992639 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.994244 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m02:58:59.018333 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:59.022339 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.024157 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m02:58:59.026257 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m02:58:59.029924 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.09s]
[0m02:58:59.032322 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:59.034004 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.035509 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m02:58:59.037864 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.060804 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.070937 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.086889 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.098494 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.099945 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.105006 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.111100 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.112712 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m02:58:59.114033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.120859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.122574 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.124463 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m02:58:59.141556 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.149898 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.152361 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m02:58:59.154142 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m02:58:59.156319 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.12s]
[0m02:58:59.158835 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.160525 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.162271 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m02:58:59.164680 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.166489 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.168239 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.180471 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.203839 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.209999 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.218077 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.227182 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.228816 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m02:58:59.230267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.246695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m02:58:59.248555 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.249954 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m02:58:59.266004 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.269632 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.271328 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m02:58:59.272877 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m02:58:59.275295 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.11s]
[0m02:58:59.278462 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.281308 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.282680 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m02:58:59.285060 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.287128 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.288589 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.298352 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.308906 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.310868 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.316047 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.327296 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.329752 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m02:58:59.330961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.337316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.338954 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.340243 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m02:58:59.354650 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.358100 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.359648 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m02:58:59.361865 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m02:58:59.363798 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.08s]
[0m02:58:59.365585 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.367179 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.369202 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m02:58:59.371449 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.372815 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.374076 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.382047 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.397505 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.398895 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.405113 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.410462 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.411666 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m02:58:59.413052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.418868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.420689 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.422140 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m02:58:59.437641 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.442334 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.443910 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m02:58:59.445551 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m02:58:59.448353 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.08s]
[0m02:58:59.453198 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.454876 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.456224 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m02:58:59.459020 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.460510 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.462474 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.470490 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.475990 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.477593 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.486953 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.497710 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.499264 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m02:58:59.500446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.506929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.508847 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.510092 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m02:58:59.525435 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.532339 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.534316 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m02:58:59.536084 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m02:58:59.538729 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.08s]
[0m02:58:59.541935 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.543537 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.545024 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m02:58:59.547558 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.548984 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.550159 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.562800 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.568293 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.569875 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.575638 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.599190 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.600819 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m02:58:59.602484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.609710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.611568 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.613132 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:58:59.635411 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:59.639352 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.642302 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m02:58:59.644472 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m02:58:59.646329 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.10s]
[0m02:58:59.648981 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.652363 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:59.653553 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:59.654723 [debug] [MainThread]: On master: BEGIN
[0m02:58:59.655870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:59.661557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.663125 [debug] [MainThread]: On master: COMMIT
[0m02:58:59.664365 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:59.665507 [debug] [MainThread]: On master: COMMIT
[0m02:58:59.666828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:59.668173 [debug] [MainThread]: On master: Close
[0m02:58:59.670150 [info ] [MainThread]: 
[0m02:58:59.671938 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m02:58:59.673840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:59.675906 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m02:58:59.678805 [info ] [MainThread]: 
[0m02:58:59.681634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:59.683353 [info ] [MainThread]: 
[0m02:58:59.684921 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m02:58:59.686382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87cebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87ceb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87ce4c0>]}
[0m02:58:59.687948 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:34.141526 | 6fbc2bcd-f9dd-469a-865a-f0cb013b2729 ==============================
[0m03:09:34.141561 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:34.143299 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m03:09:34.145302 [debug] [MainThread]: Tracking: tracking
[0m03:09:34.152972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c0ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c0eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c0eb80>]}
[0m03:09:34.231532 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:09:34.234256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558bd0fd0>]}
[0m03:09:34.349252 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m03:09:34.352463 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:09:34.393996 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:09:34.398953 [debug] [MainThread]: Parsing macros/relations.sql
[0m03:09:34.402433 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m03:09:34.406227 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:34.409862 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:34.411531 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:34.414113 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:34.416072 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:34.418332 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:34.429669 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m03:09:34.432609 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m03:09:34.435655 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:09:34.439628 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:09:34.442843 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:09:34.445691 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:09:34.447703 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:09:34.450316 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:09:34.452193 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:09:34.453973 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:09:34.463767 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:09:34.477216 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:09:34.491806 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:09:34.494933 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:09:34.498611 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:34.502710 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:09:34.504953 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:09:34.507039 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:34.509676 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:34.512961 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:34.515490 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:34.519187 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:09:34.529763 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:09:34.532889 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:09:34.535318 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:09:34.537656 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:09:34.539656 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:09:34.541897 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:09:34.543843 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:34.546488 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:09:34.548858 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:09:34.551749 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:09:34.553742 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:09:34.556035 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:09:34.558421 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:09:34.560559 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:09:34.562939 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:09:34.578435 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:09:34.602525 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:09:34.607539 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:09:34.613054 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:09:34.638645 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:09:34.642892 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:09:34.655056 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:09:34.663120 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:09:34.669003 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:09:34.674058 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:09:34.680699 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:09:34.687509 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:09:34.697261 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:09:34.710472 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:09:34.721579 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:09:34.752061 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:09:34.755912 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:09:34.784416 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:09:34.801750 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:09:34.806082 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:09:34.810863 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:09:34.817017 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:09:34.828520 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:09:34.854237 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:09:34.880360 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:09:34.899790 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:09:34.903996 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:09:34.908066 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:09:34.911580 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:09:34.918898 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:09:34.949403 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:09:34.962050 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:09:34.967572 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m03:09:34.971941 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m03:09:34.974626 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m03:09:34.978246 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m03:09:34.981883 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m03:09:34.988373 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m03:09:34.996816 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m03:09:35.000236 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m03:09:35.004901 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m03:09:35.022374 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m03:09:35.026133 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m03:09:35.029079 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m03:09:35.032245 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m03:09:35.034572 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m03:09:35.039886 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m03:09:35.043152 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m03:09:35.045411 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m03:09:35.048300 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m03:09:35.051934 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m03:09:35.061477 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m03:09:35.064980 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m03:09:35.068706 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m03:09:35.078399 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m03:09:35.081091 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m03:09:35.083887 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m03:09:35.086363 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m03:09:35.088877 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m03:09:35.128499 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m03:09:35.136566 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m03:09:35.140073 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m03:09:35.144899 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m03:09:35.148037 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m03:09:35.154484 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m03:09:35.158672 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m03:09:35.163645 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m03:09:35.182055 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m03:09:35.186897 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m03:09:35.189599 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m03:09:35.193641 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m03:09:35.196957 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m03:09:35.200896 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m03:09:35.205302 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m03:09:35.208585 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m03:09:35.211655 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m03:09:35.216982 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m03:09:35.225118 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m03:09:35.232871 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m03:09:35.241274 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m03:09:35.245789 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m03:09:35.251653 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m03:09:35.258000 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m03:09:35.269131 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m03:09:35.278401 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m03:09:35.282396 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m03:09:35.292196 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m03:09:35.296353 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m03:09:35.299774 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m03:09:35.306523 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m03:09:35.310376 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m03:09:35.317630 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m03:09:35.324481 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m03:09:35.345058 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m03:09:35.363639 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m03:09:35.367967 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m03:09:35.371933 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m03:09:35.881129 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m03:09:35.897748 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m03:09:35.902630 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m03:09:35.916902 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m03:09:35.930093 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m03:09:35.932873 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m03:09:35.970292 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m03:09:36.180822 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m03:09:36.303321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355812d0d0>]}
[0m03:09:36.343872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355a43a130>]}
[0m03:09:36.347238 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:36.348856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558c17bb0>]}
[0m03:09:36.352142 [info ] [MainThread]: 
[0m03:09:36.353943 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:36.356628 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:36.367961 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:36.369778 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:36.371415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:36.382808 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:36.386129 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:36.391202 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:36.402485 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:36.404083 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:36.405573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:36.412210 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.414062 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:36.415652 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:36.419893 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m03:09:36.424089 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:36.425984 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:36.436359 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.438197 [debug] [MainThread]: On master: BEGIN
[0m03:09:36.439711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:36.445705 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.447620 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.448963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:36.463315 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m03:09:36.466714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558144b20>]}
[0m03:09:36.468415 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:36.469978 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.471383 [debug] [MainThread]: On master: BEGIN
[0m03:09:36.474313 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:36.476776 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.478632 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.480496 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.482119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:36.483462 [debug] [MainThread]: On master: Close
[0m03:09:36.485485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:36.487634 [info ] [MainThread]: 
[0m03:09:36.508255 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m03:09:36.510039 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m03:09:36.512203 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m03:09:36.513781 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m03:09:36.515556 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:36.517040 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m03:09:36.579010 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.580699 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m03:09:36.582051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:36.587093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.588560 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.589561 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */
truncate table "*****"."public"."subscription_periods"
[0m03:09:36.592138 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m03:09:36.757560 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.760091 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m03:09:36.765301 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m03:09:36.773914 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m03:09:36.816290 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m03:09:36.817679 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m03:09:36.818805 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m03:09:36.822121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:36.823844 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:36.825102 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m03:09:36.826762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbc2bcd-f9dd-469a-865a-f0cb013b2729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354bd6a130>]}
[0m03:09:36.828007 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.31s]
[0m03:09:36.829398 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m03:09:36.832395 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:36.833690 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.834785 [debug] [MainThread]: On master: BEGIN
[0m03:09:36.835971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:36.841193 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:36.842882 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.844070 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:36.845279 [debug] [MainThread]: On master: COMMIT
[0m03:09:36.846592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:36.847732 [debug] [MainThread]: On master: Close
[0m03:09:36.849629 [info ] [MainThread]: 
[0m03:09:36.850967 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m03:09:36.852214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:36.853506 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m03:09:36.894106 [info ] [MainThread]: 
[0m03:09:36.896111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:36.897475 [info ] [MainThread]: 
[0m03:09:36.898779 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:36.900314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3558a7ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355812d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354bd6afa0>]}
[0m03:09:36.902125 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:41.896570 | 9cfc3218-4a1e-4a7a-8387-0845b30a971a ==============================
[0m03:09:41.896603 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:41.897816 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:09:41.899241 [debug] [MainThread]: Tracking: tracking
[0m03:09:41.906732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fcb20>]}
[0m03:09:42.000088 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m03:09:42.002624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f48c17c0>]}
[0m03:09:42.183160 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m03:09:42.187171 [debug] [MainThread]: Parsing macros/adapters.sql
[0m03:09:42.245970 [debug] [MainThread]: Parsing macros/catalog.sql
[0m03:09:42.252621 [debug] [MainThread]: Parsing macros/relations.sql
[0m03:09:42.257202 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m03:09:42.261947 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:42.266053 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:42.268289 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:42.273245 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:42.275874 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:42.278832 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:42.293738 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m03:09:42.297496 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m03:09:42.301604 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m03:09:42.307925 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m03:09:42.312339 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m03:09:42.316368 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m03:09:42.320297 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m03:09:42.323837 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m03:09:42.327152 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m03:09:42.331214 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m03:09:42.343674 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m03:09:42.358276 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m03:09:42.375313 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m03:09:42.378598 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m03:09:42.381854 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m03:09:42.387042 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m03:09:42.390059 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m03:09:42.392614 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m03:09:42.395266 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m03:09:42.400310 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m03:09:42.403595 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m03:09:42.408001 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m03:09:42.420824 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m03:09:42.424192 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m03:09:42.426862 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m03:09:42.429706 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m03:09:42.432003 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m03:09:42.437577 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m03:09:42.444525 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m03:09:42.450615 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m03:09:42.454263 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m03:09:42.458578 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m03:09:42.462367 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m03:09:42.466111 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m03:09:42.470088 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m03:09:42.473004 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m03:09:42.475967 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m03:09:42.498186 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m03:09:42.536280 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m03:09:42.549582 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m03:09:42.556261 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m03:09:42.582236 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m03:09:42.588752 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m03:09:42.609997 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m03:09:42.622498 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m03:09:42.631047 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m03:09:42.636312 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m03:09:42.644304 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m03:09:42.653833 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m03:09:42.668191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m03:09:42.685421 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m03:09:42.699116 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m03:09:42.731090 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m03:09:42.735224 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m03:09:42.761804 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m03:09:42.778995 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m03:09:42.782148 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m03:09:42.786132 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m03:09:42.791479 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m03:09:42.800506 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m03:09:42.823729 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m03:09:42.849815 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m03:09:42.871251 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m03:09:42.876308 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m03:09:42.880102 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m03:09:42.883489 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m03:09:42.891214 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m03:09:42.923835 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m03:09:42.938847 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m03:09:42.944670 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m03:09:42.948735 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m03:09:42.951350 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m03:09:42.954430 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m03:09:42.956635 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m03:09:42.962593 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m03:09:42.972194 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m03:09:42.975632 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m03:09:42.980750 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m03:09:42.997783 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m03:09:43.002130 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m03:09:43.005366 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m03:09:43.008589 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m03:09:43.011114 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m03:09:43.017623 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m03:09:43.020911 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m03:09:43.023360 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m03:09:43.027153 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m03:09:43.030513 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m03:09:43.035547 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m03:09:43.039424 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m03:09:43.043204 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m03:09:43.053747 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m03:09:43.057112 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m03:09:43.059714 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m03:09:43.062934 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m03:09:43.065755 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m03:09:43.109018 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m03:09:43.116055 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m03:09:43.120347 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m03:09:43.125423 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m03:09:43.142282 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m03:09:43.173538 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m03:09:43.187536 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m03:09:43.211722 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m03:09:43.268526 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m03:09:43.277865 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m03:09:43.282360 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m03:09:43.289153 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m03:09:43.298983 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m03:09:43.306058 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m03:09:43.313165 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m03:09:43.318916 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m03:09:43.324645 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m03:09:43.332549 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m03:09:43.343149 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m03:09:43.354057 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m03:09:43.365178 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m03:09:43.371887 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m03:09:43.379438 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m03:09:43.388003 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m03:09:43.401904 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m03:09:43.406399 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m03:09:43.410137 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m03:09:43.422289 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m03:09:43.426667 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m03:09:43.430659 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m03:09:43.438593 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m03:09:43.442487 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m03:09:43.450779 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m03:09:43.458636 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m03:09:43.478200 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m03:09:43.494258 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m03:09:43.498853 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m03:09:43.502706 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m03:09:44.113249 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m03:09:44.134604 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m03:09:44.140108 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m03:09:44.157894 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m03:09:44.171827 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m03:09:44.175407 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m03:09:44.224364 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m03:09:44.454829 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m03:09:44.590680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f24320d0>]}
[0m03:09:44.595918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f3002910>]}
[0m03:09:44.598556 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:44.600509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f30fc610>]}
[0m03:09:44.606951 [info ] [MainThread]: 
[0m03:09:44.609845 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:44.612830 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:44.623921 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:44.625952 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:44.627500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:44.639417 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:44.642869 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:44.647644 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:44.658352 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:44.660154 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:44.661363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:44.667872 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:09:44.669365 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:44.670773 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:44.675333 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m03:09:44.679430 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:44.683932 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:44.698850 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.700415 [debug] [MainThread]: On master: BEGIN
[0m03:09:44.701763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:44.707692 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:44.709361 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.710842 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:44.723197 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m03:09:44.726576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f2423a30>]}
[0m03:09:44.728286 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:44.730061 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.731764 [debug] [MainThread]: On master: BEGIN
[0m03:09:44.733615 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:44.734771 [debug] [MainThread]: On master: COMMIT
[0m03:09:44.736314 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:44.737632 [debug] [MainThread]: On master: COMMIT
[0m03:09:44.739637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:44.741559 [debug] [MainThread]: On master: Close
[0m03:09:44.743828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:44.745956 [info ] [MainThread]: 
[0m03:09:44.767728 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m03:09:44.770116 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m03:09:44.772892 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m03:09:44.774532 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m03:09:44.775899 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m03:09:44.802187 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.804110 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m03:09:44.805745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:44.812165 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:09:44.813792 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.815568 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m03:09:44.823809 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m03:09:44.828473 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m03:09:44.851712 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:44.853056 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m03:09:44.918718 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m03:09:44.925351 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.926795 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m03:09:44.944191 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
[0m03:09:44.953601 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.955204 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months" rename to "util_months__dbt_backup"
[0m03:09:44.957603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:44.961929 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.963117 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m03:09:44.964851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:44.990162 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m03:09:44.992017 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:44.993297 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m03:09:44.995238 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.002351 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m03:09:45.003619 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m03:09:45.011877 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
[0m03:09:45.014120 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:45.015145 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m03:09:45.016747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cfc3218-4a1e-4a7a-8387-0845b30a971a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f23afc10>]}
[0m03:09:45.017935 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.24s]
[0m03:09:45.019196 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m03:09:45.021715 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:45.022644 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:45.023499 [debug] [MainThread]: On master: BEGIN
[0m03:09:45.024350 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:45.028840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:45.029911 [debug] [MainThread]: On master: COMMIT
[0m03:09:45.030834 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:45.031697 [debug] [MainThread]: On master: COMMIT
[0m03:09:45.032658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:45.033514 [debug] [MainThread]: On master: Close
[0m03:09:45.034938 [info ] [MainThread]: 
[0m03:09:45.035971 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m03:09:45.037326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:45.038135 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m03:09:45.039128 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m03:09:45.040013 [info ] [MainThread]: 
[0m03:09:45.040988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:45.042036 [info ] [MainThread]: 
[0m03:09:45.043090 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:45.045097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f2435b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f13403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69f1340d30>]}
[0m03:09:45.046201 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:49.652502 | 20fdea3c-89d1-4c78-85ff-f75cd91c036d ==============================
[0m03:09:49.652529 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:49.653679 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:09:49.654837 [debug] [MainThread]: Tracking: tracking
[0m03:09:49.661001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b79cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b79af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b79b50>]}
[0m03:09:49.832387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:49.833395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:49.843330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0458ee0d0>]}
[0m03:09:49.846520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045a27640>]}
[0m03:09:49.847807 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:49.848978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045a27880>]}
[0m03:09:49.851643 [info ] [MainThread]: 
[0m03:09:49.853122 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:49.854916 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:49.869532 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:49.871383 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:49.872798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:49.884273 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:49.886745 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:49.889643 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:49.898662 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:49.899856 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:49.900854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:49.905459 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m03:09:49.906401 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:49.907145 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:49.910138 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m03:09:49.913160 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:49.914073 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:49.921824 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.923152 [debug] [MainThread]: On master: BEGIN
[0m03:09:49.924513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:49.929029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:49.930060 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.931936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:49.940752 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m03:09:49.943397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff045b7a880>]}
[0m03:09:49.945258 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:49.946500 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.947385 [debug] [MainThread]: On master: BEGIN
[0m03:09:49.948932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:49.950277 [debug] [MainThread]: On master: COMMIT
[0m03:09:49.951250 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:49.952214 [debug] [MainThread]: On master: COMMIT
[0m03:09:49.953297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:49.954363 [debug] [MainThread]: On master: Close
[0m03:09:49.955788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:49.957040 [info ] [MainThread]: 
[0m03:09:49.990695 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m03:09:49.992720 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m03:09:49.994652 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:49.996129 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m03:09:49.997414 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m03:09:50.007103 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m03:09:50.012599 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:50.013802 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m03:09:50.079497 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m03:09:50.085536 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.088404 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m03:09:50.089649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:50.094541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m03:09:50.095781 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.096791 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m03:09:50.103364 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:09:50.114319 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.115785 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m03:09:50.117322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:50.141232 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m03:09:50.143042 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.144230 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m03:09:50.146315 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:50.153815 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m03:09:50.155223 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m03:09:50.156709 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:09:50.158904 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:50.160004 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m03:09:50.162134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20fdea3c-89d1-4c78-85ff-f75cd91c036d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b6c70>]}
[0m03:09:50.163670 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.17s]
[0m03:09:50.165185 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m03:09:50.167650 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:50.168593 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:50.169410 [debug] [MainThread]: On master: BEGIN
[0m03:09:50.170348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:50.175141 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:50.176182 [debug] [MainThread]: On master: COMMIT
[0m03:09:50.177129 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:50.178032 [debug] [MainThread]: On master: COMMIT
[0m03:09:50.179120 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:50.180148 [debug] [MainThread]: On master: Close
[0m03:09:50.181504 [info ] [MainThread]: 
[0m03:09:50.182593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m03:09:50.183989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:50.184932 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m03:09:50.185950 [info ] [MainThread]: 
[0m03:09:50.186972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:50.188054 [info ] [MainThread]: 
[0m03:09:50.189133 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:50.190202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b92e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0450b9490>]}
[0m03:09:50.191268 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:09:54.308627 | 1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16 ==============================
[0m03:09:54.308654 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:09:54.310297 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:09:54.312109 [debug] [MainThread]: Tracking: tracking
[0m03:09:54.319394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affdb6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affdb6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affdb6ac0>]}
[0m03:09:54.536617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:09:54.538071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:09:54.547679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affb240d0>]}
[0m03:09:54.551552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affc61610>]}
[0m03:09:54.553087 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:09:54.554237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affc61850>]}
[0m03:09:54.557727 [info ] [MainThread]: 
[0m03:09:54.559293 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:54.561198 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:09:54.580768 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:09:54.582205 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:09:54.583293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:09:54.589405 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:09:54.591930 [debug] [ThreadPool]: On list_*****: Close
[0m03:09:54.594779 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:09:54.603875 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:54.605808 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:09:54.607019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:09:54.612512 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.614413 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:09:54.616069 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:09:54.619995 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m03:09:54.624565 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:09:54.626221 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:09:54.636210 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.637930 [debug] [MainThread]: On master: BEGIN
[0m03:09:54.639582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:09:54.645903 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.647242 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.648435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:09:54.657975 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m03:09:54.660708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affc61220>]}
[0m03:09:54.662775 [debug] [MainThread]: On master: ROLLBACK
[0m03:09:54.664266 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.665322 [debug] [MainThread]: On master: BEGIN
[0m03:09:54.667101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:09:54.668730 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.669980 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.671190 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.673090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:54.674296 [debug] [MainThread]: On master: Close
[0m03:09:54.676221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:09:54.678121 [info ] [MainThread]: 
[0m03:09:54.704883 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m03:09:54.707010 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m03:09:54.709327 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m03:09:54.710944 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m03:09:54.712579 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m03:09:54.719579 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m03:09:54.727278 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:54.729038 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m03:09:54.803234 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m03:09:54.808931 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.810190 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m03:09:54.811629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:09:54.817255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.818804 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.820225 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m03:09:54.825270 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m03:09:54.835673 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.837820 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m03:09:54.841046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:09:54.865499 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m03:09:54.867588 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.868687 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m03:09:54.871756 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:09:54.879714 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m03:09:54.881523 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m03:09:54.883735 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:09:54.886055 [debug] [Thread-1  ]: finished collecting timing info
[0m03:09:54.887657 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m03:09:54.889568 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e9848fa-6bd7-41a3-8e2a-4c88d2d71f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aff2de4f0>]}
[0m03:09:54.891667 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.18s]
[0m03:09:54.893211 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m03:09:54.896155 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:09:54.897523 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.898501 [debug] [MainThread]: On master: BEGIN
[0m03:09:54.899827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:09:54.905173 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:09:54.906605 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.907736 [debug] [MainThread]: Using ***** connection "master"
[0m03:09:54.908861 [debug] [MainThread]: On master: COMMIT
[0m03:09:54.910155 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:09:54.911421 [debug] [MainThread]: On master: Close
[0m03:09:54.913167 [info ] [MainThread]: 
[0m03:09:54.914368 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m03:09:54.915717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:09:54.916845 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m03:09:54.917954 [info ] [MainThread]: 
[0m03:09:54.919610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:09:54.920953 [info ] [MainThread]: 
[0m03:09:54.922256 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:09:54.923684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9aff2de4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affb41ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9affb411c0>]}
[0m03:09:54.924982 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:10:00.610570 | e27d793a-d5cd-48d0-b9b4-81a38f96d1d2 ==============================
[0m03:10:00.610602 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:00.612609 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m03:10:00.614596 [debug] [MainThread]: Tracking: tracking
[0m03:10:00.623217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1aa5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1aa5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1aa5ac0>]}
[0m03:10:00.836621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:00.838017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:00.877743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a18120d0>]}
[0m03:10:00.883324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1950610>]}
[0m03:10:00.885193 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:00.886535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1950850>]}
[0m03:10:00.889540 [info ] [MainThread]: 
[0m03:10:00.891328 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:00.893326 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m03:10:00.908248 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m03:10:00.909873 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m03:10:00.911242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:00.918853 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m03:10:00.921529 [debug] [ThreadPool]: On list_*****: Close
[0m03:10:00.924241 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:00.933016 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:00.934788 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:00.936075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:10:00.942061 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:10:00.943353 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:00.944405 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:00.948235 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m03:10:00.951848 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:00.953370 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:00.963287 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:00.964811 [debug] [MainThread]: On master: BEGIN
[0m03:10:00.965942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:00.971501 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:00.973000 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:00.974435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:00.987907 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m03:10:00.990921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a1950220>]}
[0m03:10:00.992674 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:00.994188 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:00.995426 [debug] [MainThread]: On master: BEGIN
[0m03:10:00.997207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:00.998768 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.001756 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:01.003154 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.004789 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:01.005968 [debug] [MainThread]: On master: Close
[0m03:10:01.007871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:01.009124 [info ] [MainThread]: 
[0m03:10:01.028328 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m03:10:01.029852 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m03:10:01.032168 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m03:10:01.034667 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m03:10:01.035995 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m03:10:01.056668 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m03:10:01.068985 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m03:10:01.076812 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:01.078148 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m03:10:01.133038 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m03:10:01.139391 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.142201 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m03:10:01.144652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:01.150356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:01.151831 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.153679 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m03:10:01.159996 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m03:10:01.168409 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.169765 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m03:10:01.171539 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m03:10:01.197857 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m03:10:01.199515 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.200783 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m03:10:01.202689 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m03:10:01.212007 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m03:10:01.213312 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m03:10:01.214909 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m03:10:01.217172 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:01.218297 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m03:10:01.219985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e27d793a-d5cd-48d0-b9b4-81a38f96d1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0f80850>]}
[0m03:10:01.221288 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.19s]
[0m03:10:01.222872 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m03:10:01.225939 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:01.227505 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:01.228820 [debug] [MainThread]: On master: BEGIN
[0m03:10:01.230174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:01.237109 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:01.238864 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.240591 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:01.241850 [debug] [MainThread]: On master: COMMIT
[0m03:10:01.243750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:01.244922 [debug] [MainThread]: On master: Close
[0m03:10:01.246659 [info ] [MainThread]: 
[0m03:10:01.247964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m03:10:01.249182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:01.250230 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m03:10:01.251504 [info ] [MainThread]: 
[0m03:10:01.252899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:01.254242 [info ] [MainThread]: 
[0m03:10:01.255396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:10:01.256904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a181f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a181f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a181f460>]}
[0m03:10:01.258273 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 03:10:07.327189 | 543afeeb-4b11-4bbe-abcf-03895e6580dd ==============================
[0m03:10:07.327218 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.328533 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.330381 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.336542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39662d6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39662d6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39662d6b20>]}


============================== 2022-12-01 03:10:07.530228 | cf844e58-58ca-4ed0-8abc-fa0484fe06b9 ==============================
[0m03:10:07.530260 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.532065 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.534133 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.556085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf52ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf52e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf52eb20>]}


============================== 2022-12-01 03:10:07.630458 | a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2 ==============================
[0m03:10:07.630505 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.632761 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.637172 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.668356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4b50>]}


============================== 2022-12-01 03:10:07.700807 | 826dfcf4-6f89-4f7b-9427-5a4145a1dc31 ==============================
[0m03:10:07.700839 [info ] [MainThread]: Running with dbt=1.3.1
[0m03:10:07.703175 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m03:10:07.708341 [debug] [MainThread]: Tracking: tracking
[0m03:10:07.741753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b8718cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b8718af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b8718b50>]}
[0m03:10:07.823823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:07.829512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:07.880766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3966043fd0>]}
[0m03:10:07.892962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396616f5e0>]}
[0m03:10:07.895934 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:07.898503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396616f820>]}
[0m03:10:07.907436 [info ] [MainThread]: 
[0m03:10:07.911117 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:07.917088 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:07.944744 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:07.947355 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:07.949071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:07.961191 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m03:10:07.962897 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:07.964778 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:07.974927 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.01 seconds
[0m03:10:07.983380 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:07.992037 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:08.026345 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.029635 [debug] [MainThread]: On master: BEGIN
[0m03:10:08.033475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:08.047264 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:08.064080 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.078606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:08.141524 [debug] [MainThread]: SQL status: SELECT 8 in 0.05 seconds
[0m03:10:08.160854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '543afeeb-4b11-4bbe-abcf-03895e6580dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396616f430>]}
[0m03:10:08.178127 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:08.187657 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.190879 [debug] [MainThread]: On master: BEGIN
[0m03:10:08.197597 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:08.202165 [debug] [MainThread]: On master: COMMIT
[0m03:10:08.205491 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.212165 [debug] [MainThread]: On master: COMMIT
[0m03:10:08.219639 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:08.225885 [debug] [MainThread]: On master: Close
[0m03:10:08.236386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:08.246302 [info ] [MainThread]: 
[0m03:10:08.314065 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.319718 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m03:10:08.327472 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.332559 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.336680 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.337474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:08.342688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:08.393577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf844e58-58ca-4ed0-8abc-fa0484fe06b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf29c0d0>]}
[0m03:10:08.407891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:08.412682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:08.413629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf844e58-58ca-4ed0-8abc-fa0484fe06b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c9670>]}
[0m03:10:08.420696 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:08.423725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf844e58-58ca-4ed0-8abc-fa0484fe06b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c98b0>]}
[0m03:10:08.425550 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.458366 [info ] [MainThread]: 
[0m03:10:08.464580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da4310d0>]}
[0m03:10:08.466744 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m03:10:08.478524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da5706a0>]}
[0m03:10:08.475853 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:08.484399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:10:08.483532 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:08.478246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fbf3c94f0>]}
[0m03:10:08.496930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:10:08.490773 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:08.498801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da5708e0>]}
[0m03:10:08.501792 [debug] [MainThread]: Flushing usage events
[0m03:10:08.564818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b84850d0>]}
[0m03:10:08.579822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b859c640>]}
[0m03:10:08.576499 [info ] [MainThread]: 
[0m03:10:08.638740 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m03:10:08.654375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b859c880>]}
[0m03:10:08.648171 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:08.658928 [info ] [MainThread]: 
[0m03:10:08.662003 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:08.670458 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:08.755382 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m03:10:08.795091 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.799254 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:08.805432 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.803557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:08.807081 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m03:10:08.815776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:10:08.809444 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.866276 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.868467 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m03:10:08.872354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:08.870563 [debug] [ThreadPool]: SQL status: BEGIN in 0.07 seconds
[0m03:10:08.874075 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m03:10:08.876409 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.880756 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m03:10:08.884782 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:08.907336 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m03:10:08.932991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
[0m03:10:08.935684 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m03:10:08.935657 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m03:10:08.937729 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m03:10:08.939180 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.02 seconds
[0m03:10:08.942489 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:08.944704 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:08.948228 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m03:10:08.951869 [debug] [ThreadPool]: On list_*****_public: Close
[0m03:10:08.985326 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:08.996011 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.006598 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.07 seconds
[0m03:10:09.009130 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.017189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:09.000724 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.017803 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:09.021179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:10:09.030371 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m03:10:09.074471 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m03:10:09.077591 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.75s]
[0m03:10:09.080878 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m03:10:09.084150 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.087365 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:10:09.087144 [debug] [MainThread]: SQL status: BEGIN in 0.07 seconds
[0m03:10:09.090364 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.088114 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m03:10:09.089505 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.094795 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.092741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:09.096364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:10:09.098802 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.108201 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.122744 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m03:10:09.126733 [debug] [MainThread]: SQL status: SELECT 8 in 0.03 seconds
[0m03:10:09.135735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '826dfcf4-6f89-4f7b-9427-5a4145a1dc31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b859c3d0>]}
[0m03:10:09.134312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3a4ece7-c101-4e8d-ab19-54a1e9d0d8b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44da6c4730>]}
[0m03:10:09.139477 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:09.142436 [debug] [MainThread]: On master: ROLLBACK
[0m03:10:09.147790 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.154825 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.152569 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.166068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:09.167758 [debug] [MainThread]: On master: BEGIN
[0m03:10:09.174559 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.182698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m03:10:09.185904 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.224192 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.215880 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.250089 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.264729 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:09.269556 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:09.316258 [debug] [MainThread]: On master: COMMIT
[0m03:10:09.317093 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.324602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:09.330313 [debug] [MainThread]: On master: Close
[0m03:10:09.330275 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:09.334414 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.340075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:09.336807 [debug] [MainThread]: On master: Close
[0m03:10:09.344114 [info ] [MainThread]: 
[0m03:10:09.346836 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.434946 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m03:10:09.506565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:09.493480 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:10:09.516878 [info ] [MainThread]: 
[0m03:10:09.624907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.11 seconds
[0m03:10:09.643627 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m03:10:09.670587 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m03:10:09.678767 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:09.700499 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m03:10:09.730589 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:09.736603 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:09.740227 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:09.736931 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.06 seconds
[0m03:10:09.777868 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:09.782174 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m03:10:09.786301 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m03:10:09.793329 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.70s]
[0m03:10:09.870205 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:09.874261 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m03:10:09.938010 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m03:10:09.932147 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.023795 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m03:10:10.048601 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.054588 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:10.053177 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.060429 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.060538 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:10.063104 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.157640 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.186295 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.192577 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.199659 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.227184 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:10.201246 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.272030 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.288423 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.289390 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.293174 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:10.381755 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.384868 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m03:10:10.388083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:10.431220 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
[0m03:10:10.450575 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m03:10:10.463080 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m03:10:10.478019 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.571730 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.11 seconds
[0m03:10:10.631858 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.664510 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.669332 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m03:10:10.671709 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m03:10:10.673492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:10.676157 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m03:10:10.718527 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.67s]
[0m03:10:10.726412 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m03:10:10.730054 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:10.736431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
[0m03:10:10.753884 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m03:10:10.745836 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m03:10:10.772740 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m03:10:10.777389 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.778234 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:10.795104 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:10.836219 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:10.843002 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m03:10:10.825463 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:10.868915 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:10.878143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:10.917520 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:10.925856 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m03:10:10.930484 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m03:10:10.979621 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 1.27s]
[0m03:10:10.980204 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:10.995440 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m03:10:10.996812 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.001000 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.003466 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:11.004088 [debug] [Thread-1  ]: SQL status: BEGIN in 0.14 seconds
[0m03:10:11.006803 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m03:10:11.005048 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m03:10:11.034461 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m03:10:11.058203 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:11.058841 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.063578 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.066309 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:11.068056 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.069478 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m03:10:11.073545 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.080014 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:11.118828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
[0m03:10:11.122067 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m03:10:11.131201 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m03:10:11.163444 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.177062 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.180802 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.209176 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.07 seconds
[0m03:10:11.222404 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.225131 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m03:10:11.227731 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.230468 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m03:10:11.237093 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.46s]
[0m03:10:11.241872 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m03:10:11.245612 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.248267 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m03:10:11.245186 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.248409 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.253906 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m03:10:11.253492 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.258563 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m03:10:11.260340 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.267144 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.255706 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m03:10:11.269546 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 1.28s]
[0m03:10:11.273472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.278753 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m03:10:11.293513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m03:10:11.315890 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:11.329268 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m03:10:11.343779 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:10:11.324415 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.331513 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.363624 [debug] [MainThread]: On master: BEGIN
[0m03:10:11.364120 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:11.367053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:11.373830 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.382710 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.385096 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.391655 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m03:10:11.393180 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m03:10:11.395404 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m03:10:11.397684 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.408209 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.409107 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.35s]
[0m03:10:11.411297 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.415444 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m03:10:11.417386 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.419246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:11.425101 [debug] [MainThread]: On master: Close
[0m03:10:11.428921 [info ] [MainThread]: 
[0m03:10:11.429304 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:11.432170 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m03:10:11.434527 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.435412 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.437080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:11.438375 [debug] [MainThread]: On master: BEGIN
[0m03:10:11.448318 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m03:10:11.440354 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m03:10:11.485085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.479287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:11.484228 [info ] [MainThread]: 
[0m03:10:11.500014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:11.505724 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m03:10:11.503844 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:11.508910 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.506260 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m03:10:11.510507 [info ] [MainThread]: 
[0m03:10:11.512281 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:11.516996 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:10:11.517759 [debug] [MainThread]: On master: COMMIT
[0m03:10:11.513431 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m03:10:11.524410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b7c49850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b7c49730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b7c49af0>]}
[0m03:10:11.523988 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:11.529478 [debug] [MainThread]: On master: Close
[0m03:10:11.529969 [debug] [MainThread]: Flushing usage events
[0m03:10:11.535413 [info ] [MainThread]: 
[0m03:10:11.540302 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m03:10:11.542977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:11.545400 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m03:10:11.549868 [info ] [MainThread]: 
[0m03:10:11.555306 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m03:10:11.554328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:11.568033 [info ] [MainThread]: 
[0m03:10:11.571316 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:10:11.569871 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.578060 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m03:10:11.579022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9bf6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9bf68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44d9bf6760>]}
[0m03:10:11.582511 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m03:10:11.627874 [debug] [MainThread]: Flushing usage events
[0m03:10:11.635329 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.38s]
[0m03:10:11.639554 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m03:10:11.643542 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.645887 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m03:10:11.656895 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.666825 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.668453 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.686390 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.749451 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.756816 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.795456 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.837761 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.842141 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m03:10:11.846830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.863708 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m03:10:11.866922 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m03:10:11.869404 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m03:10:11.896360 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:11.900882 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.902589 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m03:10:11.904475 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m03:10:11.906760 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.25s]
[0m03:10:11.909362 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m03:10:11.911217 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.912689 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m03:10:11.915065 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.916734 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.918522 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.930869 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.936131 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:11.937814 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:11.957342 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.967905 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.969366 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m03:10:11.971047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:11.978310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:11.979941 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m03:10:11.982132 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m03:10:12.010241 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m03:10:12.018063 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.022317 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m03:10:12.031919 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m03:10:12.041224 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.13s]
[0m03:10:12.049968 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m03:10:12.055180 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.059586 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m03:10:12.067295 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.070812 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.073954 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.099519 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.157256 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.160457 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.171169 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.184627 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.187571 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m03:10:12.190043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.207916 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m03:10:12.211227 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m03:10:12.215333 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m03:10:12.324520 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.09 seconds
[0m03:10:12.341897 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.346870 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m03:10:12.350281 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m03:10:12.353433 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.29s]
[0m03:10:12.357501 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m03:10:12.360673 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.364640 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m03:10:12.373296 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.376603 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.380732 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.405349 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.442447 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.446065 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.455997 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.474506 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.476040 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m03:10:12.477279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.485044 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:12.487606 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m03:10:12.489848 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m03:10:12.507597 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:12.513062 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.515348 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m03:10:12.518346 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m03:10:12.520710 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.15s]
[0m03:10:12.522829 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m03:10:12.524866 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.527149 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m03:10:12.530641 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.532812 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.534912 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.545191 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.569142 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.579677 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.593044 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.619896 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.622577 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m03:10:12.624658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.632775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:12.634959 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m03:10:12.636850 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m03:10:12.672573 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m03:10:12.683653 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.687652 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m03:10:12.691336 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m03:10:12.695722 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.17s]
[0m03:10:12.700320 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m03:10:12.703728 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.706383 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m03:10:12.710169 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.713384 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.715773 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.737410 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.746679 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:12.751639 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:12.768370 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.780234 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.783710 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m03:10:12.842195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:12.895495 [debug] [Thread-1  ]: SQL status: BEGIN in 0.05 seconds
[0m03:10:12.947156 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m03:10:12.950061 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m03:10:13.083004 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.13 seconds
[0m03:10:13.158080 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.167492 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m03:10:13.177914 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m03:10:13.186391 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.48s]
[0m03:10:13.193308 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m03:10:13.198332 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.212052 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m03:10:13.227733 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.242425 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.265067 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.363542 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.371790 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.375735 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.384558 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.416354 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.420121 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m03:10:13.422029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:13.430014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:13.432259 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m03:10:13.434214 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m03:10:13.495688 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.06 seconds
[0m03:10:13.502979 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.504988 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m03:10:13.506709 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m03:10:13.511105 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.29s]
[0m03:10:13.515278 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m03:10:13.517334 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.519060 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m03:10:13.522068 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.523778 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.525752 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.543595 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.552053 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.554138 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.635040 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.644510 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.646308 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m03:10:13.648355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:13.657773 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:13.659512 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m03:10:13.660794 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m03:10:13.680578 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:13.683992 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.685450 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m03:10:13.687255 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m03:10:13.692618 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.17s]
[0m03:10:13.699682 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m03:10:13.718166 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.720148 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m03:10:13.722105 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.723329 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.724483 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.733674 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.739342 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.741077 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.748154 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.826759 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.882025 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m03:10:13.884550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:13.899516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:13.904204 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m03:10:13.906531 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m03:10:13.935908 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:13.944548 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:13.948135 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m03:10:13.950820 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m03:10:13.955846 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.23s]
[0m03:10:13.959677 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m03:10:13.961053 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:13.962569 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m03:10:13.965308 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:13.967320 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:13.969599 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:13.990780 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:13.998264 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:14.001060 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:14.009324 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:14.018853 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:14.020408 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m03:10:14.021803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m03:10:14.028577 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m03:10:14.030143 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m03:10:14.032077 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m03:10:14.053694 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m03:10:14.058208 [debug] [Thread-1  ]: finished collecting timing info
[0m03:10:14.059706 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m03:10:14.073738 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m03:10:14.088607 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.12s]
[0m03:10:14.100472 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m03:10:14.108647 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m03:10:14.110199 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:14.111651 [debug] [MainThread]: On master: BEGIN
[0m03:10:14.113141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:10:14.123335 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m03:10:14.125239 [debug] [MainThread]: On master: COMMIT
[0m03:10:14.126905 [debug] [MainThread]: Using ***** connection "master"
[0m03:10:14.128313 [debug] [MainThread]: On master: COMMIT
[0m03:10:14.130315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m03:10:14.132092 [debug] [MainThread]: On master: Close
[0m03:10:14.135996 [info ] [MainThread]: 
[0m03:10:14.138647 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m03:10:14.140470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:10:14.141724 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m03:10:14.147313 [info ] [MainThread]: 
[0m03:10:14.153484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:10:14.156879 [info ] [MainThread]: 
[0m03:10:14.165044 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m03:10:14.168821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39657a45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39657a4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39657c6be0>]}
[0m03:10:14.172635 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:23.032766 | 7f44e5f5-7f4e-4a38-b072-d974721889eb ==============================
[0m04:07:23.032792 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:23.035420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m04:07:23.037392 [debug] [MainThread]: Tracking: tracking
[0m04:07:23.048580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5c6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5c6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5c6b80>]}
[0m04:07:23.268297 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:07:23.270113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b57f8e0>]}
[0m04:07:23.709771 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:07:23.712689 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:07:23.762439 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:07:23.767004 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:07:23.770573 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:07:23.774428 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:23.777909 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:23.779459 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:23.781927 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:23.783362 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:23.785560 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:23.797934 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:07:23.800607 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:07:23.804796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:07:23.809440 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:07:23.812790 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:07:23.815747 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:07:23.818257 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:07:23.821283 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:07:23.823190 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:07:23.825951 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:07:23.838852 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:07:23.850556 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:07:23.870878 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:07:23.874138 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:07:23.878518 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:23.883544 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:07:23.887461 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:07:23.891295 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:23.894550 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:23.898492 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:23.901914 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:23.907749 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:07:23.922563 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:07:23.926393 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:07:23.929330 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:07:23.931978 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:07:23.935369 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:07:23.943232 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:07:23.945616 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:23.948803 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:07:23.951688 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:07:23.956731 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:07:23.959887 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:07:23.962378 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:07:23.965124 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:07:23.967483 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:07:23.970186 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:07:23.987858 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:07:24.015826 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:07:24.020600 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:07:24.026385 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:07:24.049159 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:07:24.055067 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:07:24.067997 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:07:24.077663 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:07:24.083505 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:07:24.088446 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:07:24.095955 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:07:24.102604 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:07:24.112797 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:07:24.127204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:07:24.138683 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:07:24.195023 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:07:24.198713 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:07:24.224928 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:07:24.242910 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:07:24.246869 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:07:24.251124 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:07:24.258867 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:07:24.268970 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:07:24.293895 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:07:24.322651 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:07:24.358989 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:07:24.363324 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:07:24.367523 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:07:24.371897 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:07:24.380700 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:07:24.417403 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:07:24.430268 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:07:24.436564 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:07:24.441571 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:07:24.444434 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:07:24.447169 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:07:24.449752 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:07:24.455884 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:07:24.466128 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:07:24.470236 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:07:24.476161 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:07:24.497239 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:07:24.503923 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:07:24.508368 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:07:24.512269 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:07:24.515291 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:07:24.523639 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:07:24.527166 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:07:24.530134 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:07:24.533758 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:07:24.536814 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:07:24.542576 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:07:24.547178 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:07:24.551421 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:07:24.564120 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:07:24.567182 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:07:24.570608 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:07:24.574087 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:07:24.579797 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:07:24.631164 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:07:24.637092 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:07:24.640721 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:07:24.646108 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:07:24.650132 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:07:24.658617 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:07:24.663685 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:07:24.668639 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:07:24.694489 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:07:24.700563 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:07:24.705092 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:07:24.712674 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:07:24.718360 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:07:24.727327 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:07:24.735052 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:07:24.742906 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:07:24.753065 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:07:24.773669 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:07:24.803031 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:07:24.814470 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:07:24.837393 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:07:24.845425 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:07:24.852705 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:07:24.861432 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:07:24.882935 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:07:24.888271 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:07:24.891736 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:07:24.903267 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:07:24.907428 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:07:24.913071 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:07:24.923939 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:07:24.927956 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:07:24.936169 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:07:24.947675 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:07:24.985857 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:07:25.004890 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:07:25.009370 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:07:25.014687 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:07:25.795527 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:07:25.819774 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:07:25.824995 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:07:25.841902 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:07:25.855727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:07:25.860027 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:07:25.909840 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:07:26.158786 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:07:26.293084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a8e70d0>]}
[0m04:07:26.337281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b3b3ca0>]}
[0m04:07:26.339384 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:26.343723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b4eba00>]}
[0m04:07:26.350184 [info ] [MainThread]: 
[0m04:07:26.355387 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:26.359421 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:07:26.402023 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:07:26.409123 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:07:26.411252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:26.418524 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:07:26.421441 [debug] [ThreadPool]: On list_*****: Close
[0m04:07:26.425436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:26.436356 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:26.437971 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:26.440110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:26.446755 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:26.448493 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:26.449872 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:26.453835 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m04:07:26.459003 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:26.460940 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:26.471487 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.474078 [debug] [MainThread]: On master: BEGIN
[0m04:07:26.475818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:26.482556 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:26.484084 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.485540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:26.491268 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m04:07:26.494752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a8e8c40>]}
[0m04:07:26.496551 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:26.498338 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.499612 [debug] [MainThread]: On master: BEGIN
[0m04:07:26.501513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:07:26.503066 [debug] [MainThread]: On master: COMMIT
[0m04:07:26.504448 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:26.505877 [debug] [MainThread]: On master: COMMIT
[0m04:07:26.507444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:26.509018 [debug] [MainThread]: On master: Close
[0m04:07:26.511176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:26.513297 [info ] [MainThread]: 
[0m04:07:26.532350 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m04:07:26.534251 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m04:07:26.536191 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m04:07:26.537966 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m04:07:26.539890 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:26.541471 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m04:07:26.616819 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:26.619842 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m04:07:26.621969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:26.632449 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:26.634337 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:26.635998 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m04:07:26.640263 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
[0m04:07:26.919566 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:26.924944 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m04:07:26.934677 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m04:07:26.951769 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m04:07:27.084076 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:07:27.087884 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:07:27.090247 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:07:27.097123 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:07:27.100489 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:27.104848 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m04:07:27.143179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f44e5f5-7f4e-4a38-b072-d974721889eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a73ce20>]}
[0m04:07:27.147420 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.61s]
[0m04:07:27.151114 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m04:07:27.158892 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:27.161553 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:27.164036 [debug] [MainThread]: On master: BEGIN
[0m04:07:27.166191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:27.177536 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:27.179581 [debug] [MainThread]: On master: COMMIT
[0m04:07:27.181490 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:27.183531 [debug] [MainThread]: On master: COMMIT
[0m04:07:27.186399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:27.189207 [debug] [MainThread]: On master: Close
[0m04:07:27.194474 [info ] [MainThread]: 
[0m04:07:27.196999 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m04:07:27.199391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:27.201292 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m04:07:27.250703 [info ] [MainThread]: 
[0m04:07:27.252819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:27.255041 [info ] [MainThread]: 
[0m04:07:27.260269 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:27.274246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4b5be220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a8e7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda4a741700>]}
[0m04:07:27.283204 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:33.769969 | 736a72cf-dd8d-4773-b2ea-dfa681fb3fd9 ==============================
[0m04:07:33.769995 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:33.773107 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:33.774352 [debug] [MainThread]: Tracking: tracking
[0m04:07:33.783067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f4aecaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef76c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef76c730>]}
[0m04:07:33.892124 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:07:33.894844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76f0f31d90>]}
[0m04:07:34.078113 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:07:34.081478 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:07:34.195979 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:07:34.204831 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:07:34.209155 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:07:34.215149 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:34.218658 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:34.220532 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:34.224087 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:34.260952 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:34.274905 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:34.298463 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:07:34.301724 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:07:34.305794 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:07:34.311936 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:07:34.315865 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:07:34.319404 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:07:34.321791 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:07:34.325260 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:07:34.337178 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:07:34.339181 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:07:34.368292 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:07:34.382265 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:07:34.417053 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:07:34.428622 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:07:34.459218 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:07:34.480938 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:07:34.489553 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:07:34.495799 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:07:34.502493 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:07:34.511666 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:07:34.517522 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:07:34.526152 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:07:34.547166 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:07:34.561662 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:07:34.568539 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:07:34.581138 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:07:34.595137 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:07:34.599286 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:07:34.604134 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:07:34.607848 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:07:34.612576 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:07:34.619381 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:07:34.625333 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:07:34.632645 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:07:34.640516 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:07:34.646197 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:07:34.654280 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:07:34.683678 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:07:34.714332 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:07:34.719698 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:07:34.725536 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:07:34.752172 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:07:34.756939 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:07:34.770818 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:07:34.779270 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:07:34.786230 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:07:34.791895 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:07:34.800930 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:07:34.807528 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:07:34.822383 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:07:34.838398 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:07:34.854757 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:07:34.892143 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:07:34.896148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:07:34.932735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:07:34.955812 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:07:34.960457 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:07:34.966122 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:07:34.974651 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:07:34.987538 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:07:35.017328 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:07:35.050750 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:07:35.076978 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:07:35.082331 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:07:35.086759 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:07:35.091383 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:07:35.103018 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:07:35.153415 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:07:35.180984 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:07:35.189405 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:07:35.196366 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:07:35.199885 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:07:35.204437 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:07:35.208349 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:07:35.218850 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:07:35.234703 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:07:35.238434 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:07:35.271048 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:07:35.308157 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:07:35.312957 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:07:35.317913 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:07:35.322406 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:07:35.326367 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:07:35.334212 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:07:35.351661 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:07:35.355196 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:07:35.370276 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:07:35.376239 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:07:35.386460 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:07:35.394191 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:07:35.412759 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:07:35.439646 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:07:35.446488 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:07:35.450034 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:07:35.453488 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:07:35.456414 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:07:35.548388 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:07:35.556198 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:07:35.560991 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:07:35.567817 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:07:35.574850 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:07:35.586122 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:07:35.590807 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:07:35.596885 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:07:35.625978 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:07:35.638598 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:07:35.642338 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:07:35.649563 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:07:35.655340 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:07:35.661942 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:07:35.669960 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:07:35.674994 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:07:35.680754 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:07:35.696923 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:07:35.714244 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:07:35.728792 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:07:35.739721 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:07:35.747393 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:07:35.754461 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:07:35.763733 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:07:35.782336 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:07:35.787589 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:07:35.792593 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:07:35.810459 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:07:35.818583 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:07:35.823200 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:07:35.833307 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:07:35.841246 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:07:35.851249 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:07:35.860786 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:07:35.916639 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:07:35.942034 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:07:35.947953 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:07:35.952051 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:07:36.953354 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:07:36.976997 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:07:36.984237 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:07:37.009959 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:07:37.027600 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:07:37.035694 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:07:37.093795 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:07:37.316351 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:07:37.474337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eee810d0>]}
[0m04:07:37.481948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef61f340>]}
[0m04:07:37.484477 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:37.486579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ef76c640>]}
[0m04:07:37.491968 [info ] [MainThread]: 
[0m04:07:37.500947 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:37.524675 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:07:37.550379 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:07:37.554923 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:07:37.556425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:37.569660 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:07:37.574707 [debug] [ThreadPool]: On list_*****: Close
[0m04:07:37.583782 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:37.603231 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:37.611749 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:37.615144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:37.621844 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.623693 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:37.625275 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:37.632808 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.01 seconds
[0m04:07:37.637618 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:37.641186 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:37.660126 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.667529 [debug] [MainThread]: On master: BEGIN
[0m04:07:37.670077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:37.684404 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.688372 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.692837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:37.716578 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m04:07:37.721150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76eee9da90>]}
[0m04:07:37.725958 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:37.732512 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.734209 [debug] [MainThread]: On master: BEGIN
[0m04:07:37.741039 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.743996 [debug] [MainThread]: On master: COMMIT
[0m04:07:37.745734 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:37.747667 [debug] [MainThread]: On master: COMMIT
[0m04:07:37.750236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:37.751852 [debug] [MainThread]: On master: Close
[0m04:07:37.756198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:37.764479 [info ] [MainThread]: 
[0m04:07:37.792395 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m04:07:37.795409 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m04:07:37.798832 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m04:07:37.800249 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m04:07:37.801747 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m04:07:37.829083 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:37.831003 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m04:07:37.834014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:37.843226 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:37.845566 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:37.848750 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m04:07:37.858303 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:07:37.866122 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m04:07:37.876371 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:37.878235 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m04:07:37.953601 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m04:07:37.974774 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:37.976594 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m04:07:37.997585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
[0m04:07:38.015244 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:38.017266 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m04:07:38.020802 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:07:38.064225 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:07:38.066646 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:38.068936 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:07:38.071241 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:07:38.085840 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:07:38.089292 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m04:07:38.094429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:07:38.099820 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:38.103669 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m04:07:38.106302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '736a72cf-dd8d-4773-b2ea-dfa681fb3fd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5ddd30>]}
[0m04:07:38.109507 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.31s]
[0m04:07:38.112700 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m04:07:38.119677 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:38.121679 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:38.123749 [debug] [MainThread]: On master: BEGIN
[0m04:07:38.125706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:38.133245 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:38.135137 [debug] [MainThread]: On master: COMMIT
[0m04:07:38.136776 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:38.138050 [debug] [MainThread]: On master: COMMIT
[0m04:07:38.139687 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:38.140932 [debug] [MainThread]: On master: Close
[0m04:07:38.143458 [info ] [MainThread]: 
[0m04:07:38.145845 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m04:07:38.149173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:38.150604 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m04:07:38.152556 [info ] [MainThread]: 
[0m04:07:38.154569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:38.156228 [info ] [MainThread]: 
[0m04:07:38.157855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:38.159348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5f24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5f2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ee5f2ca0>]}
[0m04:07:38.161056 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:43.287731 | 1960cb93-b966-4ca7-beb7-c52c0f7c4b6b ==============================
[0m04:07:43.287759 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:43.289066 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m04:07:43.290315 [debug] [MainThread]: Tracking: tracking
[0m04:07:43.297388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdf55cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdf55af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdf55b50>]}
[0m04:07:43.475640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:43.476751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:43.488297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1960cb93-b966-4ca7-beb7-c52c0f7c4b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cdcc30d0>]}
[0m04:07:43.493240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1960cb93-b966-4ca7-beb7-c52c0f7c4b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea640>]}
[0m04:07:43.495273 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:43.496649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1960cb93-b966-4ca7-beb7-c52c0f7c4b6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea880>]}
[0m04:07:43.500186 [info ] [MainThread]: 
[0m04:07:43.503298 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:07:43.506408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cddea4c0>]}
[0m04:07:43.508421 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:48.180324 | 047dfee6-cd02-4c77-aecd-51856fdba014 ==============================
[0m04:07:48.180353 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:48.181382 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:48.182528 [debug] [MainThread]: Tracking: tracking
[0m04:07:48.189210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a23cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a23af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a23b50>]}
[0m04:07:48.498330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:48.500715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:48.513989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60067940d0>]}
[0m04:07:48.517602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60068cc640>]}
[0m04:07:48.519257 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:48.521059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60068cc880>]}
[0m04:07:48.525089 [info ] [MainThread]: 
[0m04:07:48.527162 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:48.529800 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:07:48.555256 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:07:48.557485 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:07:48.559207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:48.568837 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:07:48.573605 [debug] [ThreadPool]: On list_*****: Close
[0m04:07:48.580410 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:48.600079 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:48.610723 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:48.615845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:07:48.622687 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.624385 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:48.625722 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:48.634000 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m04:07:48.641630 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:48.648056 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:48.667150 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.670620 [debug] [MainThread]: On master: BEGIN
[0m04:07:48.673715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:48.680030 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.681741 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.683088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:48.694708 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m04:07:48.698229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6006a24b50>]}
[0m04:07:48.699988 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:48.701740 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.703377 [debug] [MainThread]: On master: BEGIN
[0m04:07:48.706085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:07:48.707699 [debug] [MainThread]: On master: COMMIT
[0m04:07:48.709239 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.710938 [debug] [MainThread]: On master: COMMIT
[0m04:07:48.712730 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:48.714255 [debug] [MainThread]: On master: Close
[0m04:07:48.716314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:48.719949 [info ] [MainThread]: 
[0m04:07:48.750225 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m04:07:48.752305 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m04:07:48.754775 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.756251 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m04:07:48.757736 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m04:07:48.765670 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m04:07:48.786938 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:48.791065 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m04:07:48.861060 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m04:07:48.883554 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.886181 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m04:07:48.888707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:48.896743 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.898914 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.901253 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m04:07:48.911494 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:07:48.924626 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.926148 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m04:07:48.929113 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:07:48.956680 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:07:48.958165 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.959554 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:07:48.964153 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:07:48.972222 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:07:48.973724 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m04:07:48.975412 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:07:48.977824 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:48.979265 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m04:07:48.981037 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '047dfee6-cd02-4c77-aecd-51856fdba014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f76c70>]}
[0m04:07:48.982452 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.23s]
[0m04:07:48.984183 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m04:07:48.988103 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:48.989623 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:48.990926 [debug] [MainThread]: On master: BEGIN
[0m04:07:48.992173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:48.997749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:48.999079 [debug] [MainThread]: On master: COMMIT
[0m04:07:49.001814 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:49.003034 [debug] [MainThread]: On master: COMMIT
[0m04:07:49.004396 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:49.005695 [debug] [MainThread]: On master: Close
[0m04:07:49.007350 [info ] [MainThread]: 
[0m04:07:49.008894 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m04:07:49.010633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:49.011923 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m04:07:49.013319 [info ] [MainThread]: 
[0m04:07:49.014794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:49.016344 [info ] [MainThread]: 
[0m04:07:49.017770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:49.019126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f5e2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f5e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6005f5e4f0>]}
[0m04:07:49.020449 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:54.360719 | fc9af739-f51c-47f3-a12d-3f9fe74831d2 ==============================
[0m04:07:54.360806 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:54.362477 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m04:07:54.363873 [debug] [MainThread]: Tracking: tracking
[0m04:07:54.372277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81c34c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81c34070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81c34b20>]}
[0m04:07:54.668592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:54.670324 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:54.682999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d819a10d0>]}
[0m04:07:54.688764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81acf670>]}
[0m04:07:54.690915 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:07:54.693435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81acf8b0>]}
[0m04:07:54.698563 [info ] [MainThread]: 
[0m04:07:54.701780 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:54.712066 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:07:54.738970 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:54.741017 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:07:54.742662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:54.750836 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:07:54.752749 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:07:54.754356 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:07:54.759239 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m04:07:54.764599 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:07:54.766743 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:07:54.783244 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.785324 [debug] [MainThread]: On master: BEGIN
[0m04:07:54.787021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:07:54.794201 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:54.795831 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.797813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:07:54.814496 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:07:54.819793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc9af739-f51c-47f3-a12d-3f9fe74831d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81acf400>]}
[0m04:07:54.821866 [debug] [MainThread]: On master: ROLLBACK
[0m04:07:54.827082 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.828914 [debug] [MainThread]: On master: BEGIN
[0m04:07:54.831220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:07:54.832735 [debug] [MainThread]: On master: COMMIT
[0m04:07:54.834291 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:54.835631 [debug] [MainThread]: On master: COMMIT
[0m04:07:54.837280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:54.841189 [debug] [MainThread]: On master: Close
[0m04:07:54.844402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:07:54.846908 [info ] [MainThread]: 
[0m04:07:54.875247 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.877278 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m04:07:54.879809 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.881119 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.882658 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.909082 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.916670 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:54.918151 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.947906 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.955327 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.957455 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m04:07:54.959149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:07:54.968203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:07:54.969646 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:07:54.971155 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m04:07:54.980483 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:07:54.985218 [debug] [Thread-1  ]: finished collecting timing info
[0m04:07:54.986657 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m04:07:54.988071 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m04:07:54.990113 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.11s]
[0m04:07:54.992326 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:07:54.996116 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:07:54.999461 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:55.001050 [debug] [MainThread]: On master: BEGIN
[0m04:07:55.002786 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:07:55.014368 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:07:55.016607 [debug] [MainThread]: On master: COMMIT
[0m04:07:55.019014 [debug] [MainThread]: Using ***** connection "master"
[0m04:07:55.020722 [debug] [MainThread]: On master: COMMIT
[0m04:07:55.023427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:07:55.025794 [debug] [MainThread]: On master: Close
[0m04:07:55.029419 [info ] [MainThread]: 
[0m04:07:55.032069 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m04:07:55.033866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:55.035463 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m04:07:55.037014 [info ] [MainThread]: 
[0m04:07:55.038457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:07:55.040144 [info ] [MainThread]: 
[0m04:07:55.041639 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:07:55.043708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d811715e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d811719a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d81171040>]}
[0m04:07:55.045106 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:07:59.955761 | 06becb39-1da8-483d-8bd9-72dba47b7cdd ==============================
[0m04:07:59.955793 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:07:59.956937 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:07:59.958151 [debug] [MainThread]: Tracking: tracking
[0m04:07:59.965593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa654cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa654c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa654cb20>]}
[0m04:08:00.136597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:00.137925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:00.147194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bb0d0>]}
[0m04:08:00.156711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa63e8670>]}
[0m04:08:00.158322 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:00.159843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa63e88b0>]}
[0m04:08:00.162546 [info ] [MainThread]: 
[0m04:08:00.164008 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:00.166209 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:08:00.182203 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:08:00.184644 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:08:00.186784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:00.195412 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:00.198412 [debug] [ThreadPool]: On list_*****: Close
[0m04:08:00.202164 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:00.212752 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:00.214424 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:00.215685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:00.221849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:00.223331 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:00.224703 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:00.228857 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m04:08:00.233022 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:00.234681 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:00.243925 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.245415 [debug] [MainThread]: On master: BEGIN
[0m04:08:00.246631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:00.252406 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:00.254003 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.255581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:00.265787 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:08:00.268787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa65451c0>]}
[0m04:08:00.270057 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:00.271394 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.272713 [debug] [MainThread]: On master: BEGIN
[0m04:08:00.275020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:00.276441 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.278095 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.279308 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.280842 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:00.282194 [debug] [MainThread]: On master: Close
[0m04:08:00.284325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:00.286019 [info ] [MainThread]: 
[0m04:08:00.306141 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m04:08:00.307939 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m04:08:00.309760 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m04:08:00.310956 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m04:08:00.312173 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m04:08:00.317178 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m04:08:00.322868 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:00.324314 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m04:08:00.378547 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m04:08:00.384422 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.390544 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m04:08:00.391699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:00.396366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m04:08:00.397628 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.398819 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m04:08:00.402527 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:08:00.410206 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.411685 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m04:08:00.413247 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:08:00.440508 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:08:00.459892 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.461713 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:08:00.464640 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:08:00.472858 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:08:00.474081 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m04:08:00.475415 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:08:00.477690 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:00.478750 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m04:08:00.482337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06becb39-1da8-483d-8bd9-72dba47b7cdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa5a7e130>]}
[0m04:08:00.483628 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.17s]
[0m04:08:00.484956 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m04:08:00.487544 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:00.488757 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.489762 [debug] [MainThread]: On master: BEGIN
[0m04:08:00.490769 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:00.495391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:00.496610 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.497625 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:00.498588 [debug] [MainThread]: On master: COMMIT
[0m04:08:00.499746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:00.500795 [debug] [MainThread]: On master: Close
[0m04:08:00.502264 [info ] [MainThread]: 
[0m04:08:00.503412 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m04:08:00.504658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:00.505639 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m04:08:00.506849 [info ] [MainThread]: 
[0m04:08:00.507964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:00.509185 [info ] [MainThread]: 
[0m04:08:00.510648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:08:00.511992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1aa62bf490>]}
[0m04:08:00.513599 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:08:05.433171 | b778695c-a337-4321-9c31-6c97fed1ae3a ==============================
[0m04:08:05.433245 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:05.435658 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m04:08:05.437543 [debug] [MainThread]: Tracking: tracking
[0m04:08:05.446929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b1b1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b1b1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b1b1b20>]}
[0m04:08:05.688926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:05.689934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:05.700239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116af200d0>]}
[0m04:08:05.703148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b04c670>]}
[0m04:08:05.705387 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:05.708450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b04c8b0>]}
[0m04:08:05.711871 [info ] [MainThread]: 
[0m04:08:05.714043 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:05.717405 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:05.737300 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:05.739466 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:05.740846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:05.754531 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:05.756822 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:05.758405 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:05.766253 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.01 seconds
[0m04:08:05.771439 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:05.773374 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:05.784212 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.785805 [debug] [MainThread]: On master: BEGIN
[0m04:08:05.788263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:05.795082 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:05.796743 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.798115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:05.808686 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:05.812223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b778695c-a337-4321-9c31-6c97fed1ae3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116b04c4c0>]}
[0m04:08:05.814141 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:05.815699 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.817117 [debug] [MainThread]: On master: BEGIN
[0m04:08:05.819414 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:05.822490 [debug] [MainThread]: On master: COMMIT
[0m04:08:05.824093 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:05.825547 [debug] [MainThread]: On master: COMMIT
[0m04:08:05.828805 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:05.831595 [debug] [MainThread]: On master: Close
[0m04:08:05.833727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:05.835587 [info ] [MainThread]: 
[0m04:08:05.856661 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.858391 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m04:08:05.861932 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.864360 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.866184 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.890088 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.896002 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:05.897987 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.920358 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.925609 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.927191 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m04:08:05.928872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:05.935029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:05.936647 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m04:08:05.938233 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m04:08:05.945209 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:05.949588 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:05.950980 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m04:08:05.952563 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m04:08:05.955107 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.09s]
[0m04:08:05.957139 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m04:08:05.958646 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.959855 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m04:08:05.961945 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.963412 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.965144 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.981505 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.986859 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:05.988414 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:05.992899 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.997638 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:05.999492 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m04:08:06.000723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:06.008819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:06.010525 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m04:08:06.012585 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:08:06.021310 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:06.025053 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:06.026426 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m04:08:06.028010 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m04:08:06.030114 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.07s]
[0m04:08:06.032006 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m04:08:06.035180 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:06.036517 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:06.037747 [debug] [MainThread]: On master: BEGIN
[0m04:08:06.038917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:06.044739 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:06.046839 [debug] [MainThread]: On master: COMMIT
[0m04:08:06.048311 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:06.049568 [debug] [MainThread]: On master: COMMIT
[0m04:08:06.050978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:06.052050 [debug] [MainThread]: On master: Close
[0m04:08:06.054150 [info ] [MainThread]: 
[0m04:08:06.055601 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m04:08:06.056853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:06.058016 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m04:08:06.059171 [info ] [MainThread]: 
[0m04:08:06.060606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:06.062463 [info ] [MainThread]: 
[0m04:08:06.063883 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:08:06.065545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116a6d6ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116a6d6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f116a695100>]}
[0m04:08:06.066882 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:08:11.350649 | 6f38a286-fb81-4032-99d9-d2c13374fd92 ==============================
[0m04:08:11.350721 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:11.352110 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:08:11.356568 [debug] [MainThread]: Tracking: tracking
[0m04:08:11.363187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427435c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427435070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1427435b20>]}
[0m04:08:11.628993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:11.630337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:11.639593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14271a30d0>]}
[0m04:08:11.642898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14272d0670>]}
[0m04:08:11.644107 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:11.645348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14272d08b0>]}
[0m04:08:11.647841 [info ] [MainThread]: 
[0m04:08:11.649272 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:11.652047 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:08:11.668939 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:08:11.670958 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:08:11.672140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:11.678764 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:11.681323 [debug] [ThreadPool]: On list_*****: Close
[0m04:08:11.684913 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:11.694955 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:11.696165 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:11.697415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:08:11.711260 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:11.713268 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:11.715520 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:11.725634 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m04:08:11.730408 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:11.732172 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:11.744080 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.745503 [debug] [MainThread]: On master: BEGIN
[0m04:08:11.746768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:11.753147 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:11.755171 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.756839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:11.768506 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m04:08:11.772760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14274371c0>]}
[0m04:08:11.774619 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:11.776505 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.777725 [debug] [MainThread]: On master: BEGIN
[0m04:08:11.779609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:11.780924 [debug] [MainThread]: On master: COMMIT
[0m04:08:11.782240 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:11.783890 [debug] [MainThread]: On master: COMMIT
[0m04:08:11.786068 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:11.788476 [debug] [MainThread]: On master: Close
[0m04:08:11.790565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:11.792121 [info ] [MainThread]: 
[0m04:08:11.813455 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m04:08:11.815384 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m04:08:11.819377 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m04:08:11.822106 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m04:08:11.823675 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m04:08:11.844231 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:08:11.861376 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m04:08:11.879044 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:11.880472 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m04:08:11.963159 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m04:08:11.978332 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:11.980410 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m04:08:11.981739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:11.987690 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:11.989070 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:11.990142 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m04:08:11.998473 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:08:12.008985 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:12.010717 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m04:08:12.012970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:08:12.037530 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m04:08:12.039485 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:12.040753 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m04:08:12.043230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:08:12.053062 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m04:08:12.054676 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m04:08:12.056368 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:08:12.059150 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:12.060458 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m04:08:12.062909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f38a286-fb81-4032-99d9-d2c13374fd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142692f1c0>]}
[0m04:08:12.066671 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.25s]
[0m04:08:12.069918 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m04:08:12.074224 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:12.075610 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:12.077193 [debug] [MainThread]: On master: BEGIN
[0m04:08:12.080176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:12.088359 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:12.090094 [debug] [MainThread]: On master: COMMIT
[0m04:08:12.091517 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:12.092760 [debug] [MainThread]: On master: COMMIT
[0m04:08:12.094549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:12.095919 [debug] [MainThread]: On master: Close
[0m04:08:12.097969 [info ] [MainThread]: 
[0m04:08:12.099564 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m04:08:12.100930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:12.102127 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m04:08:12.103432 [info ] [MainThread]: 
[0m04:08:12.104617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:12.106290 [info ] [MainThread]: 
[0m04:08:12.107711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:08:12.109153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142718af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14271af280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14271af130>]}
[0m04:08:12.111355 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:08:17.180861 | 147bbb87-d452-434c-af92-f91d315dd598 ==============================
[0m04:08:17.180888 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:08:17.182086 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m04:08:17.183383 [debug] [MainThread]: Tracking: tracking
[0m04:08:17.188917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa238034610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa238034ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa238034b20>]}
[0m04:08:17.367557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:08:17.368662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:08:17.377410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237da1fd0>]}
[0m04:08:17.379969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237eb85e0>]}
[0m04:08:17.381228 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:08:17.382793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237eb8820>]}
[0m04:08:17.386295 [info ] [MainThread]: 
[0m04:08:17.387782 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:17.390196 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:08:17.405429 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:17.406979 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:08:17.408358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:08:17.413970 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.415239 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:08:17.416249 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:08:17.419635 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m04:08:17.423531 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:08:17.424794 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:08:17.433251 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.434461 [debug] [MainThread]: On master: BEGIN
[0m04:08:17.435502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:08:17.440733 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.442655 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.444386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:08:17.462558 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m04:08:17.466144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147bbb87-d452-434c-af92-f91d315dd598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237eb8430>]}
[0m04:08:17.470550 [debug] [MainThread]: On master: ROLLBACK
[0m04:08:17.472705 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.475058 [debug] [MainThread]: On master: BEGIN
[0m04:08:17.477809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:17.479618 [debug] [MainThread]: On master: COMMIT
[0m04:08:17.481585 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:17.483153 [debug] [MainThread]: On master: COMMIT
[0m04:08:17.484877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:17.486216 [debug] [MainThread]: On master: Close
[0m04:08:17.488163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:08:17.490509 [info ] [MainThread]: 
[0m04:08:17.513250 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.515475 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m04:08:17.517624 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.519125 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.520514 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.543864 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.550510 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.552515 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.579120 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.587709 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.589130 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m04:08:17.590244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.595964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.597216 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m04:08:17.598538 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m04:08:17.615639 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m04:08:17.620197 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.621869 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m04:08:17.623497 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m04:08:17.625120 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.11s]
[0m04:08:17.627380 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m04:08:17.629016 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.630396 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m04:08:17.632348 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.634215 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.635787 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.652497 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.657805 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.659777 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.664421 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.682826 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.684448 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m04:08:17.686008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.691359 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.692694 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m04:08:17.693990 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m04:08:17.707847 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.711057 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.712291 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m04:08:17.714902 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m04:08:17.717143 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.09s]
[0m04:08:17.718953 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m04:08:17.720122 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.721595 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m04:08:17.723563 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.724815 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.725932 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.737788 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.744638 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.746674 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.755061 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.760533 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.761985 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m04:08:17.763020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.768898 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.770203 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m04:08:17.771558 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m04:08:17.784104 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.786744 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.788133 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m04:08:17.789487 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m04:08:17.791238 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.07s]
[0m04:08:17.792753 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m04:08:17.794048 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.795150 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m04:08:17.797692 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.799783 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.802038 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.809784 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.816343 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.818398 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.824396 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.833088 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.834612 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m04:08:17.835721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.841550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.843084 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m04:08:17.844439 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m04:08:17.858851 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.862887 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.864214 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m04:08:17.865770 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m04:08:17.867523 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.07s]
[0m04:08:17.870004 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m04:08:17.871495 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.873077 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m04:08:17.875249 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.876796 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.878541 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.887541 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.893053 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.894684 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.899277 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.903490 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.904715 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m04:08:17.905915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:17.914914 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:17.919729 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m04:08:17.923457 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m04:08:17.941545 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:17.944706 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.946002 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m04:08:17.947417 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m04:08:17.949015 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.07s]
[0m04:08:17.951330 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m04:08:17.952421 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.953636 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m04:08:17.955449 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.956755 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.957961 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.964926 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.982422 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:17.983758 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m04:08:17.988006 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.992756 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:17.994067 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m04:08:17.995008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.000116 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.001446 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m04:08:18.002638 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m04:08:18.017404 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.020440 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.021756 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m04:08:18.023241 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m04:08:18.024904 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.07s]
[0m04:08:18.027820 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m04:08:18.029037 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.030212 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m04:08:18.032174 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.033345 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.034350 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.042877 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.050152 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.051609 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.056448 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.061124 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.062746 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m04:08:18.063962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.069480 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.070592 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m04:08:18.071700 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m04:08:18.085192 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.088031 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.091361 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m04:08:18.095840 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m04:08:18.099936 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.07s]
[0m04:08:18.103953 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m04:08:18.105844 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.107376 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m04:08:18.109831 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.111441 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.112778 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.119852 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.132371 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.134095 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.138485 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.143015 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.144373 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m04:08:18.145496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.150185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m04:08:18.151530 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m04:08:18.152675 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m04:08:18.164437 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.167731 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.169032 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m04:08:18.170439 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m04:08:18.172083 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.06s]
[0m04:08:18.173617 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m04:08:18.174905 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.175943 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m04:08:18.177329 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.178240 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.179387 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.184728 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.189123 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.190146 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.193785 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.197630 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.198867 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m04:08:18.200043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.205046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.206893 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m04:08:18.208720 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m04:08:18.222934 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.225898 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.227210 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m04:08:18.229013 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m04:08:18.230865 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.05s]
[0m04:08:18.232450 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m04:08:18.233977 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.235109 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m04:08:18.237012 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.238391 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.242791 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.253486 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.260539 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.262058 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.266807 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.282948 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.284760 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m04:08:18.286310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.292246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.293914 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m04:08:18.295261 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m04:08:18.310850 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.314534 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.316063 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m04:08:18.317647 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m04:08:18.319690 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.08s]
[0m04:08:18.322531 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m04:08:18.324408 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.326632 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m04:08:18.329759 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.331383 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.332979 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.340685 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.346785 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.348188 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.352908 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.377985 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.380712 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m04:08:18.382404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.388801 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.390345 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m04:08:18.392052 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m04:08:18.407001 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.411493 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.413153 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m04:08:18.415170 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m04:08:18.417501 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.09s]
[0m04:08:18.419481 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m04:08:18.420990 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.422520 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m04:08:18.424553 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.425930 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.427204 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.434333 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.440099 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.441649 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.446664 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.451520 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.453018 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m04:08:18.454630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.460321 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.461864 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m04:08:18.463206 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m04:08:18.477761 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.480848 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.482062 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m04:08:18.483287 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m04:08:18.484965 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.06s]
[0m04:08:18.486681 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m04:08:18.487975 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.489169 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m04:08:18.490827 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.491982 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.492996 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.499682 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.505469 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.507290 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.515723 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.533942 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.535341 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m04:08:18.536655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.542442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.543680 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m04:08:18.545064 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m04:08:18.560223 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:08:18.564144 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.565989 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m04:08:18.567599 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m04:08:18.569415 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.08s]
[0m04:08:18.571454 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m04:08:18.573069 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.574831 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m04:08:18.578434 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.579916 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.582062 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.591034 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.596854 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.598641 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.606601 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.613096 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.614486 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m04:08:18.615659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.622435 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.624348 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m04:08:18.626480 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m04:08:18.644079 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m04:08:18.648120 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.650101 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m04:08:18.652140 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m04:08:18.654629 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.08s]
[0m04:08:18.657234 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m04:08:18.659192 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.661151 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m04:08:18.664680 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.666093 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.667626 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.682486 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.687662 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.689000 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.693422 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.697666 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.698926 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m04:08:18.700197 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:08:18.706261 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:08:18.708155 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m04:08:18.709762 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:08:18.727112 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m04:08:18.731668 [debug] [Thread-1  ]: finished collecting timing info
[0m04:08:18.733077 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m04:08:18.734438 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m04:08:18.736097 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.07s]
[0m04:08:18.737603 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m04:08:18.741149 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:08:18.742478 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:18.743540 [debug] [MainThread]: On master: BEGIN
[0m04:08:18.744681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:08:18.749524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:08:18.750644 [debug] [MainThread]: On master: COMMIT
[0m04:08:18.751855 [debug] [MainThread]: Using ***** connection "master"
[0m04:08:18.753157 [debug] [MainThread]: On master: COMMIT
[0m04:08:18.754910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:08:18.756467 [debug] [MainThread]: On master: Close
[0m04:08:18.758489 [info ] [MainThread]: 
[0m04:08:18.760010 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m04:08:18.761540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:08:18.762981 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m04:08:18.764597 [info ] [MainThread]: 
[0m04:08:18.766109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:08:18.767560 [info ] [MainThread]: 
[0m04:08:18.768840 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m04:08:18.770331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237501520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa237501460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2375017f0>]}
[0m04:08:18.771730 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:25:31.562839 | 61d94b13-480c-40ba-9db5-b0f1f2a45fba ==============================
[0m04:25:31.562868 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:25:31.564489 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:25:31.567682 [debug] [MainThread]: Tracking: tracking
[0m04:25:31.584723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6840cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6840cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c6840cc10>]}
[0m04:25:31.589405 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wq9ztvm7'
[0m04:25:31.631205 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:25:32.143883 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:25:32.145928 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:25:32.381575 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:25:32.564251 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:25:38.489166 [info ] [MainThread]:   Installed from version 0.8.0
[0m04:25:38.491978 [info ] [MainThread]:   Updated version available: 0.9.6
[0m04:25:38.495251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '61d94b13-480c-40ba-9db5-b0f1f2a45fba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c683bd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c685289a0>]}
[0m04:25:38.497993 [info ] [MainThread]: 
[0m04:25:38.500417 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:25:38.503826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c684a6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c684a6d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c683b8400>]}
[0m04:25:38.506618 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:25:43.822950 | 29316580-8522-4411-ba74-ae4f49d2f025 ==============================
[0m04:25:43.822980 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:25:43.824175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:25:43.825460 [debug] [MainThread]: Tracking: tracking
[0m04:25:43.834913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea4e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea4e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea4e130>]}
[0m04:25:43.958096 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:25:43.960199 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:25:43.961251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb53d94f70>]}
[0m04:25:44.248290 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:25:44.251461 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:25:44.291910 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:25:44.298885 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:25:44.303584 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:25:44.307204 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:25:44.310600 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:25:44.314399 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:25:44.317868 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:25:44.320149 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:25:44.325975 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:25:44.342253 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:25:44.349583 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:25:44.359949 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:25:44.368416 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:25:44.374964 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:25:44.384386 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:25:44.387692 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:25:44.393229 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:25:44.399806 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:25:44.405554 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:25:44.418870 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:25:44.432349 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:25:44.448214 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:25:44.451492 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:25:44.454892 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:25:44.458953 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:25:44.461633 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:25:44.463838 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:25:44.466116 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:25:44.469410 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:25:44.472455 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:25:44.479758 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:25:44.500732 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:25:44.505803 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:25:44.508444 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:25:44.510661 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:25:44.512567 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:25:44.516760 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:25:44.518763 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:25:44.521219 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:25:44.523469 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:25:44.526436 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:25:44.528460 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:25:44.533918 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:25:44.536087 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:25:44.538324 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:25:44.540491 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:25:44.556437 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:25:44.580817 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:25:44.585268 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:25:44.590635 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:25:44.613922 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:25:44.618491 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:25:44.630143 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:25:44.637979 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:25:44.643458 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:25:44.647570 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:25:44.653995 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:25:44.660340 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:25:44.670307 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:25:44.683050 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:25:44.693199 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:25:44.723072 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:25:44.727362 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:25:44.755856 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:25:44.774343 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:25:44.777292 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:25:44.781485 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:25:44.787266 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:25:44.796911 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:25:44.819591 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:25:44.843813 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:25:44.863540 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:25:44.867373 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:25:44.871694 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:25:44.879856 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:25:44.888819 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:25:44.919791 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:25:44.931316 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:25:44.936862 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:25:44.941277 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:25:44.944000 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:25:44.950106 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:25:44.952390 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:25:44.958541 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:25:44.967743 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:25:44.970823 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:25:44.975974 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:25:44.993335 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:25:44.995816 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:25:44.998325 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:25:45.001461 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:25:45.003735 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:25:45.009297 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:25:45.011732 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:25:45.013655 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:25:45.016264 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:25:45.018413 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:25:45.022123 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:25:45.025361 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:25:45.028445 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:25:45.036949 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:25:45.040223 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:25:45.044314 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:25:45.047238 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:25:45.049588 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:25:45.087004 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:25:45.092088 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:25:45.095406 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:25:45.099228 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:25:45.102580 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:25:45.108135 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:25:45.111213 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:25:45.114438 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:25:45.129717 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:25:45.133673 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:25:45.136404 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:25:45.140265 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:25:45.143719 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:25:45.147356 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:25:45.151923 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:25:45.154581 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:25:45.157155 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:25:45.161886 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:25:45.169852 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:25:45.178066 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:25:45.186363 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:25:45.191229 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:25:45.196551 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:25:45.202104 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:25:45.212803 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:25:45.216324 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:25:45.219219 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:25:45.228575 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:25:45.231553 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:25:45.234749 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:25:45.241132 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:25:45.244216 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:25:45.250145 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:25:45.255358 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:25:45.268599 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:25:45.316734 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:25:45.320990 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:25:45.324382 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:25:45.824935 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:25:45.842609 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:25:45.847598 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:25:45.863782 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:25:45.884633 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:25:45.888212 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:25:45.928200 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:25:46.126130 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:25:46.260984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4de360d0>]}
[0m04:25:46.284200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ddda0a0>]}
[0m04:25:46.285407 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:25:46.286582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29316580-8522-4411-ba74-ae4f49d2f025', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb5027a190>]}
[0m04:25:46.288511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4ea9b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4e898100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4de02640>]}
[0m04:25:46.289592 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:57:34.924327 | bb75c9b9-07d1-4523-8e53-5fc8691a6745 ==============================
[0m04:57:34.924373 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:57:34.926247 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m04:57:34.927864 [debug] [MainThread]: Tracking: tracking
[0m04:57:34.945065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baac8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baac8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baac8c40>]}
[0m04:57:34.952650 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nrrq5epo'
[0m04:57:34.954253 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:57:35.271355 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:57:35.275577 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:57:35.575039 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:57:35.799102 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:57:40.645275 [info ] [MainThread]:   Installed from version 0.8.0
[0m04:57:40.648655 [info ] [MainThread]:   Updated version available: 0.9.6
[0m04:57:40.655940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb75c9b9-07d1-4523-8e53-5fc8691a6745', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa7edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa7ed30>]}
[0m04:57:40.658161 [info ] [MainThread]: 
[0m04:57:40.660302 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m04:57:40.663571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baadc040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa81190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5baa810d0>]}
[0m04:57:40.665435 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:57:44.427661 | 05f8f9c2-946b-4a5d-8baa-8754ffe31028 ==============================
[0m04:57:44.427689 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:57:44.430536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m04:57:44.431881 [debug] [MainThread]: Tracking: tracking
[0m04:57:44.439447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e7c2460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e7c20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e7c2130>]}
[0m04:57:44.915818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:57:44.917167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:57:44.929702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05f8f9c2-946b-4a5d-8baa-8754ffe31028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e58d0d0>]}
[0m04:57:44.980387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05f8f9c2-946b-4a5d-8baa-8754ffe31028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4df0>]}
[0m04:57:44.982199 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:57:44.985328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f8f9c2-946b-4a5d-8baa-8754ffe31028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4be0>]}
[0m04:57:44.988807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364e6b49d0>]}
[0m04:57:44.993520 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:58:40.748405 | c6c9bba7-398f-4211-8916-1cde74bc55a5 ==============================
[0m04:58:40.748449 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:58:40.751618 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m04:58:40.753674 [debug] [MainThread]: Tracking: tracking
[0m04:58:40.783143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e53aebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e53aeb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e53aeb80>]}
[0m04:58:41.281425 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m04:58:41.328335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e5367730>]}
[0m04:58:41.871446 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:58:41.894798 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:58:41.967380 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:58:41.974004 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:58:41.979582 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:58:41.983667 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:58:41.988678 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:58:41.992018 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:58:41.999658 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:58:42.002413 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:58:42.005653 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:58:42.022147 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:58:42.025785 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:58:42.030727 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:58:42.037841 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:58:42.051202 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:58:42.056377 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:58:42.059561 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:58:42.064002 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:58:42.066481 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:58:42.068667 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:58:42.080719 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:58:42.090789 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:58:42.106606 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:58:42.109467 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:58:42.112090 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:58:42.116369 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:58:42.118745 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:58:42.121203 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:58:42.123526 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:58:42.126892 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:58:42.129550 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:58:42.135532 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:58:42.149305 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:58:42.152963 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:58:42.155877 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:58:42.158104 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:58:42.160969 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:58:42.163877 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:58:42.166994 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:58:42.169821 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:58:42.172025 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:58:42.175057 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:58:42.177211 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:58:42.179643 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:58:42.183352 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:58:42.185644 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:58:42.188554 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:58:42.209630 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:58:42.236280 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:58:42.240783 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:58:42.246477 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:58:42.267072 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:58:42.271919 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:58:42.286848 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:58:42.295244 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:58:42.301168 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:58:42.305650 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:58:42.312977 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:58:42.323680 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:58:42.335084 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:58:42.349103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:58:42.361464 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:58:42.393629 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:58:42.397728 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:58:42.425415 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:58:42.442934 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:58:42.447482 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:58:42.451621 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:58:42.460405 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:58:42.470909 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:58:42.494585 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:58:42.520540 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:58:42.542088 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:58:42.546146 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:58:42.549656 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:58:42.553077 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:58:42.560658 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:58:42.594175 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:58:42.606668 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:58:42.613368 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:58:42.617543 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:58:42.620382 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:58:42.623424 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:58:42.625646 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:58:42.631816 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:58:42.640641 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:58:42.644855 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:58:42.650728 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:58:42.669677 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:58:42.672472 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:58:42.675287 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:58:42.679544 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:58:42.682067 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:58:42.690691 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:58:42.694209 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:58:42.697097 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:58:42.700734 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:58:42.703558 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:58:42.708349 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:58:42.712565 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:58:42.716635 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:58:42.729517 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:58:42.732916 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:58:42.735681 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:58:42.738668 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:58:42.741337 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:58:42.782509 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:58:42.794120 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:58:42.798591 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:58:42.804576 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:58:42.808227 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:58:42.815961 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:58:42.819931 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:58:42.824024 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:58:42.889165 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:58:42.894388 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:58:42.897612 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:58:42.901815 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:58:42.905388 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:58:42.917891 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:58:42.924303 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:58:42.928850 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:58:42.933458 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:58:42.980536 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:58:42.993556 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:58:43.003928 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:58:43.014032 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:58:43.018995 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:58:43.026604 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:58:43.033504 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:58:43.045941 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:58:43.050380 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:58:43.053308 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:58:43.068434 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:58:43.132037 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:58:43.143534 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:58:43.207671 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:58:43.219328 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:58:43.232656 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:58:43.240985 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:58:43.300038 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:58:43.377152 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:58:43.387274 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:58:43.399545 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:58:44.228986 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:58:44.255687 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:58:44.264181 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:58:44.287360 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:58:44.305596 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:58:44.312166 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:58:44.391435 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:58:44.790376 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:58:44.918290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46d40d0>]}
[0m04:58:44.955522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46ccf70>]}
[0m04:58:44.957053 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:58:44.959272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e5170460>]}
[0m04:58:44.964242 [info ] [MainThread]: 
[0m04:58:44.966650 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:58:44.969063 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:58:44.979519 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:58:44.980922 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:58:44.982190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:58:44.991215 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:58:44.995141 [debug] [ThreadPool]: On list_*****: Close
[0m04:58:44.998639 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:58:45.009214 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:58:45.010586 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:58:45.011911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:58:45.018305 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.019705 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:58:45.020937 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:58:45.025202 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m04:58:45.029314 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:58:45.030702 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:58:45.040338 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.041874 [debug] [MainThread]: On master: BEGIN
[0m04:58:45.043036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:58:45.049503 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.051167 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.052530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:58:45.063307 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m04:58:45.066402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46d9b20>]}
[0m04:58:45.067980 [debug] [MainThread]: On master: ROLLBACK
[0m04:58:45.070598 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.071948 [debug] [MainThread]: On master: BEGIN
[0m04:58:45.074907 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:58:45.076279 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.077447 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.078964 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.080631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:58:45.082381 [debug] [MainThread]: On master: Close
[0m04:58:45.084448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:58:45.088079 [info ] [MainThread]: 
[0m04:58:45.114002 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m04:58:45.116039 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m04:58:45.118761 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m04:58:45.120464 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m04:58:45.122064 [debug] [Thread-1  ]: finished collecting timing info
[0m04:58:45.123634 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m04:58:45.202977 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.204958 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m04:58:45.206440 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:58:45.215421 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.217359 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.218831 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */
truncate table "*****"."public"."subscription_periods"
[0m04:58:45.224564 [debug] [Thread-1  ]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m04:58:45.445781 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.447717 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m04:58:45.451888 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m04:58:45.466614 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m04:58:45.510186 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:58:45.513744 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m04:58:45.516014 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m04:58:45.519858 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:58:45.522115 [debug] [Thread-1  ]: finished collecting timing info
[0m04:58:45.523404 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m04:58:45.525201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6c9bba7-398f-4211-8916-1cde74bc55a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e451f130>]}
[0m04:58:45.526670 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.41s]
[0m04:58:45.528451 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m04:58:45.531675 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:58:45.533202 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.535921 [debug] [MainThread]: On master: BEGIN
[0m04:58:45.537488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:58:45.546347 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:58:45.548702 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.550962 [debug] [MainThread]: Using ***** connection "master"
[0m04:58:45.552931 [debug] [MainThread]: On master: COMMIT
[0m04:58:45.554888 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:58:45.557612 [debug] [MainThread]: On master: Close
[0m04:58:45.560486 [info ] [MainThread]: 
[0m04:58:45.563055 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m04:58:45.566032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:58:45.568691 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m04:58:45.632467 [info ] [MainThread]: 
[0m04:58:45.634549 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:58:45.636224 [info ] [MainThread]: 
[0m04:58:45.637675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:58:45.639462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e5367970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e46d4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90e451ffa0>]}
[0m04:58:45.641099 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:14.820753 | 7910ad99-ebc9-4df1-96f2-79d8a31886e5 ==============================
[0m04:59:14.820826 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:14.825143 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:14.828073 [debug] [MainThread]: Tracking: tracking
[0m04:59:14.854379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfcb50>]}
[0m04:59:15.217619 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:59:15.220664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcfc8b0>]}
[0m04:59:15.478209 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m04:59:15.483330 [debug] [MainThread]: Parsing macros/adapters.sql
[0m04:59:15.535042 [debug] [MainThread]: Parsing macros/catalog.sql
[0m04:59:15.541246 [debug] [MainThread]: Parsing macros/relations.sql
[0m04:59:15.546486 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m04:59:15.551492 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:59:15.555569 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:59:15.557506 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:59:15.561066 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:59:15.564191 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:59:15.567424 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:59:15.582746 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m04:59:15.586329 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m04:59:15.591495 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m04:59:15.599058 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m04:59:15.603799 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m04:59:15.607699 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m04:59:15.611347 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m04:59:15.615784 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m04:59:15.618543 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m04:59:15.621387 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m04:59:15.635986 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m04:59:15.648736 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m04:59:15.666217 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m04:59:15.669476 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m04:59:15.676210 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m04:59:15.683059 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m04:59:15.686424 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m04:59:15.689258 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m04:59:15.692563 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m04:59:15.699324 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m04:59:15.703363 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m04:59:15.708605 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m04:59:15.722638 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m04:59:15.727230 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m04:59:15.731791 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m04:59:15.735367 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m04:59:15.738659 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m04:59:15.743206 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m04:59:15.747502 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m04:59:15.755789 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m04:59:15.759484 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m04:59:15.765191 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m04:59:15.769185 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m04:59:15.773355 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m04:59:15.777399 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m04:59:15.781769 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m04:59:15.785558 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m04:59:15.808374 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m04:59:15.848410 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m04:59:15.857310 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m04:59:15.867862 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m04:59:15.899592 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m04:59:15.905887 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m04:59:15.923187 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m04:59:15.938192 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m04:59:15.948398 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m04:59:15.956580 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m04:59:15.975159 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m04:59:15.989867 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m04:59:16.006623 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m04:59:16.048028 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m04:59:16.068586 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m04:59:16.121770 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m04:59:16.127094 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m04:59:16.171191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m04:59:16.209055 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m04:59:16.214721 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m04:59:16.221466 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m04:59:16.228719 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m04:59:16.276569 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m04:59:16.313449 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m04:59:16.366037 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m04:59:16.536675 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m04:59:16.563347 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m04:59:16.575028 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m04:59:16.590384 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m04:59:16.606451 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m04:59:16.677506 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m04:59:16.706706 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m04:59:16.723272 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m04:59:16.742228 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m04:59:16.762003 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m04:59:16.769243 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m04:59:16.785827 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m04:59:16.824537 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m04:59:16.856251 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m04:59:16.864448 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m04:59:16.876683 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m04:59:16.930820 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m04:59:16.953522 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m04:59:16.967686 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m04:59:16.987819 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m04:59:16.993385 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m04:59:17.011174 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m04:59:17.022439 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m04:59:17.026812 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m04:59:17.031951 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m04:59:17.036068 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m04:59:17.051488 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m04:59:17.057194 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m04:59:17.079165 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m04:59:17.096773 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m04:59:17.103037 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m04:59:17.108264 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m04:59:17.116488 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m04:59:17.120331 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m04:59:17.222515 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m04:59:17.235788 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m04:59:17.246668 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m04:59:17.261578 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m04:59:17.268673 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m04:59:17.289517 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m04:59:17.295561 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m04:59:17.302575 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m04:59:17.328737 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m04:59:17.336099 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m04:59:17.340300 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m04:59:17.349459 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m04:59:17.355540 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m04:59:17.362431 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m04:59:17.372892 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m04:59:17.384967 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m04:59:17.410723 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m04:59:17.424733 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m04:59:17.439116 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m04:59:17.453110 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m04:59:17.466479 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m04:59:17.472490 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m04:59:17.482710 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m04:59:17.490862 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m04:59:17.505052 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m04:59:17.509285 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m04:59:17.515756 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m04:59:17.538967 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m04:59:17.543167 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m04:59:17.549174 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m04:59:17.560525 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m04:59:17.566806 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m04:59:17.575340 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m04:59:17.584346 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m04:59:17.604393 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m04:59:17.626769 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m04:59:17.659659 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m04:59:17.663456 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m04:59:19.280457 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m04:59:19.341535 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m04:59:19.350872 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m04:59:19.376509 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m04:59:19.404888 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m04:59:19.410809 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m04:59:19.468105 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m04:59:19.860651 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m04:59:20.025478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7b2340d0>]}
[0m04:59:20.031177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcbdb20>]}
[0m04:59:20.033613 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:20.036098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7d4d1d30>]}
[0m04:59:20.040335 [info ] [MainThread]: 
[0m04:59:20.042649 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:20.045636 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:59:20.059017 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:59:20.061107 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:59:20.062818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:20.074573 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:59:20.079931 [debug] [ThreadPool]: On list_*****: Close
[0m04:59:20.096652 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:20.111121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:20.113953 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:20.115813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:20.126174 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:20.128395 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:20.130059 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:20.137712 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.01 seconds
[0m04:59:20.148191 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:20.151106 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:20.168506 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.171945 [debug] [MainThread]: On master: BEGIN
[0m04:59:20.173881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:20.181423 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:20.183508 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.185438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:20.203339 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m04:59:20.211419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7b22ea60>]}
[0m04:59:20.214894 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:20.217254 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.219288 [debug] [MainThread]: On master: BEGIN
[0m04:59:20.221244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:20.223109 [debug] [MainThread]: On master: COMMIT
[0m04:59:20.224702 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:20.226262 [debug] [MainThread]: On master: COMMIT
[0m04:59:20.228201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:20.230100 [debug] [MainThread]: On master: Close
[0m04:59:20.237144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:20.239302 [info ] [MainThread]: 
[0m04:59:20.267126 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m04:59:20.270139 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m04:59:20.273826 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m04:59:20.276619 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m04:59:20.278762 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m04:59:20.366889 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:20.370186 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m04:59:20.372550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:20.436644 [debug] [Thread-1  ]: SQL status: BEGIN in 0.06 seconds
[0m04:59:20.455763 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:20.461658 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m04:59:20.548410 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.08 seconds
[0m04:59:20.644866 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m04:59:20.776260 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:20.790618 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m04:59:21.306406 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m04:59:21.358788 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.366150 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m04:59:21.422415 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.05 seconds
[0m04:59:21.492184 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.495598 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months" rename to "util_months__dbt_backup"
[0m04:59:21.505894 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
[0m04:59:21.528715 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.535562 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m04:59:21.542364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:21.723463 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:59:21.726741 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.730297 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m04:59:21.734873 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:59:21.777455 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m04:59:21.788982 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m04:59:21.799684 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
[0m04:59:21.820348 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:21.824569 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m04:59:21.833236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7910ad99-ebc9-4df1-96f2-79d8a31886e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7a1770a0>]}
[0m04:59:21.846577 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 1.56s]
[0m04:59:21.862620 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m04:59:21.872966 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:21.875002 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:21.876686 [debug] [MainThread]: On master: BEGIN
[0m04:59:21.879894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:21.889390 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:21.891342 [debug] [MainThread]: On master: COMMIT
[0m04:59:21.893136 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:21.894330 [debug] [MainThread]: On master: COMMIT
[0m04:59:21.897824 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:21.900410 [debug] [MainThread]: On master: Close
[0m04:59:21.905095 [info ] [MainThread]: 
[0m04:59:21.907998 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m04:59:21.915201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:21.917439 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m04:59:21.919799 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m04:59:21.923740 [info ] [MainThread]: 
[0m04:59:21.927639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:21.929845 [info ] [MainThread]: 
[0m04:59:21.932313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:21.937448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7bcc87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7a1403d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba7a1407c0>]}
[0m04:59:21.939873 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:29.224068 | 55ea2cfd-f009-4e15-8304-bc8dd7693577 ==============================
[0m04:59:29.224101 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:29.226369 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m04:59:29.228242 [debug] [MainThread]: Tracking: tracking
[0m04:59:29.250882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653d44d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653d44ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653d44b20>]}
[0m04:59:30.137891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:30.143220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:30.171918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ea2cfd-f009-4e15-8304-bc8dd7693577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653ab20d0>]}
[0m04:59:30.179054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ea2cfd-f009-4e15-8304-bc8dd7693577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0610>]}
[0m04:59:30.181939 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:30.184697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ea2cfd-f009-4e15-8304-bc8dd7693577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0850>]}
[0m04:59:30.192768 [info ] [MainThread]: 
[0m04:59:30.196102 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m04:59:30.199296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653bf0490>]}
[0m04:59:30.201954 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:37.416772 | 389f3072-47a1-462f-9489-fe6e8eb9a4f6 ==============================
[0m04:59:37.416804 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:37.418448 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:37.424083 [debug] [MainThread]: Tracking: tracking
[0m04:59:37.536842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd43c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd43070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd43b20>]}
[0m04:59:37.902616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:37.904604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:37.921146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fab10d0>]}
[0m04:59:37.972098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fbe7670>]}
[0m04:59:37.985544 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:37.993145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fbe78b0>]}
[0m04:59:38.008820 [info ] [MainThread]: 
[0m04:59:38.013990 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:38.021793 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:59:38.078026 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:59:38.080158 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:59:38.081839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:38.101587 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.02 seconds
[0m04:59:38.107196 [debug] [ThreadPool]: On list_*****: Close
[0m04:59:38.112425 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:38.127195 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:38.129996 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:38.131449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:38.139810 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.143722 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:38.148434 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:38.160024 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.01 seconds
[0m04:59:38.166472 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:38.169838 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:38.199458 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.202791 [debug] [MainThread]: On master: BEGIN
[0m04:59:38.206124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:38.217306 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.219669 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.222570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:38.243991 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m04:59:38.247601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5fd411c0>]}
[0m04:59:38.249606 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:38.253790 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.255339 [debug] [MainThread]: On master: BEGIN
[0m04:59:38.258445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:38.260021 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.261830 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.263314 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.265098 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:38.266571 [debug] [MainThread]: On master: Close
[0m04:59:38.269340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:38.271263 [info ] [MainThread]: 
[0m04:59:38.300169 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m04:59:38.302189 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m04:59:38.305465 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.307726 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m04:59:38.309994 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m04:59:38.320934 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m04:59:38.329949 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:38.332032 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m04:59:38.451115 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m04:59:38.468842 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.470098 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m04:59:38.471663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:38.480725 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.484523 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.485659 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m04:59:38.497940 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:59:38.522813 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.524975 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m04:59:38.527547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:38.559353 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:59:38.560901 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.562175 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m04:59:38.564069 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:59:38.576931 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m04:59:38.578458 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m04:59:38.582964 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:59:38.585610 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:38.587101 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m04:59:38.590174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '389f3072-47a1-462f-9489-fe6e8eb9a4f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f277ca0>]}
[0m04:59:38.592014 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.29s]
[0m04:59:38.595818 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m04:59:38.601616 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:38.603387 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.604736 [debug] [MainThread]: On master: BEGIN
[0m04:59:38.605928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:38.612998 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:38.614479 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.615661 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:38.616749 [debug] [MainThread]: On master: COMMIT
[0m04:59:38.618008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:38.619211 [debug] [MainThread]: On master: Close
[0m04:59:38.620771 [info ] [MainThread]: 
[0m04:59:38.621999 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m04:59:38.623165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:38.625394 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m04:59:38.626415 [info ] [MainThread]: 
[0m04:59:38.627460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:38.628616 [info ] [MainThread]: 
[0m04:59:38.629686 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:38.630781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f27ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f27a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec5f27a790>]}
[0m04:59:38.631834 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:44.586686 | 100cf817-adbb-4508-a506-3149767ec408 ==============================
[0m04:59:44.586733 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:44.588727 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m04:59:44.591054 [debug] [MainThread]: Tracking: tracking
[0m04:59:44.604901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91e23cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91e23af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91e23b50>]}
[0m04:59:44.886248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:44.888152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:44.907943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91b980d0>]}
[0m04:59:44.915359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91cd0640>]}
[0m04:59:44.917409 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:44.918993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91cd0880>]}
[0m04:59:44.923392 [info ] [MainThread]: 
[0m04:59:44.925736 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:44.932354 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:44.962404 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:44.964105 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:44.965443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:44.973566 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:44.974770 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:44.976035 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:44.984545 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.01 seconds
[0m04:59:44.990042 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:44.992059 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:45.017310 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.019442 [debug] [MainThread]: On master: BEGIN
[0m04:59:45.020941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:45.028134 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:45.029585 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.031330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:45.044967 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:59:45.049215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '100cf817-adbb-4508-a506-3149767ec408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91cd03d0>]}
[0m04:59:45.051934 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:45.054039 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.055352 [debug] [MainThread]: On master: BEGIN
[0m04:59:45.057215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:45.058459 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.059771 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.061139 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.062339 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:45.063301 [debug] [MainThread]: On master: Close
[0m04:59:45.065397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:45.066780 [info ] [MainThread]: 
[0m04:59:45.088562 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.090079 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m04:59:45.092926 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.094874 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.097047 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.129563 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.137385 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:45.138949 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.173159 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.178628 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.180049 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m04:59:45.181307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:45.189924 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:59:45.191080 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m04:59:45.192583 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m04:59:45.206217 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m04:59:45.210730 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:45.212139 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m04:59:45.213690 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m04:59:45.215871 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.12s]
[0m04:59:45.217964 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m04:59:45.221765 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:45.223046 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.224440 [debug] [MainThread]: On master: BEGIN
[0m04:59:45.226057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:45.231958 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:45.233229 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.234781 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:45.236303 [debug] [MainThread]: On master: COMMIT
[0m04:59:45.237775 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:45.238983 [debug] [MainThread]: On master: Close
[0m04:59:45.240824 [info ] [MainThread]: 
[0m04:59:45.242695 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m04:59:45.244720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:45.247013 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m04:59:45.248982 [info ] [MainThread]: 
[0m04:59:45.251581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:45.253350 [info ] [MainThread]: 
[0m04:59:45.255340 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:45.258200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91368610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc913689a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc91368a60>]}
[0m04:59:45.259982 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 04:59:50.530188 | ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616 ==============================
[0m04:59:50.530220 [info ] [MainThread]: Running with dbt=1.3.1
[0m04:59:50.531836 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:59:50.534226 [debug] [MainThread]: Tracking: tracking
[0m04:59:50.542942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c9833c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c9833070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c9833b20>]}
[0m04:59:50.718076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:59:50.719339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:59:50.728158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c95a00d0>]}
[0m04:59:50.731186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c96b8670>]}
[0m04:59:50.732366 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m04:59:50.733697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c96b88b0>]}
[0m04:59:50.736294 [info ] [MainThread]: 
[0m04:59:50.738122 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:50.740234 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m04:59:50.758621 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m04:59:50.760492 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m04:59:50.761865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:50.768160 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m04:59:50.770713 [debug] [ThreadPool]: On list_*****: Close
[0m04:59:50.773332 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m04:59:50.782494 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:50.783848 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m04:59:50.785102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:50.790606 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m04:59:50.792121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m04:59:50.793384 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m04:59:50.797354 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m04:59:50.800882 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m04:59:50.802272 [debug] [ThreadPool]: On list_*****_public: Close
[0m04:59:50.810564 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.812107 [debug] [MainThread]: On master: BEGIN
[0m04:59:50.813336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:50.818015 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:50.819127 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.820277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:50.829615 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m04:59:50.832342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c98319a0>]}
[0m04:59:50.833777 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:50.835196 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.836385 [debug] [MainThread]: On master: BEGIN
[0m04:59:50.837958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:50.839119 [debug] [MainThread]: On master: COMMIT
[0m04:59:50.840177 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:50.841291 [debug] [MainThread]: On master: COMMIT
[0m04:59:50.842587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:50.843650 [debug] [MainThread]: On master: Close
[0m04:59:50.845415 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:59:50.846938 [info ] [MainThread]: 
[0m04:59:50.865449 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m04:59:50.867508 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m04:59:50.870409 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m04:59:50.871401 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m04:59:50.872398 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m04:59:50.877614 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m04:59:50.883482 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:50.884881 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m04:59:50.944119 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m04:59:50.950666 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:50.952971 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m04:59:50.955022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:59:50.961241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m04:59:50.964356 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:50.966934 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m04:59:50.972886 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:59:50.984482 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:50.986249 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m04:59:50.988934 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:59:51.016778 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:59:51.018446 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:51.019828 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m04:59:51.021830 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m04:59:51.029849 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m04:59:51.031097 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m04:59:51.032726 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m04:59:51.035593 [debug] [Thread-1  ]: finished collecting timing info
[0m04:59:51.037196 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m04:59:51.039044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee7efcaf-6d72-4f9c-93c3-95d1bb4e8616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c8d79e50>]}
[0m04:59:51.040663 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.17s]
[0m04:59:51.042481 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m04:59:51.045745 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m04:59:51.047239 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:51.048667 [debug] [MainThread]: On master: BEGIN
[0m04:59:51.050070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:51.056213 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m04:59:51.057746 [debug] [MainThread]: On master: COMMIT
[0m04:59:51.058783 [debug] [MainThread]: Using ***** connection "master"
[0m04:59:51.060085 [debug] [MainThread]: On master: COMMIT
[0m04:59:51.061463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:51.062569 [debug] [MainThread]: On master: Close
[0m04:59:51.064310 [info ] [MainThread]: 
[0m04:59:51.065568 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m04:59:51.066736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:51.067919 [debug] [MainThread]: Connection 'list_*****' was properly closed.
[0m04:59:51.068837 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m04:59:51.070009 [info ] [MainThread]: 
[0m04:59:51.071130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:59:51.072288 [info ] [MainThread]: 
[0m04:59:51.073396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:59:51.076771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c96b83a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c95ad2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79c95ad0d0>]}
[0m04:59:51.079279 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 05:00:01.330581 | 90649a2c-0ab0-4320-89cb-2c6009f71cff ==============================
[0m05:00:01.330661 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:00:01.333721 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m05:00:01.337064 [debug] [MainThread]: Tracking: tracking
[0m05:00:01.372629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3253b9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3253b9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3253b9b50>]}
[0m05:00:02.280459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:02.286205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:02.349477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3251300d0>]}
[0m05:00:02.358068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32525d640>]}
[0m05:00:02.360766 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m05:00:02.363003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32525d880>]}
[0m05:00:02.369140 [info ] [MainThread]: 
[0m05:00:02.372087 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:02.379476 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m05:00:02.463324 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:02.465450 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m05:00:02.467319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:02.542264 [debug] [ThreadPool]: SQL status: BEGIN in 0.08 seconds
[0m05:00:02.544933 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:02.546450 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:00:02.555264 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.01 seconds
[0m05:00:02.561586 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m05:00:02.589785 [debug] [ThreadPool]: On list_*****_public: Close
[0m05:00:02.614630 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.664668 [debug] [MainThread]: On master: BEGIN
[0m05:00:02.671695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:02.681132 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:02.685733 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.690748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:02.745934 [debug] [MainThread]: SQL status: SELECT 6 in 0.05 seconds
[0m05:00:02.752658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90649a2c-0ab0-4320-89cb-2c6009f71cff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32525d490>]}
[0m05:00:02.756331 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:02.758978 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.761392 [debug] [MainThread]: On master: BEGIN
[0m05:00:02.764072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:02.765894 [debug] [MainThread]: On master: COMMIT
[0m05:00:02.768092 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:02.770044 [debug] [MainThread]: On master: COMMIT
[0m05:00:02.773813 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:02.777056 [debug] [MainThread]: On master: Close
[0m05:00:02.779935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:00:02.781813 [info ] [MainThread]: 
[0m05:00:03.069134 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.071001 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m05:00:03.077392 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.080035 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.082232 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.159450 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.170790 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.173254 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.265071 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.272219 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.279032 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m05:00:03.296927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:03.311626 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:03.313555 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m05:00:03.315094 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m05:00:03.333056 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:03.342021 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.358373 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m05:00:03.361105 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m05:00:03.366662 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.29s]
[0m05:00:03.369391 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m05:00:03.371296 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.373102 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m05:00:03.381031 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.382727 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.384165 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.418067 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.427663 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.429387 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.441215 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.480017 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.483077 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m05:00:03.487679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:03.497842 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:03.499737 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m05:00:03.501142 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:00:03.515417 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:03.521610 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:03.523779 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m05:00:03.539397 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m05:00:03.542281 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.16s]
[0m05:00:03.546282 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m05:00:03.551702 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:03.554424 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:03.556913 [debug] [MainThread]: On master: BEGIN
[0m05:00:03.558525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:03.567620 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:03.569313 [debug] [MainThread]: On master: COMMIT
[0m05:00:03.570711 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:03.572630 [debug] [MainThread]: On master: COMMIT
[0m05:00:03.575078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:03.578581 [debug] [MainThread]: On master: Close
[0m05:00:03.582558 [info ] [MainThread]: 
[0m05:00:03.586215 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m05:00:03.600472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:03.603305 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m05:00:03.607374 [info ] [MainThread]: 
[0m05:00:03.611848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:03.616050 [info ] [MainThread]: 
[0m05:00:03.620204 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m05:00:03.625164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3248f9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3248f9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3248f9400>]}
[0m05:00:03.631582 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 05:00:13.486504 | f3bf3649-eb7e-4c4b-a415-b87bc6e73bce ==============================
[0m05:00:13.486545 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:00:13.488448 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:00:13.490281 [debug] [MainThread]: Tracking: tracking
[0m05:00:13.497723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181324610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181324ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181324b20>]}
[0m05:00:13.799258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:13.801618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:13.816306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518108bfd0>]}
[0m05:00:13.820527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51811c15e0>]}
[0m05:00:13.822500 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m05:00:13.825084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51811c1820>]}
[0m05:00:13.828537 [info ] [MainThread]: 
[0m05:00:13.830951 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:13.849557 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m05:00:13.868654 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m05:00:13.870489 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m05:00:13.872120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:13.881882 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m05:00:13.884891 [debug] [ThreadPool]: On list_*****: Close
[0m05:00:13.888835 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m05:00:13.899017 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:13.900931 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m05:00:13.902371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:00:13.908869 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:00:13.910680 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:13.912069 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:00:13.917106 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m05:00:13.921031 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m05:00:13.922587 [debug] [ThreadPool]: On list_*****_public: Close
[0m05:00:13.932581 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.934000 [debug] [MainThread]: On master: BEGIN
[0m05:00:13.935895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:13.942754 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:13.944963 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.946297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:13.960136 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m05:00:13.963293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51812ea490>]}
[0m05:00:13.964653 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:13.966037 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.977021 [debug] [MainThread]: On master: BEGIN
[0m05:00:13.979096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:13.980314 [debug] [MainThread]: On master: COMMIT
[0m05:00:13.985667 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:13.987515 [debug] [MainThread]: On master: COMMIT
[0m05:00:13.989027 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:13.990187 [debug] [MainThread]: On master: Close
[0m05:00:13.991652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:00:13.993376 [info ] [MainThread]: 
[0m05:00:14.014667 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m05:00:14.016729 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m05:00:14.018866 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m05:00:14.020210 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m05:00:14.021378 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m05:00:14.038561 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m05:00:14.051347 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m05:00:14.076219 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:14.078343 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m05:00:14.141217 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m05:00:14.148949 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.150672 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m05:00:14.155019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:14.161357 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:14.162749 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.163823 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m05:00:14.175396 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m05:00:14.193057 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.194796 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m05:00:14.197537 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:00:14.219982 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m05:00:14.221973 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.223492 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m05:00:14.228215 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m05:00:14.238631 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m05:00:14.240175 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m05:00:14.248617 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m05:00:14.251601 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:14.253217 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m05:00:14.257939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3bf3649-eb7e-4c4b-a415-b87bc6e73bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51807f9820>]}
[0m05:00:14.260610 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.24s]
[0m05:00:14.263309 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m05:00:14.268734 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:14.270666 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:14.272139 [debug] [MainThread]: On master: BEGIN
[0m05:00:14.273435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:14.280051 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:14.282065 [debug] [MainThread]: On master: COMMIT
[0m05:00:14.284180 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:14.285757 [debug] [MainThread]: On master: COMMIT
[0m05:00:14.289422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:14.291156 [debug] [MainThread]: On master: Close
[0m05:00:14.294094 [info ] [MainThread]: 
[0m05:00:14.296445 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m05:00:14.298280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:14.300449 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m05:00:14.302591 [info ] [MainThread]: 
[0m05:00:14.304120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:14.305683 [info ] [MainThread]: 
[0m05:00:14.307776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:00:14.310241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51810970d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51810972e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5181097460>]}
[0m05:00:14.311791 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 05:00:20.554537 | 9f8d1d39-aedf-4c26-9cfe-a5c738e457dc ==============================
[0m05:00:20.554565 [info ] [MainThread]: Running with dbt=1.3.1
[0m05:00:20.556378 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m05:00:20.558143 [debug] [MainThread]: Tracking: tracking
[0m05:00:20.566613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5904d1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5904d1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5904d1b50>]}
[0m05:00:20.897926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:00:20.899447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:00:20.910197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa59023e0d0>]}
[0m05:00:20.913423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590376640>]}
[0m05:00:20.914981 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m05:00:20.916151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590376880>]}
[0m05:00:20.920617 [info ] [MainThread]: 
[0m05:00:20.922763 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:20.925714 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m05:00:20.944628 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:20.946712 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m05:00:20.948113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:00:20.962563 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m05:00:20.964566 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m05:00:20.966380 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m05:00:20.970961 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m05:00:20.974409 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m05:00:20.975921 [debug] [ThreadPool]: On list_*****_public: Close
[0m05:00:20.985374 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:20.986975 [debug] [MainThread]: On master: BEGIN
[0m05:00:20.988294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:00:20.993360 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:20.994798 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:20.996124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:00:21.005425 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m05:00:21.008273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f8d1d39-aedf-4c26-9cfe-a5c738e457dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa590376490>]}
[0m05:00:21.010399 [debug] [MainThread]: On master: ROLLBACK
[0m05:00:21.012100 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:21.045673 [debug] [MainThread]: On master: BEGIN
[0m05:00:21.048371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:00:21.050173 [debug] [MainThread]: On master: COMMIT
[0m05:00:21.051653 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:21.052955 [debug] [MainThread]: On master: COMMIT
[0m05:00:21.054501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:21.055714 [debug] [MainThread]: On master: Close
[0m05:00:21.061381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:00:21.062740 [info ] [MainThread]: 
[0m05:00:21.080387 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.083224 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m05:00:21.093863 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.095310 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.096979 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.113523 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.232243 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.233894 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.261368 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.277862 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.279272 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m05:00:21.280435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.287117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.288786 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m05:00:21.290165 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m05:00:21.308061 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:21.311723 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.312852 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m05:00:21.314434 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m05:00:21.316433 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.22s]
[0m05:00:21.318272 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m05:00:21.319638 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.320702 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m05:00:21.322250 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.323693 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.325048 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.340386 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.345757 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.347308 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.351585 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.356971 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.358524 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m05:00:21.359795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.365465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.366768 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m05:00:21.367846 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m05:00:21.383128 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.386411 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.388607 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m05:00:21.391174 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m05:00:21.396010 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.07s]
[0m05:00:21.398648 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m05:00:21.400676 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.402416 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m05:00:21.404488 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.405734 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.407131 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.417961 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.430842 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.433156 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.444801 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.452515 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.453819 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m05:00:21.455700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.461117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.462714 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m05:00:21.464433 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m05:00:21.474222 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.477457 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.478894 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m05:00:21.480481 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m05:00:21.482183 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.08s]
[0m05:00:21.483700 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m05:00:21.485334 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.487435 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m05:00:21.489629 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.492544 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.495231 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.502326 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.509243 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.512474 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.519270 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.528890 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.530459 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m05:00:21.531362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.538398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.539935 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m05:00:21.541251 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m05:00:21.560598 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:21.563487 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.564647 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m05:00:21.566093 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m05:00:21.567420 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.08s]
[0m05:00:21.569239 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m05:00:21.570975 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.572257 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m05:00:21.573980 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.575293 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.576552 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.583962 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.590568 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.595594 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.602230 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.609151 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.610396 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m05:00:21.611405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.615958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:00:21.617199 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m05:00:21.618550 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m05:00:21.631926 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.634808 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.636015 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m05:00:21.637166 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m05:00:21.638646 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.07s]
[0m05:00:21.640603 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m05:00:21.642028 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.643384 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m05:00:21.645007 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.646018 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.647029 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.652780 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.657428 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.659471 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.663962 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.679215 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.680386 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m05:00:21.681585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.687581 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.688861 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m05:00:21.689891 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m05:00:21.704219 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.708713 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.710933 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m05:00:21.713099 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m05:00:21.714830 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.07s]
[0m05:00:21.717342 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m05:00:21.718785 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.720374 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m05:00:21.722281 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.723295 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.724198 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.731111 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.736176 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.737591 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.741703 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.747347 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.748545 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m05:00:21.749847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.755532 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.756678 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m05:00:21.757705 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m05:00:21.768776 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.772959 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.774902 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m05:00:21.776743 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m05:00:21.778616 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.06s]
[0m05:00:21.780307 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m05:00:21.781704 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.782916 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m05:00:21.784356 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.791300 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.793184 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.800908 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.806570 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.807922 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.813436 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.828947 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.830450 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m05:00:21.831794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.837109 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.838291 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m05:00:21.839231 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m05:00:21.850880 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.854030 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.859135 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m05:00:21.861114 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m05:00:21.863195 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.08s]
[0m05:00:21.865443 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m05:00:21.866969 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.868440 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m05:00:21.870588 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.871730 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.878924 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.887955 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.891531 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.892777 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.896408 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.902689 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.906271 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m05:00:21.907847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.921536 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:21.923625 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m05:00:21.924995 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m05:00:21.937015 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:21.939953 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.941321 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m05:00:21.942424 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m05:00:21.944778 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.07s]
[0m05:00:21.946520 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m05:00:21.948313 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.949754 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m05:00:21.952218 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.954167 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.955739 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.964925 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.978659 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:21.980327 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:21.984836 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.989264 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.990354 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m05:00:21.991314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:21.995753 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:00:21.996918 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m05:00:21.997944 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m05:00:22.010580 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.013794 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.014999 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m05:00:22.016385 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m05:00:22.018263 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.07s]
[0m05:00:22.019568 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m05:00:22.020768 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.021850 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m05:00:22.023523 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.024507 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.025469 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.034680 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.044991 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.046437 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.050131 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.055866 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.057305 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m05:00:22.058869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.064176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.065206 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m05:00:22.066088 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m05:00:22.077329 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.080052 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.081210 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m05:00:22.082720 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m05:00:22.084595 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.06s]
[0m05:00:22.086076 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m05:00:22.087187 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.088465 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m05:00:22.090099 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.091230 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.092141 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.097870 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.102566 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.104231 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.109363 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.128294 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.129713 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m05:00:22.130606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.135106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m05:00:22.136161 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m05:00:22.137073 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m05:00:22.156561 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:22.160227 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.161668 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m05:00:22.163580 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m05:00:22.165466 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.08s]
[0m05:00:22.168037 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m05:00:22.171148 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.173382 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m05:00:22.180310 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.183193 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.187652 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.199277 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.205092 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.207076 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.213451 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.228455 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.229868 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m05:00:22.232503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.239067 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.240782 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m05:00:22.241966 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m05:00:22.257695 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.260535 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.262211 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m05:00:22.268269 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m05:00:22.270917 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.09s]
[0m05:00:22.273138 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m05:00:22.274723 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.276103 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m05:00:22.278542 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.280221 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.281607 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.292616 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.298625 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.300607 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.307671 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.328449 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.329750 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m05:00:22.330680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.336289 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.337728 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m05:00:22.339429 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m05:00:22.355100 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m05:00:22.358891 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.361039 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m05:00:22.362700 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m05:00:22.364565 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.09s]
[0m05:00:22.366291 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m05:00:22.368008 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.379032 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m05:00:22.381043 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.382187 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.383411 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.394621 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.402693 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.404343 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.409393 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.428573 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.429794 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m05:00:22.430978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:00:22.438512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.440726 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m05:00:22.442249 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m05:00:22.459104 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m05:00:22.462582 [debug] [Thread-1  ]: finished collecting timing info
[0m05:00:22.464258 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m05:00:22.466281 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m05:00:22.468770 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.09s]
[0m05:00:22.471451 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m05:00:22.475096 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m05:00:22.476542 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:22.477779 [debug] [MainThread]: On master: BEGIN
[0m05:00:22.479039 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:00:22.485869 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m05:00:22.488517 [debug] [MainThread]: On master: COMMIT
[0m05:00:22.490348 [debug] [MainThread]: Using ***** connection "master"
[0m05:00:22.530127 [debug] [MainThread]: On master: COMMIT
[0m05:00:22.535156 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:00:22.537199 [debug] [MainThread]: On master: Close
[0m05:00:22.539688 [info ] [MainThread]: 
[0m05:00:22.541334 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m05:00:22.542925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:00:22.546138 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m05:00:22.548117 [info ] [MainThread]: 
[0m05:00:22.550779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:00:22.554298 [info ] [MainThread]: 
[0m05:00:22.556796 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m05:00:22.559503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58f99f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58f99f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa58f99f850>]}
[0m05:00:22.561238 [debug] [MainThread]: Flushing usage events
