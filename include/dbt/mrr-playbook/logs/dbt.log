

============================== 2022-12-01 01:55:48.840545 | e6cddb33-bc45-46f7-b07d-3fbb8bd2c93c ==============================
[0m01:55:48.840595 [info ] [MainThread]: Running with dbt=1.3.1
[0m01:55:48.841891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m01:55:48.844024 [debug] [MainThread]: Tracking: tracking
[0m01:55:48.850791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37340>]}
[0m01:55:48.855627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1cf37640>]}
[0m01:55:48.857167 [debug] [MainThread]: Flushing usage events
[0m01:55:49.275563 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2022-12-01 02:09:37.269576 | 6290eefc-feae-40b3-93b2-edab578a8787 ==============================
[0m02:09:37.269616 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:09:37.271961 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:09:37.274100 [debug] [MainThread]: Tracking: tracking
[0m02:09:37.292786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574ccd0>]}
[0m02:09:37.304506 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q5d9u8e9'
[0m02:09:37.306748 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:09:37.674153 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:09:37.677131 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:09:37.943728 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:09:38.038432 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:09:43.624593 [info ] [MainThread]:   Installed from version 0.8.0
[0m02:09:43.630891 [info ] [MainThread]:   Updated version available: 0.9.6
[0m02:09:43.684100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6290eefc-feae-40b3-93b2-edab578a8787', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b57ef730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b57ef160>]}
[0m02:09:43.701392 [info ] [MainThread]: 
[0m02:09:43.707435 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:09:43.719130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5828f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b5870a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12b574cdc0>]}
[0m02:09:43.721787 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:09:48.309461 | eb86baf6-fcbe-47a5-95ab-a8adb7bad675 ==============================
[0m02:09:48.309512 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:09:48.310757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:09:48.312482 [debug] [MainThread]: Tracking: tracking
[0m02:09:48.321540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509efb2b0>]}
[0m02:09:48.396370 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m02:09:48.398818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50b72d820>]}
[0m02:09:49.044295 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:09:49.049648 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:09:49.090957 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:09:49.097052 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:09:49.101204 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:09:49.104948 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:09:49.108131 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:09:49.109679 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:09:49.112469 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:09:49.114745 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:09:49.117296 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:09:49.129938 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:09:49.133613 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:09:49.137401 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:09:49.142014 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:09:49.145231 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:09:49.149089 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:09:49.151335 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:09:49.154045 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:09:49.155932 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:09:49.157755 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:09:49.167633 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:09:49.176741 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:09:49.191452 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:09:49.195432 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:09:49.198493 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:09:49.203907 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:09:49.206049 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:09:49.208251 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:09:49.210316 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:09:49.215647 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:09:49.218533 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:09:49.222500 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:09:49.233298 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:09:49.236050 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:09:49.238181 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:09:49.240334 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:09:49.242264 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:09:49.244994 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:09:49.247026 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:09:49.249735 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:09:49.252094 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:09:49.254930 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:09:49.260207 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:09:49.263474 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:09:49.266255 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:09:49.268347 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:09:49.270777 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:09:49.286729 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:09:49.350205 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:09:49.357753 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:09:49.367468 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:09:49.399673 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:09:49.406746 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:09:49.427137 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:09:49.440407 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:09:49.454176 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:09:49.472195 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:09:49.488091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:09:49.501938 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:09:49.523846 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:09:49.552040 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:09:49.570064 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:09:49.626621 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:09:49.633818 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:09:49.668021 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:09:49.691532 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:09:49.695348 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:09:49.702756 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:09:49.716062 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:09:49.729168 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:09:49.754871 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:09:49.781070 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:09:49.804803 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:09:49.810263 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:09:49.816549 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:09:49.820331 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:09:49.828414 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:09:49.874247 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:09:49.893855 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:09:49.901945 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:09:49.919516 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:09:49.922156 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:09:49.926742 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:09:49.929844 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:09:49.935963 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:09:49.944529 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:09:49.948661 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:09:49.954068 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:09:49.973700 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:09:49.977156 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:09:49.980734 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:09:49.989098 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:09:49.992906 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:09:50.000994 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:09:50.004734 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:09:50.007816 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:09:50.012662 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:09:50.016054 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:09:50.021171 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:09:50.024698 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:09:50.028036 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:09:50.038876 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:09:50.043101 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:09:50.046112 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:09:50.048828 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:09:50.052000 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:09:50.094536 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:09:50.100331 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:09:50.103216 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:09:50.107007 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:09:50.110015 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:09:50.116398 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:09:50.120800 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:09:50.124754 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:09:50.141238 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:09:50.146241 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:09:50.150010 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:09:50.154008 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:09:50.157077 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:09:50.160902 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:09:50.166398 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:09:50.169286 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:09:50.172248 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:09:50.177170 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:09:50.185550 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:09:50.192795 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:09:50.202425 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:09:50.206573 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:09:50.213333 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:09:50.220886 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:09:50.231663 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:09:50.235558 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:09:50.238562 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:09:50.248450 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:09:50.252176 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:09:50.255464 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:09:50.262305 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:09:50.266328 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:09:50.272757 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:09:50.278816 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:09:50.292439 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:09:50.306375 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:09:50.310658 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:09:50.314315 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:09:50.866669 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:09:50.890069 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:09:50.895196 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:09:50.914145 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:09:50.927247 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:09:50.930760 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:09:50.970076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:09:51.213980 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:09:51.353404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509e1c2b0>]}
[0m02:09:51.398090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509f6ba30>]}
[0m02:09:51.399634 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:09:51.401244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb86baf6-fcbe-47a5-95ab-a8adb7bad675', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509eadf10>]}
[0m02:09:51.403268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509f22c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509e60cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff509dfa040>]}
[0m02:09:51.404408 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:44:15.479655 | 118d2093-5442-4087-afa3-04e104429da0 ==============================
[0m02:44:15.479691 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:44:15.482769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
[0m02:44:15.485912 [debug] [MainThread]: Tracking: tracking
[0m02:44:15.502873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa31db80>]}
[0m02:44:15.785171 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:44:15.788791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa2d5730>]}
[0m02:44:16.133258 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:44:16.136310 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:44:16.178139 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:44:16.183284 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:44:16.186680 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:44:16.189957 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:16.193261 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:16.194832 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:16.197395 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:16.199225 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:16.201423 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:16.214962 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:44:16.218160 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:44:16.221407 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:44:16.226281 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:44:16.229341 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:44:16.232175 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:44:16.234522 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:44:16.237180 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:44:16.239095 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:44:16.240745 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:44:16.250759 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:44:16.259953 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:44:16.273793 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:44:16.276915 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:44:16.279426 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:16.283624 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:44:16.285911 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:44:16.287851 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:16.290031 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:16.293263 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:16.295892 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:16.299555 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:44:16.309838 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:44:16.312814 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:44:16.315156 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:44:16.317575 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:44:16.319412 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:44:16.321770 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:44:16.323469 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:16.326216 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:44:16.328449 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:44:16.331381 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:44:16.333311 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:44:16.335782 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:44:16.337883 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:44:16.339870 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:44:16.342073 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:44:16.357102 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:44:16.381653 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:44:16.386431 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:44:16.391512 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:44:16.413467 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:44:16.419038 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:44:16.431286 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:44:16.439127 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:44:16.445734 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:44:16.449881 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:44:16.456091 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:44:16.462409 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:44:16.473066 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:44:16.487103 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:44:16.498120 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:44:16.540565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:44:16.544353 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:44:16.650433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:44:16.671226 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:44:16.674976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:44:16.715630 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:44:16.722453 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:44:16.732380 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:44:16.756156 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:44:16.781754 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:44:16.800879 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:44:16.804796 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:44:16.808097 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:44:16.811451 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:44:16.818613 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:44:16.848874 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:44:16.860468 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:44:16.866511 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:44:16.869995 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:44:16.872291 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:44:16.875055 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:44:16.877005 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:44:16.882321 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:44:16.890423 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:44:16.893802 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:44:16.898502 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:44:16.915493 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:44:16.918749 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:44:16.921398 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:44:16.924204 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:44:16.926585 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:44:16.932322 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:44:16.935384 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:44:16.937635 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:44:16.940381 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:44:16.943058 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:44:16.946893 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:44:16.950374 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:44:16.955878 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:44:16.969613 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:44:16.972570 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:44:16.975019 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:44:16.977698 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:44:16.980362 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:44:17.021486 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:44:17.027171 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:44:17.029972 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:44:17.033811 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:44:17.037583 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:44:17.050510 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:44:17.054800 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:44:17.058649 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:44:17.078393 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:44:17.083402 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:44:17.087054 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:44:17.092281 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:44:17.096070 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:44:17.100365 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:44:17.105135 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:44:17.107970 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:44:17.110987 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:44:17.115954 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:44:17.123271 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:44:17.130700 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:44:17.138974 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:44:17.143810 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:44:17.149483 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:44:17.155094 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:44:17.165534 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:44:17.168970 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:44:17.171722 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:44:17.181661 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:44:17.185535 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:44:17.188722 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:44:17.195512 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:44:17.198542 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:44:17.205624 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:44:17.212537 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:44:17.228889 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:44:17.243371 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:44:17.247121 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:44:17.250519 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:44:17.792036 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:44:17.814310 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:44:17.819326 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:44:17.836354 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:44:17.855860 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:44:17.859693 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:44:17.903256 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:44:18.116095 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:44:18.237648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf962c0d0>]}
[0m02:44:18.270387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa310bb0>]}
[0m02:44:18.271823 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:44:18.274266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa3145e0>]}
[0m02:44:18.277504 [info ] [MainThread]: 
[0m02:44:18.279332 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:18.281436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:44:18.290512 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:44:18.292393 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:44:18.293807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:18.306356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:44:18.309693 [debug] [ThreadPool]: On list_*****: Close
[0m02:44:18.313052 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:44:18.322177 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:18.323329 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:44:18.324554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:18.329818 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:44:18.331145 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:18.332213 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:18.337887 [debug] [ThreadPool]: SQL status: SELECT 50 in 0.0 seconds
[0m02:44:18.341750 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:44:18.343235 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:44:18.352058 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.353562 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.355070 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:18.361448 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:18.362812 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.363969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:18.374930 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:44:18.378203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf96695e0>]}
[0m02:44:18.379582 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:18.381895 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.383007 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.385252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:18.386493 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.387585 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.388622 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.389818 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.390850 [debug] [MainThread]: On master: Close
[0m02:44:18.392430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:18.394421 [info ] [MainThread]: 
[0m02:44:18.415627 [debug] [Thread-1  ]: Began running node seed.acme.subscription_periods
[0m02:44:18.417196 [info ] [Thread-1  ]: 1 of 1 START seed file public.subscription_periods ............................. [RUN]
[0m02:44:18.418967 [debug] [Thread-1  ]: Acquiring new ***** connection "seed.acme.subscription_periods"
[0m02:44:18.420185 [debug] [Thread-1  ]: Began compiling node seed.acme.subscription_periods
[0m02:44:18.421426 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.422636 [debug] [Thread-1  ]: Began executing node seed.acme.subscription_periods
[0m02:44:18.477769 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.479073 [debug] [Thread-1  ]: On seed.acme.subscription_periods: BEGIN
[0m02:44:18.480005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:18.505065 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
[0m02:44:18.519934 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.529045 [debug] [Thread-1  ]: On seed.acme.subscription_periods: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "seed.acme.subscription_periods"} */

    create table "*****"."public"."subscription_periods" (subscription_id integer,customer_id integer,start_date date,end_date date,monthly_amount integer)
  
[0m02:44:18.536951 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
[0m02:44:18.743297 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.746785 [debug] [Thread-1  ]: On seed.acme.subscription_periods: 
          insert into "*****"."public"."subscription_periods" (subscription_id, customer_id, start_date, end_date, monthly_amount) values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m02:44:18.751343 [debug] [Thread-1  ]: SQL status: INSERT 0 121 in 0.0 seconds
[0m02:44:18.761106 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.acme.subscription_periods"
[0m02:44:18.801095 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m02:44:18.802902 [debug] [Thread-1  ]: Using ***** connection "seed.acme.subscription_periods"
[0m02:44:18.804208 [debug] [Thread-1  ]: On seed.acme.subscription_periods: COMMIT
[0m02:44:18.806125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.807887 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:18.809366 [debug] [Thread-1  ]: On seed.acme.subscription_periods: Close
[0m02:44:18.811535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '118d2093-5442-4087-afa3-04e104429da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf9493490>]}
[0m02:44:18.813090 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.subscription_periods ......................... [[32mINSERT 121[0m in 0.39s]
[0m02:44:18.815939 [debug] [Thread-1  ]: Finished running node seed.acme.subscription_periods
[0m02:44:18.820260 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:18.821766 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.822730 [debug] [MainThread]: On master: BEGIN
[0m02:44:18.823801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:18.848040 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:44:18.851115 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.852514 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:18.853865 [debug] [MainThread]: On master: COMMIT
[0m02:44:18.855902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:18.857045 [debug] [MainThread]: On master: Close
[0m02:44:18.859039 [info ] [MainThread]: 
[0m02:44:18.860565 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m02:44:18.861658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:18.862676 [debug] [MainThread]: Connection 'seed.acme.subscription_periods' was properly closed.
[0m02:44:18.884965 [info ] [MainThread]: 
[0m02:44:18.886419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:44:18.887983 [info ] [MainThread]: 
[0m02:44:18.889333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:44:18.890575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1e3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf962c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf949a550>]}
[0m02:44:18.891755 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:44:23.286518 | d7123607-9abe-412c-b02c-cfad4c01e134 ==============================
[0m02:44:23.286544 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:44:23.287604 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:44:23.288755 [debug] [MainThread]: Tracking: tracking
[0m02:44:23.297180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92b20>]}
[0m02:44:23.374408 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:44:23.376049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56aa74ff10>]}
[0m02:44:23.485650 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:44:23.488491 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:44:23.532302 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:44:23.537973 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:44:23.541743 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:44:23.545092 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:23.548022 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:23.549423 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:23.551908 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:23.553415 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:23.555429 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:23.566992 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:44:23.569635 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:44:23.572703 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:44:23.576871 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:44:23.580235 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:44:23.583202 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:44:23.585193 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:44:23.588573 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:44:23.590748 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:44:23.592517 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:44:23.605238 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:44:23.613791 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:44:23.627438 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:44:23.630079 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:44:23.632403 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:44:23.636281 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:44:23.638430 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:44:23.640576 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:44:23.642763 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:44:23.647680 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:44:23.650240 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:44:23.653814 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:44:23.663943 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:44:23.667039 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:44:23.669385 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:44:23.671398 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:44:23.673531 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:44:23.676204 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:44:23.678444 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:44:23.681395 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:44:23.683857 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:44:23.687020 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:44:23.689569 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:44:23.694039 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:44:23.698633 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:44:23.701935 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:44:23.705115 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:44:23.722572 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:44:23.747511 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:44:23.751875 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:44:23.756204 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:44:23.775992 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:44:23.780386 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:44:23.792399 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:44:23.800168 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:44:23.805477 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:44:23.809593 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:44:23.815999 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:44:23.821904 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:44:23.835828 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:44:23.851093 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:44:23.868594 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:44:23.916316 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:44:23.921576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:44:23.950109 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:44:23.970335 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:44:23.973989 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:44:23.977970 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:44:23.983728 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:44:23.992678 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:44:24.015809 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:44:24.040434 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:44:24.060238 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:44:24.064005 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:44:24.067341 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:44:24.070396 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:44:24.077358 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:44:24.108996 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:44:24.121065 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:44:24.126287 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:44:24.130038 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:44:24.132557 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:44:24.135199 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:44:24.137140 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:44:24.142575 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:44:24.151781 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:44:24.155307 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:44:24.161077 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:44:24.180046 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:44:24.183401 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:44:24.186088 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:44:24.188973 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:44:24.191130 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:44:24.197210 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:44:24.200206 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:44:24.202333 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:44:24.205687 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:44:24.208732 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:44:24.214319 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:44:24.218355 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:44:24.221700 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:44:24.231133 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:44:24.233727 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:44:24.236075 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:44:24.238316 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:44:24.240816 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:44:24.280108 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:44:24.286042 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:44:24.288686 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:44:24.292629 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:44:24.295890 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:44:24.301858 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:44:24.305732 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:44:24.310643 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:44:24.326833 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:44:24.332564 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:44:24.335354 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:44:24.339107 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:44:24.342259 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:44:24.346060 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:44:24.351591 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:44:24.354430 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:44:24.357149 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:44:24.362640 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:44:24.370681 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:44:24.378084 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:44:24.386948 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:44:24.391174 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:44:24.396782 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:44:24.402600 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:44:24.413384 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:44:24.416893 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:44:24.419398 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:44:24.428554 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:44:24.432049 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:44:24.435730 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:44:24.441930 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:44:24.446040 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:44:24.452332 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:44:24.458450 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:44:24.471138 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:44:24.484453 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:44:24.495327 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:44:24.500674 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:44:25.163662 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:44:25.179745 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:44:25.184348 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:44:25.200052 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:44:25.215766 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:44:25.219021 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:44:25.264277 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:44:25.488764 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:44:25.636772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a82c90d0>]}
[0m02:44:25.640965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f92b20>]}
[0m02:44:25.642690 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:44:25.644723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8f00580>]}
[0m02:44:25.648084 [info ] [MainThread]: 
[0m02:44:25.650196 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:25.652411 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:44:25.663398 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:44:25.665054 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:44:25.666461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:44:25.674672 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:44:25.678690 [debug] [ThreadPool]: On list_*****: Close
[0m02:44:25.682783 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:44:25.694190 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:25.695812 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:44:25.697156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:44:25.702849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.704271 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:44:25.705395 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:44:25.709647 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m02:44:25.714451 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:44:25.716230 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:44:25.726012 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.727625 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.729069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:44:25.735878 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.737374 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.738628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:44:25.747765 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:44:25.750870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a82c3a90>]}
[0m02:44:25.752631 [debug] [MainThread]: On master: ROLLBACK
[0m02:44:25.753957 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.755090 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.756727 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:44:25.757889 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.759437 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.760388 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.761827 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:25.762978 [debug] [MainThread]: On master: Close
[0m02:44:25.764501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:44:25.766219 [info ] [MainThread]: 
[0m02:44:25.786936 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:44:25.789427 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:44:25.793286 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:44:25.795141 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:44:25.797013 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:44:25.829265 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.831042 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:44:25.834046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:44:25.842035 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.843698 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.845088 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01')::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01')::date))
    


[0m02:44:25.851511 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:44:25.855031 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m02:44:25.875802 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:25.876966 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m02:44:25.935874 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m02:44:25.946119 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:44:25.947121 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01' + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m02:44:25.952016 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type interval: "2018-01-01"
LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
             ^

[0m02:44:25.953226 [debug] [Thread-1  ]: On model.acme.util_months: ROLLBACK
[0m02:44:25.955124 [debug] [Thread-1  ]: finished collecting timing info
[0m02:44:25.956065 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:44:25.957319 [debug] [Thread-1  ]: Database Error in model util_months (models/utils/util_months.sql)
  invalid input syntax for type interval: "2018-01-01"
  LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
               ^
  compiled Code at target/run/acme/models/utils/util_months.sql
[0m02:44:25.958351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7123607-9abe-412c-b02c-cfad4c01e134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a8259640>]}
[0m02:44:25.959455 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.util_months ........................ [[31mERROR[0m in 0.17s]
[0m02:44:25.960772 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:44:25.963221 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:44:25.964451 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.965494 [debug] [MainThread]: On master: BEGIN
[0m02:44:25.966543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:44:25.972189 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:44:25.973369 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.974629 [debug] [MainThread]: Using ***** connection "master"
[0m02:44:25.975779 [debug] [MainThread]: On master: COMMIT
[0m02:44:25.977215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:44:25.978269 [debug] [MainThread]: On master: Close
[0m02:44:25.980013 [info ] [MainThread]: 
[0m02:44:25.981552 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:44:25.983078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:44:25.984337 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:44:25.985837 [info ] [MainThread]: 
[0m02:44:25.987114 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:44:25.988390 [info ] [MainThread]: 
[0m02:44:25.989560 [error] [MainThread]: [33mDatabase Error in model util_months (models/utils/util_months.sql)[0m
[0m02:44:25.990759 [error] [MainThread]:   invalid input syntax for type interval: "2018-01-01"
[0m02:44:25.992165 [error] [MainThread]:   LINE 89:     '2018-01-01' + ((interval '1 month') * (row_number() ove...
[0m02:44:25.993329 [error] [MainThread]:                ^
[0m02:44:25.994686 [error] [MainThread]:   compiled Code at target/run/acme/models/utils/util_months.sql
[0m02:44:25.996574 [info ] [MainThread]: 
[0m02:44:25.997841 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:44:25.999581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f22e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f26a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56a81f2130>]}
[0m02:44:26.000853 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:28.016393 | 9bfe17d8-6e50-445c-9e21-73b13be45daa ==============================
[0m02:46:28.016427 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:28.017891 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m02:46:28.019056 [debug] [MainThread]: Tracking: tracking
[0m02:46:28.028556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580b7ca0>]}
[0m02:46:28.032009 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d0__o6mr'
[0m02:46:28.033568 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:46:28.357198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:46:28.359853 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:46:28.597476 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:46:28.692949 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:46:31.853028 [info ] [MainThread]:   Installed from version 0.8.0
[0m02:46:31.856011 [info ] [MainThread]:   Updated version available: 0.9.6
[0m02:46:31.859978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bfe17d8-6e50-445c-9e21-73b13be45daa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a58068280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a581d3d90>]}
[0m02:46:31.862108 [info ] [MainThread]: 
[0m02:46:31.863829 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:46:31.866225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580c4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a58068220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a580680a0>]}
[0m02:46:31.867829 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:35.513186 | c7b233d7-08b3-460f-8a37-65b699a51cd9 ==============================
[0m02:46:35.513215 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:35.514178 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'resource_types': [], 'output': 'selector', 'indirect_selection': 'eager', 'which': 'list'}
[0m02:46:35.515244 [debug] [MainThread]: Tracking: tracking
[0m02:46:35.523297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c2b0>]}
[0m02:46:35.611636 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:46:35.615829 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:46:35.617822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c316c5e0>]}
[0m02:46:35.813123 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:46:35.817852 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:46:35.862345 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:46:35.866765 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:46:35.870190 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:46:35.873914 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:35.877274 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:35.878780 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:35.881161 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:35.882653 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:35.884941 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:35.896413 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:46:35.898692 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:46:35.901728 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:46:35.905893 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:46:35.909146 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:46:35.912039 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:46:35.914112 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:46:35.916691 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:46:35.918481 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:46:35.920647 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:46:35.931447 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:46:35.939634 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:46:35.953506 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:46:35.960135 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:46:35.962510 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:35.967362 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:46:35.969899 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:46:35.971850 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:35.974014 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:35.977623 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:35.980194 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:35.984235 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:46:35.994153 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:46:35.997152 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:46:35.999658 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:46:36.002191 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:46:36.004502 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:46:36.006767 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:46:36.009579 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:36.012630 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:46:36.015404 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:46:36.019274 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:46:36.022168 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:46:36.025322 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:46:36.028551 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:46:36.032015 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:46:36.036302 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:46:36.059290 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:46:36.093258 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:46:36.108045 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:46:36.114324 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:46:36.139179 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:46:36.147237 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:46:36.179613 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:46:36.210700 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:46:36.228073 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:46:36.234408 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:46:36.242944 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:46:36.252636 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:46:36.264845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:46:36.280791 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:46:36.292253 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:46:36.320829 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:46:36.324193 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:46:36.349845 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:46:36.365900 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:46:36.368832 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:46:36.372385 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:46:36.378001 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:46:36.387442 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:46:36.409697 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:46:36.439409 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:46:36.464944 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:46:36.468940 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:46:36.472282 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:46:36.476033 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:46:36.483264 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:46:36.513625 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:46:36.524868 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:46:36.530328 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:46:36.534171 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:46:36.536382 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:46:36.538936 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:46:36.541184 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:46:36.547460 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:46:36.555749 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:46:36.558794 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:46:36.563804 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:46:36.580780 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:46:36.583185 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:46:36.586797 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:46:36.590026 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:46:36.592799 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:46:36.598385 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:46:36.600936 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:46:36.602959 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:46:36.605782 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:46:36.608364 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:46:36.612989 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:46:36.616311 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:46:36.619669 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:46:36.628544 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:46:36.631273 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:46:36.633386 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:46:36.635848 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:46:36.638150 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:46:36.676726 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:46:36.682047 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:46:36.685028 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:46:36.688901 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:46:36.691986 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:46:36.698121 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:46:36.701298 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:46:36.704929 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:46:36.720481 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:46:36.726070 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:46:36.729017 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:46:36.733372 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:46:36.736803 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:46:36.740486 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:46:36.745230 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:46:36.748256 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:46:36.750852 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:46:36.756080 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:46:36.764046 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:46:36.772060 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:46:36.780995 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:46:36.785186 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:46:36.790672 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:46:36.796780 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:46:36.808582 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:46:36.812086 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:46:36.814639 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:46:36.830187 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:46:36.833669 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:46:36.837076 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:46:36.843797 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:46:36.847175 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:46:36.854362 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:46:36.861381 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:46:36.876988 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:46:36.890748 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:46:36.894951 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:46:36.897898 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:46:37.390374 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:46:37.406145 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:46:37.413338 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:46:37.427952 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:46:37.439706 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:46:37.442926 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:46:37.481449 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:46:37.685081 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:46:37.799629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c25210d0>]}
[0m02:46:37.823428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c315f790>]}
[0m02:46:37.825063 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:46:37.826676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b233d7-08b3-460f-8a37-65b699a51cd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c24a0ee0>]}
[0m02:46:37.829028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c31d19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c24a0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1c30bbb80>]}
[0m02:46:37.830325 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:46:58.578001 | 9c2e196c-e2cc-436f-bd8f-bddae5d4eadc ==============================
[0m02:46:58.578027 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:46:58.579352 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:46:58.580707 [debug] [MainThread]: Tracking: tracking
[0m02:46:58.586623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad7629af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9730>]}
[0m02:46:58.679907 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m02:46:58.682125 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m02:46:58.685067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad3a6e700>]}
[0m02:46:58.793894 [debug] [MainThread]: Parsing macros/grant_select_on_schema.sql
[0m02:46:58.797147 [debug] [MainThread]: Parsing macros/adapters.sql
[0m02:46:58.836890 [debug] [MainThread]: Parsing macros/catalog.sql
[0m02:46:58.843275 [debug] [MainThread]: Parsing macros/relations.sql
[0m02:46:58.846382 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m02:46:58.849933 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:58.852861 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:58.854209 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:58.856754 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:58.858755 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:58.860916 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:58.872159 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m02:46:58.875539 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m02:46:58.879381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m02:46:58.883533 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m02:46:58.886381 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m02:46:58.888950 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m02:46:58.891133 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m02:46:58.894011 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m02:46:58.896022 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m02:46:58.897581 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m02:46:58.908073 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m02:46:58.916203 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m02:46:58.930358 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m02:46:58.933094 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m02:46:58.935443 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m02:46:58.939430 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m02:46:58.941936 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m02:46:58.944335 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m02:46:58.946663 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m02:46:58.949862 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m02:46:58.952411 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m02:46:58.955940 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m02:46:58.965861 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m02:46:58.968893 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m02:46:58.971395 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m02:46:58.973631 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m02:46:58.976536 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m02:46:58.979916 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m02:46:58.982396 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m02:46:58.984825 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m02:46:58.986939 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m02:46:58.989716 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m02:46:58.991955 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m02:46:58.994429 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m02:46:58.996638 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m02:46:58.998459 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m02:46:59.000521 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m02:46:59.014900 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m02:46:59.039065 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m02:46:59.045004 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m02:46:59.049893 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m02:46:59.070554 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m02:46:59.075532 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m02:46:59.087250 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m02:46:59.095116 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m02:46:59.100394 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m02:46:59.106628 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m02:46:59.113709 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m02:46:59.119535 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m02:46:59.129149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m02:46:59.142825 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m02:46:59.153980 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m02:46:59.183260 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m02:46:59.186431 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m02:46:59.211152 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m02:46:59.227606 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m02:46:59.230607 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m02:46:59.234320 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m02:46:59.239775 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m02:46:59.250002 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m02:46:59.273439 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m02:46:59.298500 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m02:46:59.317073 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m02:46:59.320904 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m02:46:59.324227 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m02:46:59.327889 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m02:46:59.334811 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m02:46:59.365880 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m02:46:59.377274 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m02:46:59.382508 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
[0m02:46:59.386037 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
[0m02:46:59.388502 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
[0m02:46:59.391204 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
[0m02:46:59.393934 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m02:46:59.400251 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
[0m02:46:59.408375 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
[0m02:46:59.411926 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
[0m02:46:59.416576 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
[0m02:46:59.434242 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
[0m02:46:59.437794 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
[0m02:46:59.440997 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
[0m02:46:59.444393 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
[0m02:46:59.446713 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
[0m02:46:59.452042 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
[0m02:46:59.454507 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
[0m02:46:59.456455 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
[0m02:46:59.459851 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
[0m02:46:59.462468 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
[0m02:46:59.466218 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
[0m02:46:59.469334 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
[0m02:46:59.472392 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
[0m02:46:59.481317 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m02:46:59.484071 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m02:46:59.486705 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m02:46:59.489311 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m02:46:59.492014 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m02:46:59.531401 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
[0m02:46:59.536113 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
[0m02:46:59.538447 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
[0m02:46:59.541924 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
[0m02:46:59.545275 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
[0m02:46:59.550739 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
[0m02:46:59.553781 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
[0m02:46:59.556832 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
[0m02:46:59.572569 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
[0m02:46:59.576945 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
[0m02:46:59.579537 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
[0m02:46:59.583290 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
[0m02:46:59.586263 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
[0m02:46:59.589809 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
[0m02:46:59.594391 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
[0m02:46:59.597106 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
[0m02:46:59.599783 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
[0m02:46:59.604521 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m02:46:59.612059 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m02:46:59.619377 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m02:46:59.627720 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m02:46:59.631935 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m02:46:59.637347 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m02:46:59.643171 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m02:46:59.653289 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m02:46:59.656640 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m02:46:59.659400 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m02:46:59.669095 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m02:46:59.672277 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m02:46:59.675625 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m02:46:59.682427 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m02:46:59.685539 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m02:46:59.692759 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m02:46:59.698278 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m02:46:59.711143 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m02:46:59.723794 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m02:46:59.727586 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m02:46:59.731025 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m02:47:00.226162 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:47:00.241532 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:47:00.246092 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:47:00.260807 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:47:00.271998 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:47:00.275049 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:47:00.313941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:47:00.512804 [warn ] [MainThread]: [[33mWARNING[0m]: 'subscription_periods' is a seed node, but it is specified in the models section
of models/schema.yml. To fix this error, place the `subscription_periods`
specification under the seeds key instead.
[0m02:47:00.647057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad15e10d0>]}
[0m02:47:00.650241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad2119df0>]}
[0m02:47:00.651382 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:47:00.652627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad22a9640>]}
[0m02:47:00.655612 [info ] [MainThread]: 
[0m02:47:00.657207 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:47:00.659414 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:47:00.669076 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:47:00.670307 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:47:00.671603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:47:00.678761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:47:00.681421 [debug] [ThreadPool]: On list_*****: Close
[0m02:47:00.684451 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:47:00.695003 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:47:00.696397 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:47:00.697667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:47:00.707657 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.709090 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:47:00.710369 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:47:00.717803 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.01 seconds
[0m02:47:00.721554 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:47:00.723297 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:47:00.732362 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.733773 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.734850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:47:00.740462 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.743680 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.745854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:47:00.758650 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:47:00.762349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad15cea30>]}
[0m02:47:00.763860 [debug] [MainThread]: On master: ROLLBACK
[0m02:47:00.765226 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.766777 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.768453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:47:00.769641 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.770692 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.771727 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.772779 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:00.773790 [debug] [MainThread]: On master: Close
[0m02:47:00.775334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:47:00.777994 [info ] [MainThread]: 
[0m02:47:00.797186 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:47:00.798802 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:47:00.801272 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:47:00.802155 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:47:00.803352 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:47:00.830013 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:47:00.832652 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:47:00.834163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:47:00.840393 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.841932 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:47:00.843365 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', (2018-01-01)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', (2018-01-01)::date))
    


[0m02:47:00.847087 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot cast type integer to date
LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
                                                                ^

[0m02:47:00.848455 [debug] [Thread-1  ]: On model.acme.util_months: ROLLBACK
[0m02:47:00.851416 [debug] [Thread-1  ]: finished collecting timing info
[0m02:47:00.852781 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:47:00.854457 [debug] [Thread-1  ]: Database Error in model util_months (models/utils/util_months.sql)
  cannot cast type integer to date
  LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
                                                                  ^
[0m02:47:00.855915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2e196c-e2cc-436f-bd8f-bddae5d4eadc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ccba90>]}
[0m02:47:00.857342 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.util_months ........................ [[31mERROR[0m in 0.06s]
[0m02:47:00.859540 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:47:00.862607 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:47:00.863929 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.865025 [debug] [MainThread]: On master: BEGIN
[0m02:47:00.866208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:47:00.872482 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:47:00.873874 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.875322 [debug] [MainThread]: Using ***** connection "master"
[0m02:47:00.877071 [debug] [MainThread]: On master: COMMIT
[0m02:47:00.879419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:47:00.881488 [debug] [MainThread]: On master: Close
[0m02:47:00.883288 [info ] [MainThread]: 
[0m02:47:00.884488 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m02:47:00.885797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:47:00.886942 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:47:00.888217 [info ] [MainThread]: 
[0m02:47:00.889547 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:47:00.890893 [info ] [MainThread]: 
[0m02:47:00.892115 [error] [MainThread]: [33mDatabase Error in model util_months (models/utils/util_months.sql)[0m
[0m02:47:00.893665 [error] [MainThread]:   cannot cast type integer to date
[0m02:47:00.895149 [error] [MainThread]:   LINE 10: ...rrent_date))::date) - date_part('year', (2018-01-01)::date))
[0m02:47:00.896316 [error] [MainThread]:                                                                   ^
[0m02:47:00.897571 [info ] [MainThread]: 
[0m02:47:00.899452 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:47:00.900697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ce61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ce6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ad0ccbcd0>]}
[0m02:47:00.901798 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:49:26.348495 | 8be1e5cc-a340-4c29-8934-58e332534b55 ==============================
[0m02:49:26.348548 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:26.350144 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['util_months'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:26.351060 [debug] [MainThread]: Tracking: tracking
[0m02:49:26.359118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911db0ab50>]}
[0m02:49:26.569065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:49:26.570287 [debug] [MainThread]: Partial parsing: updated file: acme://models/utils/util_months.sql
[0m02:49:26.593367 [debug] [MainThread]: 1603: static parser failed on utils/util_months.sql
[0m02:49:26.646287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on utils/util_months.sql
[0m02:49:26.683886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d8500d0>]}
[0m02:49:26.687192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d922ca0>]}
[0m02:49:26.688652 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:49:26.689965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d8a4190>]}
[0m02:49:26.692482 [info ] [MainThread]: 
[0m02:49:26.694110 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:26.696436 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:49:26.703724 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:49:26.704776 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:49:26.706279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:26.718448 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:49:26.721089 [debug] [ThreadPool]: On list_*****: Close
[0m02:49:26.724287 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:49:26.734085 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:26.735472 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:49:26.736613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:26.742724 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:49:26.744043 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:26.745496 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:49:26.749682 [debug] [ThreadPool]: SQL status: SELECT 51 in 0.0 seconds
[0m02:49:26.753290 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:49:26.754514 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:49:26.766713 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.767916 [debug] [MainThread]: On master: BEGIN
[0m02:49:26.768914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:26.779284 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:26.780695 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.781763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:26.801613 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m02:49:26.804517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d850c10>]}
[0m02:49:26.807548 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:26.808792 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.809974 [debug] [MainThread]: On master: BEGIN
[0m02:49:26.811481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:26.812696 [debug] [MainThread]: On master: COMMIT
[0m02:49:26.813686 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:26.814799 [debug] [MainThread]: On master: COMMIT
[0m02:49:26.816110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:26.817093 [debug] [MainThread]: On master: Close
[0m02:49:26.818529 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:26.819509 [info ] [MainThread]: 
[0m02:49:26.835748 [debug] [Thread-1  ]: Began running node model.acme.util_months
[0m02:49:26.837421 [info ] [Thread-1  ]: 1 of 1 START sql view model public.util_months ................................. [RUN]
[0m02:49:26.839496 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.util_months"
[0m02:49:26.840720 [debug] [Thread-1  ]: Began compiling node model.acme.util_months
[0m02:49:26.841883 [debug] [Thread-1  ]: Compiling model.acme.util_months
[0m02:49:26.863365 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.865349 [debug] [Thread-1  ]: On model.acme.util_months: BEGIN
[0m02:49:26.866714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:49:26.871416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:49:26.872493 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.873683 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */


        select 

    
        (

    
        (date_part('year', (date_trunc('month', current_date))::date) - date_part('year', ('2018-01-01'::date)::date))
    

 * 12 + date_part('month', (date_trunc('month', current_date))::date) - date_part('month', ('2018-01-01'::date)::date))
    


[0m02:49:26.875409 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m02:49:26.878546 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.util_months"
[0m02:49:26.885329 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:26.886488 [debug] [Thread-1  ]: Began executing node model.acme.util_months
[0m02:49:26.944741 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.util_months"
[0m02:49:26.950222 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.951563 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */

  create view "*****"."public"."util_months__dbt_tmp" as (
    

/*
call as follows:

date_spine(
    "day",
    "to_date('01/01/2016', 'mm/dd/yyyy')",
    "dateadd(week, 1, current_date)"
)

*/

with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
    
    

    )

    select *
    from unioned
    where generated_number <= 59.0
    order by generated_number



),

all_periods as (

    select (
        

    '2018-01-01'::date + ((interval '1 month') * (row_number() over (order by 1) - 1))


    ) as date_month
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_month <= date_trunc('month', current_date)

)

select * from filtered


  );
[0m02:49:26.963892 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:49:26.974350 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:26.975856 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
alter table "*****"."public"."util_months__dbt_tmp" rename to "util_months"
[0m02:49:26.978346 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:49:27.002917 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m02:49:27.004458 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:27.005553 [debug] [Thread-1  ]: On model.acme.util_months: COMMIT
[0m02:49:27.007915 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:49:27.015507 [debug] [Thread-1  ]: Using ***** connection "model.acme.util_months"
[0m02:49:27.016957 [debug] [Thread-1  ]: On model.acme.util_months: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.util_months"} */
drop view if exists "*****"."public"."util_months__dbt_backup" cascade
[0m02:49:27.018647 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:49:27.021715 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:27.022998 [debug] [Thread-1  ]: On model.acme.util_months: Close
[0m02:49:27.024886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8be1e5cc-a340-4c29-8934-58e332534b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911cfcaf10>]}
[0m02:49:27.026292 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.util_months ............................ [[32mCREATE VIEW[0m in 0.19s]
[0m02:49:27.027876 [debug] [Thread-1  ]: Finished running node model.acme.util_months
[0m02:49:27.030813 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:27.031952 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:27.033084 [debug] [MainThread]: On master: BEGIN
[0m02:49:27.033979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:27.039215 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:27.040803 [debug] [MainThread]: On master: COMMIT
[0m02:49:27.041869 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:27.043051 [debug] [MainThread]: On master: COMMIT
[0m02:49:27.044613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:27.045740 [debug] [MainThread]: On master: Close
[0m02:49:27.047513 [info ] [MainThread]: 
[0m02:49:27.049119 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:49:27.050527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:27.051715 [debug] [MainThread]: Connection 'model.acme.util_months' was properly closed.
[0m02:49:27.053030 [info ] [MainThread]: 
[0m02:49:27.054519 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:49:27.056003 [info ] [MainThread]: 
[0m02:49:27.057583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:49:27.059167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ff430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f911d7ffb20>]}
[0m02:49:27.060492 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:49:31.484535 | 0a3c389a-52e5-4c99-a284-1ec015968861 ==============================
[0m02:49:31.484567 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:49:31.486964 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:49:31.489646 [debug] [MainThread]: Tracking: tracking
[0m02:49:31.499390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3d01b50>]}
[0m02:49:31.740801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:49:31.742298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:49:31.752572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a6e0d0>]}
[0m02:49:31.755803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3ba7640>]}
[0m02:49:31.756970 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:49:31.758579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3ba7880>]}
[0m02:49:31.761723 [info ] [MainThread]: 
[0m02:49:31.763773 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:31.766308 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:49:31.784799 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:49:31.786273 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:49:31.787622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:31.795313 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:49:31.798690 [debug] [ThreadPool]: On list_*****: Close
[0m02:49:31.802742 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:49:31.815306 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:31.817090 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:49:31.818692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:31.824987 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:49:31.827121 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:49:31.828621 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:49:31.834056 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:49:31.838015 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:49:31.839523 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:49:31.849411 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.851082 [debug] [MainThread]: On master: BEGIN
[0m02:49:31.852853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:31.858960 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:31.860362 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.861582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:49:31.871079 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:49:31.873923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3cff880>]}
[0m02:49:31.875437 [debug] [MainThread]: On master: ROLLBACK
[0m02:49:31.877143 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.878587 [debug] [MainThread]: On master: BEGIN
[0m02:49:31.880503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:49:31.881892 [debug] [MainThread]: On master: COMMIT
[0m02:49:31.882993 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:31.884171 [debug] [MainThread]: On master: COMMIT
[0m02:49:31.885652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:31.886855 [debug] [MainThread]: On master: Close
[0m02:49:31.888560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:31.889683 [info ] [MainThread]: 
[0m02:49:31.911321 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:49:31.913285 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:49:31.915483 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:31.916771 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:49:31.918611 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:49:31.924674 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:49:31.929811 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:31.931236 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:49:31.989318 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:49:31.999208 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:32.000938 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:49:32.002470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:49:32.008761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:49:32.010740 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:49:32.011976 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when is_active then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when is_active then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        first_active_month = date_month as is_first_month,
        last_active_month = date_month as is_last_month

    from joined

)

select * from final
  );
[0m02:49:32.016135 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "is_active" does not exist
LINE 79:         min(case when is_active then date_month end) over (
                               ^

[0m02:49:32.018242 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:49:32.020052 [debug] [Thread-1  ]: finished collecting timing info
[0m02:49:32.021528 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:49:32.023478 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "is_active" does not exist
  LINE 79:         min(case when is_active then date_month end) over (
                                 ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:49:32.026854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a3c389a-52e5-4c99-a284-1ec015968861', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a7c490>]}
[0m02:49:32.028988 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.11s]
[0m02:49:32.030905 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:49:32.035725 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:49:32.037564 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:32.038877 [debug] [MainThread]: On master: BEGIN
[0m02:49:32.040340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:32.048129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:49:32.050610 [debug] [MainThread]: On master: COMMIT
[0m02:49:32.053017 [debug] [MainThread]: Using ***** connection "master"
[0m02:49:32.054333 [debug] [MainThread]: On master: COMMIT
[0m02:49:32.055958 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:49:32.057595 [debug] [MainThread]: On master: Close
[0m02:49:32.059837 [info ] [MainThread]: 
[0m02:49:32.062026 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m02:49:32.064135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:32.066280 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:49:32.068219 [info ] [MainThread]: 
[0m02:49:32.069774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:49:32.071480 [info ] [MainThread]: 
[0m02:49:32.073736 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:49:32.075511 [error] [MainThread]:   column "is_active" does not exist
[0m02:49:32.077730 [error] [MainThread]:   LINE 79:         min(case when is_active then date_month end) over (
[0m02:49:32.080907 [error] [MainThread]:                                  ^
[0m02:49:32.084795 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:49:32.087972 [info ] [MainThread]: 
[0m02:49:32.092327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:49:32.095288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3239340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3239d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbd3a7c160>]}
[0m02:49:32.097735 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:51:56.804853 | 68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad ==============================
[0m02:51:56.804889 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:51:56.807294 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:51:56.808860 [debug] [MainThread]: Tracking: tracking
[0m02:51:56.814930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c7621af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c22a2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c22a2730>]}
[0m02:51:57.012835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:51:57.014160 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:51:57.038156 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:51:57.146182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c15349a0>]}
[0m02:51:57.149473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c20ebee0>]}
[0m02:51:57.151684 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:51:57.154004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c2037ee0>]}
[0m02:51:57.160983 [info ] [MainThread]: 
[0m02:51:57.165682 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:51:57.171504 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:51:57.194161 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:51:57.195908 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:51:57.197336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:51:57.208168 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:51:57.211440 [debug] [ThreadPool]: On list_*****: Close
[0m02:51:57.217336 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:51:57.228522 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:51:57.230311 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:51:57.231924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:51:57.238091 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.239546 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:51:57.240657 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:51:57.244721 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:51:57.248513 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:51:57.249902 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:51:57.260222 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.261774 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.263487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:51:57.275195 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.276895 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.278233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:51:57.299914 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
[0m02:51:57.303129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c205cd90>]}
[0m02:51:57.304669 [debug] [MainThread]: On master: ROLLBACK
[0m02:51:57.306064 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.307047 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.308885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:51:57.309965 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.311007 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.312370 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.313799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:57.314921 [debug] [MainThread]: On master: Close
[0m02:51:57.316634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:51:57.318021 [info ] [MainThread]: 
[0m02:51:57.338218 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:51:57.339754 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:51:57.342195 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.343542 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:51:57.344997 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:51:57.351853 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:51:57.356541 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:57.357922 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:51:57.420173 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:51:57.437997 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.439376 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:51:57.440655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:51:57.450694 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.465430 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:51:57.466967 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        first_active_month = date_month as is_first_month,
        last_active_month = date_month as is_last_month

    from joined

)

select * from final
  );
[0m02:51:57.506507 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "first_active_month" does not exist
LINE 88:         first_active_month = date_month as is_first_month,
                 ^

[0m02:51:57.537608 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:51:57.539942 [debug] [Thread-1  ]: finished collecting timing info
[0m02:51:57.541764 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:51:57.544026 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "first_active_month" does not exist
  LINE 88:         first_active_month = date_month as is_first_month,
                   ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:51:57.545539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68eeafe8-cf47-4afb-a5c3-f9d6aa76c6ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c0ce9f70>]}
[0m02:51:57.547881 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.20s]
[0m02:51:57.549626 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:51:57.553189 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:51:57.554675 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.556033 [debug] [MainThread]: On master: BEGIN
[0m02:51:57.557551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:51:57.563715 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:51:57.564987 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.566321 [debug] [MainThread]: Using ***** connection "master"
[0m02:51:57.567624 [debug] [MainThread]: On master: COMMIT
[0m02:51:57.569109 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:51:57.570475 [debug] [MainThread]: On master: Close
[0m02:51:57.572345 [info ] [MainThread]: 
[0m02:51:57.573745 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:51:57.575318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:51:57.576481 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:51:57.577706 [info ] [MainThread]: 
[0m02:51:57.579219 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:51:57.580493 [info ] [MainThread]: 
[0m02:51:57.582084 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:51:57.583309 [error] [MainThread]:   column "first_active_month" does not exist
[0m02:51:57.584560 [error] [MainThread]:   LINE 88:         first_active_month = date_month as is_first_month,
[0m02:51:57.585804 [error] [MainThread]:                    ^
[0m02:51:57.587068 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:51:57.588260 [info ] [MainThread]: 
[0m02:51:57.589545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:51:57.590978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c1572a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c1572490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8c0ce9ac0>]}
[0m02:51:57.592196 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:52:59.048139 | 4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c ==============================
[0m02:52:59.048196 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:52:59.049292 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:52:59.050317 [debug] [MainThread]: Tracking: tracking
[0m02:52:59.056599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2de3b50>]}
[0m02:52:59.245663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:52:59.247146 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:52:59.269591 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:52:59.374009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2088fd0>]}
[0m02:52:59.377306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2c26550>]}
[0m02:52:59.378561 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:52:59.379863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2b78f70>]}
[0m02:52:59.382929 [info ] [MainThread]: 
[0m02:52:59.384418 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:52:59.386622 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:52:59.403341 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:52:59.405111 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:52:59.406523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:59.413332 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:52:59.416225 [debug] [ThreadPool]: On list_*****: Close
[0m02:52:59.420244 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:52:59.438786 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:52:59.440821 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:52:59.442050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:59.447527 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.449056 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:52:59.450117 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:52:59.453776 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:52:59.458502 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:52:59.460512 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:52:59.469824 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.471638 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.472995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:59.478519 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.479966 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.481023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:52:59.492457 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:52:59.495639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff2b9ceb0>]}
[0m02:52:59.497089 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:59.498384 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.499713 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.501419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:59.503130 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.504521 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.505923 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.507542 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:59.509025 [debug] [MainThread]: On master: Close
[0m02:52:59.513652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:59.516590 [info ] [MainThread]: 
[0m02:52:59.536763 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:52:59.538693 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:52:59.541491 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.542849 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:52:59.544040 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:52:59.550250 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:52:59.554116 [debug] [Thread-1  ]: finished collecting timing info
[0m02:52:59.555554 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:52:59.615015 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:52:59.619455 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.620583 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:52:59.621594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:52:59.626797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.628529 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:52:59.629503 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when first_active_month = date_month then true
          else false end as is_first_month,
        case
          when last_active_month = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m02:52:59.632101 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "first_active_month" does not exist
LINE 89:           when first_active_month = date_month then true
                        ^

[0m02:52:59.633231 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: ROLLBACK
[0m02:52:59.634691 [debug] [Thread-1  ]: finished collecting timing info
[0m02:52:59.635956 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:52:59.637540 [debug] [Thread-1  ]: Database Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)
  column "first_active_month" does not exist
  LINE 89:           when first_active_month = date_month then true
                          ^
  compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:52:59.639231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bcbdd4e-4dab-49f3-ada0-9cbc08d6ef3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff1829ac0>]}
[0m02:52:59.641249 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_revenue_by_month .......... [[31mERROR[0m in 0.10s]
[0m02:52:59.642763 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:52:59.646536 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:52:59.647862 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.649016 [debug] [MainThread]: On master: BEGIN
[0m02:52:59.650090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:59.655914 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:52:59.657370 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.658445 [debug] [MainThread]: Using ***** connection "master"
[0m02:52:59.659695 [debug] [MainThread]: On master: COMMIT
[0m02:52:59.661201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:59.662295 [debug] [MainThread]: On master: Close
[0m02:52:59.663980 [info ] [MainThread]: 
[0m02:52:59.665133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m02:52:59.666428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:59.667495 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:52:59.668721 [info ] [MainThread]: 
[0m02:52:59.669962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:52:59.671464 [info ] [MainThread]: 
[0m02:52:59.672867 [error] [MainThread]: [33mDatabase Error in model customer_revenue_by_month (models/customer_revenue_by_month.sql)[0m
[0m02:52:59.674268 [error] [MainThread]:   column "first_active_month" does not exist
[0m02:52:59.675642 [error] [MainThread]:   LINE 89:           when first_active_month = date_month then true
[0m02:52:59.676786 [error] [MainThread]:                           ^
[0m02:52:59.677991 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_revenue_by_month.sql
[0m02:52:59.679318 [info ] [MainThread]: 
[0m02:52:59.680489 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:52:59.681979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ff20b3190>]}
[0m02:52:59.683298 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:53:49.486996 | 91299223-e00b-48c2-8a69-55c2e1a8a0bb ==============================
[0m02:53:49.487029 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:53:49.488938 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_revenue_by_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:49.491233 [debug] [MainThread]: Tracking: tracking
[0m02:53:49.498190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f513cb50>]}
[0m02:53:49.698146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:53:49.699495 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_revenue_by_month.sql
[0m02:53:49.721751 [debug] [MainThread]: 1699: static parser successfully parsed customer_revenue_by_month.sql
[0m02:53:49.823069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f45eefd0>]}
[0m02:53:49.826711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4f77550>]}
[0m02:53:49.827993 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:53:49.829237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4ec9f70>]}
[0m02:53:49.833595 [info ] [MainThread]: 
[0m02:53:49.838026 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:49.842604 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:53:49.862607 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:53:49.864032 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:53:49.865895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:49.876094 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:53:49.879222 [debug] [ThreadPool]: On list_*****: Close
[0m02:53:49.885077 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:53:49.900287 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:49.902413 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:53:49.903901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:49.910110 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:53:49.911508 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:49.912866 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:49.916934 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.0 seconds
[0m02:53:49.921264 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:53:49.923018 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:53:49.933927 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.936074 [debug] [MainThread]: On master: BEGIN
[0m02:53:49.937744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:49.944335 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:49.945984 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.947236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:49.960076 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
[0m02:53:49.963052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4eedeb0>]}
[0m02:53:49.964415 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:49.965904 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.967031 [debug] [MainThread]: On master: BEGIN
[0m02:53:49.969125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:49.970721 [debug] [MainThread]: On master: COMMIT
[0m02:53:49.971889 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:49.973041 [debug] [MainThread]: On master: COMMIT
[0m02:53:49.974406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:49.975439 [debug] [MainThread]: On master: Close
[0m02:53:49.977060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:49.978317 [info ] [MainThread]: 
[0m02:53:49.999576 [debug] [Thread-1  ]: Began running node model.acme.customer_revenue_by_month
[0m02:53:50.001402 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_revenue_by_month ................... [RUN]
[0m02:53:50.003818 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.005536 [debug] [Thread-1  ]: Began compiling node model.acme.customer_revenue_by_month
[0m02:53:50.007011 [debug] [Thread-1  ]: Compiling model.acme.customer_revenue_by_month
[0m02:53:50.013427 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_revenue_by_month"
[0m02:53:50.034419 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:50.036130 [debug] [Thread-1  ]: Began executing node model.acme.customer_revenue_by_month
[0m02:53:50.107243 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_revenue_by_month"
[0m02:53:50.111819 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.112777 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: BEGIN
[0m02:53:50.113876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:53:50.119565 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:53:50.121266 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.122730 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */

  create view "*****"."public"."customer_revenue_by_month__dbt_tmp" as (
    with subscription_periods as (

    select * from "*****"."public"."subscription_periods"

),

months as (

    select * from "*****"."public"."util_months"

),

-- determine when a given account had its first and last (or most recent) month
customers as (

    select
        customer_id,
        date_trunc('month', min(start_date)) as date_month_start,
        date_trunc('month', max(end_date)) as date_month_end

    from subscription_periods

    group by 1

),

-- create one record per month between a customer's first and last month
-- (example of a date spine)
customer_months as (

    select
        customers.customer_id,
        months.date_month

    from customers

    inner join months
        -- all months after start date
        on  months.date_month >= customers.date_month_start
        -- and before end date
        and months.date_month < customers.date_month_end

),

-- join the account-month spine to MRR base model, pulling through most recent dates
-- and plan info for month rows that have no invoices (i.e. churns)
joined as (

    select
        customer_months.date_month,
        customer_months.customer_id,
        coalesce(subscription_periods.monthly_amount, 0) as mrr

    from customer_months

    left join subscription_periods
        on customer_months.customer_id = subscription_periods.customer_id
        -- month is after a subscription start date
        and customer_months.date_month >= subscription_periods.start_date
        -- month is before a subscription end date (and handle null case)
        and (customer_months.date_month < subscription_periods.end_date
                or subscription_periods.end_date is null)

),

final as (

    select
        date_month,
        customer_id,
        mrr,

        mrr > 0 as is_active,

        -- calculate first and last months
        min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as first_active_month,

        max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) as last_active_month,

        -- calculate if this record is the first or last month
        case
          when min(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_first_month,
        case
          when max(case when mrr > 0 then date_month end) over (
            partition by customer_id
        ) = date_month then true
          else false end as is_last_month

    from joined

)

select * from final
  );
[0m02:53:50.128801 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:53:50.139947 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.141787 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
alter table "*****"."public"."customer_revenue_by_month__dbt_tmp" rename to "customer_revenue_by_month"
[0m02:53:50.143816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:53:50.171481 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m02:53:50.174441 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.176105 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: COMMIT
[0m02:53:50.180941 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:53:50.194859 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_revenue_by_month"
[0m02:53:50.197570 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_revenue_by_month"} */
drop view if exists "*****"."public"."customer_revenue_by_month__dbt_backup" cascade
[0m02:53:50.200970 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:53:50.206703 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:50.207888 [debug] [Thread-1  ]: On model.acme.customer_revenue_by_month: Close
[0m02:53:50.209781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91299223-e00b-48c2-8a69-55c2e1a8a0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4572970>]}
[0m02:53:50.212383 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_revenue_by_month .............. [[32mCREATE VIEW[0m in 0.21s]
[0m02:53:50.213567 [debug] [Thread-1  ]: Finished running node model.acme.customer_revenue_by_month
[0m02:53:50.216540 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:50.217946 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:50.219358 [debug] [MainThread]: On master: BEGIN
[0m02:53:50.220725 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:50.226749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:50.228185 [debug] [MainThread]: On master: COMMIT
[0m02:53:50.229437 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:50.230613 [debug] [MainThread]: On master: COMMIT
[0m02:53:50.232119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:50.234970 [debug] [MainThread]: On master: Close
[0m02:53:50.237412 [info ] [MainThread]: 
[0m02:53:50.239296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:53:50.241731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:50.244319 [debug] [MainThread]: Connection 'model.acme.customer_revenue_by_month' was properly closed.
[0m02:53:50.246239 [info ] [MainThread]: 
[0m02:53:50.247787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:53:50.249252 [info ] [MainThread]: 
[0m02:53:50.251072 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:53:50.252976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4594430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f45942e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3f4594b20>]}
[0m02:53:50.254623 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:53:54.936531 | 882621ac-e923-4cda-85eb-a0de03201756 ==============================
[0m02:53:54.936573 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:53:54.938186 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:53:54.939972 [debug] [MainThread]: Tracking: tracking
[0m02:53:54.947691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b548b50>]}
[0m02:53:55.126590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:53:55.127766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:53:55.136534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b50d0>]}
[0m02:53:55.140557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b3ec640>]}
[0m02:53:55.142471 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:53:55.144132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b3ec880>]}
[0m02:53:55.146681 [info ] [MainThread]: 
[0m02:53:55.148325 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:55.150289 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:53:55.180615 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:53:55.183667 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:53:55.185942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:55.198607 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:53:55.206239 [debug] [ThreadPool]: On list_*****: Close
[0m02:53:55.213154 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:53:55.245251 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:55.247796 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:53:55.249957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:55.259755 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.262247 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:53:55.264741 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:53:55.273076 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.01 seconds
[0m02:53:55.282296 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:53:55.284349 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:53:55.301193 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.303092 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.305417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:55.316263 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.319876 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.322104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:55.343946 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
[0m02:53:55.349137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b53f040>]}
[0m02:53:55.351581 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:55.354052 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.355983 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.358789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:55.361288 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.363352 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.364890 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.367281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:55.369724 [debug] [MainThread]: On master: Close
[0m02:53:55.372901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:55.375120 [info ] [MainThread]: 
[0m02:53:55.407592 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:53:55.410347 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:53:55.412941 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:53:55.414584 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:53:55.416399 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:53:55.425945 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:53:55.438040 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:55.440170 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:53:55.546772 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:53:55.553910 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:53:55.556004 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:53:55.558102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:53:55.568358 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.570580 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:53:55.572825 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd(month, 1, date_month)::date as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:53:55.576744 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 14:         dateadd(month, 1, date_month)::date as date_month,
                         ^

[0m02:53:55.578421 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:53:55.580473 [debug] [Thread-1  ]: finished collecting timing info
[0m02:53:55.582106 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:53:55.584947 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  column "month" does not exist
  LINE 14:         dateadd(month, 1, date_month)::date as date_month,
                           ^
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:53:55.586989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '882621ac-e923-4cda-85eb-a0de03201756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2d2bb0>]}
[0m02:53:55.589086 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.17s]
[0m02:53:55.591473 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:53:55.597550 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:53:55.599560 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.601287 [debug] [MainThread]: On master: BEGIN
[0m02:53:55.603007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:55.612365 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:53:55.614242 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.615876 [debug] [MainThread]: Using ***** connection "master"
[0m02:53:55.617662 [debug] [MainThread]: On master: COMMIT
[0m02:53:55.619812 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:55.622100 [debug] [MainThread]: On master: Close
[0m02:53:55.624025 [info ] [MainThread]: 
[0m02:53:55.625464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m02:53:55.627257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:55.628706 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:53:55.630841 [info ] [MainThread]: 
[0m02:53:55.632514 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:55.634689 [info ] [MainThread]: 
[0m02:53:55.636578 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:53:55.638763 [error] [MainThread]:   column "month" does not exist
[0m02:53:55.640941 [error] [MainThread]:   LINE 14:         dateadd(month, 1, date_month)::date as date_month,
[0m02:53:55.642937 [error] [MainThread]:                            ^
[0m02:53:55.644613 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:53:55.646425 [info ] [MainThread]: 
[0m02:53:55.648245 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:53:55.650516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96b2d2070>]}
[0m02:53:55.657292 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:54:57.669217 | 15c7e76c-a97f-4c38-80a3-07256b847ba9 ==============================
[0m02:54:57.669289 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:54:57.674456 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:54:57.676314 [debug] [MainThread]: Tracking: tracking
[0m02:54:57.684363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7b5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca7b5700>]}
[0m02:54:57.895973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:57.897376 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:54:57.920285 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:54:58.004580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9ceb0d0>]}
[0m02:54:58.007944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca606eb0>]}
[0m02:54:58.009303 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:54:58.011007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca554dc0>]}
[0m02:54:58.014382 [info ] [MainThread]: 
[0m02:54:58.016065 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:54:58.018211 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:54:58.034869 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:54:58.036292 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:54:58.037488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:58.046879 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:54:58.049816 [debug] [ThreadPool]: On list_*****: Close
[0m02:54:58.053172 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:54:58.062837 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:54:58.064401 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:54:58.065498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:58.071208 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.072591 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:54:58.073703 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:54:58.078675 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:54:58.082812 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:54:58.084335 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:54:58.093906 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.095816 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.099839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:58.107853 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.110195 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.112857 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:58.127184 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:54:58.131002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99ca781b80>]}
[0m02:54:58.133184 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:58.140042 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.142749 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.148474 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:58.150141 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.151741 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.152992 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.154732 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:58.156014 [debug] [MainThread]: On master: Close
[0m02:54:58.158470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:58.161352 [info ] [MainThread]: 
[0m02:54:58.184368 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:54:58.186234 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:54:58.188377 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:54:58.189464 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:54:58.190719 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:54:58.198687 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:54:58.204584 [debug] [Thread-1  ]: finished collecting timing info
[0m02:54:58.205897 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:54:58.263733 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:54:58.293203 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:54:58.295082 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:54:58.296523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:54:58.302014 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.303896 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:54:58.307088 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd('month', 1, date_month)::date as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:54:58.309446 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function dateadd(unknown, integer, timestamp without time zone) does not exist
LINE 14:         dateadd('month', 1, date_month)::date as date_month,
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:54:58.310919 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:54:58.312748 [debug] [Thread-1  ]: finished collecting timing info
[0m02:54:58.314065 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:54:58.316106 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  function dateadd(unknown, integer, timestamp without time zone) does not exist
  LINE 14:         dateadd('month', 1, date_month)::date as date_month,
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:54:58.317852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15c7e76c-a97f-4c38-80a3-07256b847ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c894f0>]}
[0m02:54:58.318955 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.13s]
[0m02:54:58.320360 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:54:58.322865 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:54:58.323904 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.325013 [debug] [MainThread]: On master: BEGIN
[0m02:54:58.326209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:58.331601 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:54:58.332934 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.334584 [debug] [MainThread]: Using ***** connection "master"
[0m02:54:58.335643 [debug] [MainThread]: On master: COMMIT
[0m02:54:58.336891 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:58.337878 [debug] [MainThread]: On master: Close
[0m02:54:58.339616 [info ] [MainThread]: 
[0m02:54:58.341375 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:54:58.342643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:58.343889 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:54:58.345457 [info ] [MainThread]: 
[0m02:54:58.346789 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:54:58.348115 [info ] [MainThread]: 
[0m02:54:58.349351 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:54:58.350560 [error] [MainThread]:   function dateadd(unknown, integer, timestamp without time zone) does not exist
[0m02:54:58.351565 [error] [MainThread]:   LINE 14:         dateadd('month', 1, date_month)::date as date_month,
[0m02:54:58.352599 [error] [MainThread]:                    ^
[0m02:54:58.353754 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m02:54:58.354959 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:54:58.356134 [info ] [MainThread]: 
[0m02:54:58.357105 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:54:58.358341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c73bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c73520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c9c734f0>]}
[0m02:54:58.359511 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:56:30.419139 | 6800ef23-1357-4b05-80be-376d6d4c8940 ==============================
[0m02:56:30.419220 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:56:30.420044 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:56:30.422175 [debug] [MainThread]: Tracking: tracking
[0m02:56:30.427585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff303cb20>]}
[0m02:56:30.603957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:56:30.605349 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:56:30.626818 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:56:30.701852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff23640d0>]}
[0m02:56:30.705128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e7e550>]}
[0m02:56:30.706733 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:56:30.708120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e84fd0>]}
[0m02:56:30.710504 [info ] [MainThread]: 
[0m02:56:30.712175 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:56:30.713951 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:56:30.729271 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:56:30.730599 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:56:30.731985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:30.737904 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:56:30.740517 [debug] [ThreadPool]: On list_*****: Close
[0m02:56:30.743360 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:56:30.752648 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:56:30.754109 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:56:30.755492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:30.760687 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:56:30.761975 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:56:30.763028 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:56:30.766549 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:56:30.770886 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:56:30.772426 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:56:30.780860 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.782117 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.783330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:30.788717 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:56:30.790073 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.791263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:30.803560 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:56:30.806418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff2e7e400>]}
[0m02:56:30.807814 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:30.809060 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.810217 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.811800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.812967 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.814094 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.815216 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.816761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:30.817953 [debug] [MainThread]: On master: Close
[0m02:56:30.820633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:30.822094 [info ] [MainThread]: 
[0m02:56:30.837277 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:56:30.838684 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:56:30.840237 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:56:30.841169 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:56:30.842136 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:56:30.846358 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:56:30.849412 [debug] [Thread-1  ]: finished collecting timing info
[0m02:56:30.850663 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:56:30.901887 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:56:30.905951 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:56:30.907029 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:56:30.907948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:56:30.912437 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.913552 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:56:30.914573 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        dateadd(month, 1, date_month::date) as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:56:30.916674 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "month" does not exist
LINE 14:         dateadd(month, 1, date_month::date) as date_month,
                         ^

[0m02:56:30.917790 [debug] [Thread-1  ]: On model.acme.customer_churn_month: ROLLBACK
[0m02:56:30.921302 [debug] [Thread-1  ]: finished collecting timing info
[0m02:56:30.923424 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:56:30.924917 [debug] [Thread-1  ]: Database Error in model customer_churn_month (models/customer_churn_month.sql)
  column "month" does not exist
  LINE 14:         dateadd(month, 1, date_month::date) as date_month,
                           ^
  compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:56:30.926158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6800ef23-1357-4b05-80be-376d6d4c8940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1a99f40>]}
[0m02:56:30.927520 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.customer_churn_month ............... [[31mERROR[0m in 0.09s]
[0m02:56:30.929030 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:56:30.931667 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:56:30.932972 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.934080 [debug] [MainThread]: On master: BEGIN
[0m02:56:30.935304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:30.940279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:30.941631 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.942589 [debug] [MainThread]: Using ***** connection "master"
[0m02:56:30.943662 [debug] [MainThread]: On master: COMMIT
[0m02:56:30.945047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:30.946137 [debug] [MainThread]: On master: Close
[0m02:56:30.947729 [info ] [MainThread]: 
[0m02:56:30.949196 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m02:56:30.950691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:30.951718 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:56:30.952869 [info ] [MainThread]: 
[0m02:56:30.954337 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:56:30.955756 [info ] [MainThread]: 
[0m02:56:30.957109 [error] [MainThread]: [33mDatabase Error in model customer_churn_month (models/customer_churn_month.sql)[0m
[0m02:56:30.958532 [error] [MainThread]:   column "month" does not exist
[0m02:56:30.959884 [error] [MainThread]:   LINE 14:         dateadd(month, 1, date_month::date) as date_month,
[0m02:56:30.961040 [error] [MainThread]:                            ^
[0m02:56:30.962550 [error] [MainThread]:   compiled Code at target/run/acme/models/customer_churn_month.sql
[0m02:56:30.963626 [info ] [MainThread]: 
[0m02:56:30.964971 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:56:30.967451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff22fdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff22fdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faff1a82f70>]}
[0m02:56:30.968746 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:57:38.006657 | e81cf26b-c5e9-44d6-84c7-fae1a91e1dff ==============================
[0m02:57:38.006684 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:57:38.008209 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['customer_churn_month'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:38.009840 [debug] [MainThread]: Tracking: tracking
[0m02:57:38.015382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87544b20>]}
[0m02:57:38.212856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:57:38.214292 [debug] [MainThread]: Partial parsing: updated file: acme://models/customer_churn_month.sql
[0m02:57:38.235782 [debug] [MainThread]: 1699: static parser successfully parsed customer_churn_month.sql
[0m02:57:38.312382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8686b0d0>]}
[0m02:57:38.315472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87386550>]}
[0m02:57:38.316783 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:57:38.318092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a8738efd0>]}
[0m02:57:38.321272 [info ] [MainThread]: 
[0m02:57:38.323374 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:38.325655 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:57:38.342649 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:57:38.344405 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:57:38.345726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:38.352511 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:38.355598 [debug] [ThreadPool]: On list_*****: Close
[0m02:57:38.359023 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:57:38.368731 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:38.370129 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:57:38.371378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:38.377060 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.378345 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:38.379450 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:57:38.383105 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.0 seconds
[0m02:57:38.386643 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:57:38.388222 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:57:38.397900 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.399266 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.400510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:38.406001 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.407729 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.409306 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:38.418431 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
[0m02:57:38.421639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a87386400>]}
[0m02:57:38.423200 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:38.424716 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.425858 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.427541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:38.428518 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.429409 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.430612 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.432346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.433368 [debug] [MainThread]: On master: Close
[0m02:57:38.435456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:38.443274 [info ] [MainThread]: 
[0m02:57:38.465979 [debug] [Thread-1  ]: Began running node model.acme.customer_churn_month
[0m02:57:38.467725 [info ] [Thread-1  ]: 1 of 1 START sql view model public.customer_churn_month ........................ [RUN]
[0m02:57:38.469788 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.customer_churn_month"
[0m02:57:38.471755 [debug] [Thread-1  ]: Began compiling node model.acme.customer_churn_month
[0m02:57:38.473524 [debug] [Thread-1  ]: Compiling model.acme.customer_churn_month
[0m02:57:38.478920 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.customer_churn_month"
[0m02:57:38.482754 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:38.484230 [debug] [Thread-1  ]: Began executing node model.acme.customer_churn_month
[0m02:57:38.551406 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.customer_churn_month"
[0m02:57:38.556054 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.557463 [debug] [Thread-1  ]: On model.acme.customer_churn_month: BEGIN
[0m02:57:38.558888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:38.564598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.565700 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.566847 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */

  create view "*****"."public"."customer_churn_month__dbt_tmp" as (
    with mrr as (

    select * from "*****"."public"."customer_revenue_by_month"

),

-- row for month *after* last month of activity
joined as (

    select
        date_month + interval '1 month' as date_month,
        customer_id,
        0::float as mrr,
        false as is_active,
        first_active_month,
        last_active_month,
        false as is_first_month,
        false as is_last_month

    from mrr

    where is_last_month

)

select * from joined
  );
[0m02:57:38.571355 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:57:38.580784 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.582568 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
alter table "*****"."public"."customer_churn_month__dbt_tmp" rename to "customer_churn_month"
[0m02:57:38.584100 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:57:38.608413 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m02:57:38.610397 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.611403 [debug] [Thread-1  ]: On model.acme.customer_churn_month: COMMIT
[0m02:57:38.613406 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.620638 [debug] [Thread-1  ]: Using ***** connection "model.acme.customer_churn_month"
[0m02:57:38.621832 [debug] [Thread-1  ]: On model.acme.customer_churn_month: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.customer_churn_month"} */
drop view if exists "*****"."public"."customer_churn_month__dbt_backup" cascade
[0m02:57:38.624086 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:57:38.626482 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:38.627448 [debug] [Thread-1  ]: On model.acme.customer_churn_month: Close
[0m02:57:38.628942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e81cf26b-c5e9-44d6-84c7-fae1a91e1dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85f74fd0>]}
[0m02:57:38.630350 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.customer_churn_month ................... [[32mCREATE VIEW[0m in 0.16s]
[0m02:57:38.631690 [debug] [Thread-1  ]: Finished running node model.acme.customer_churn_month
[0m02:57:38.637116 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:38.640229 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.641931 [debug] [MainThread]: On master: BEGIN
[0m02:57:38.643386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:38.648847 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:38.650074 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.651032 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:38.652122 [debug] [MainThread]: On master: COMMIT
[0m02:57:38.653442 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:38.654925 [debug] [MainThread]: On master: Close
[0m02:57:38.656543 [info ] [MainThread]: 
[0m02:57:38.658029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m02:57:38.659095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:38.659974 [debug] [MainThread]: Connection 'model.acme.customer_churn_month' was properly closed.
[0m02:57:38.661151 [info ] [MainThread]: 
[0m02:57:38.662190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:57:38.663227 [info ] [MainThread]: 
[0m02:57:38.664473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:57:38.665767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85fa54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85fa5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a85f9aca0>]}
[0m02:57:38.666905 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:57:43.705161 | a782aa2d-38b6-4ac3-8888-344a52799f27 ==============================
[0m02:57:43.705197 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:57:43.706496 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:57:43.707624 [debug] [MainThread]: Tracking: tracking
[0m02:57:43.714529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d64cdb20>]}
[0m02:57:43.886266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:57:43.887173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:57:43.896105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d623afd0>]}
[0m02:57:43.899321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d636f5e0>]}
[0m02:57:43.900406 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:57:43.901658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d636f820>]}
[0m02:57:43.904036 [info ] [MainThread]: 
[0m02:57:43.905541 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:43.907613 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:57:43.922159 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:57:43.924545 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:57:43.925851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:57:43.932040 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:43.934294 [debug] [ThreadPool]: On list_*****: Close
[0m02:57:43.937070 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:57:43.946371 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:43.947635 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:57:43.948932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:57:43.954414 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:57:43.955756 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:57:43.956980 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:57:43.960696 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m02:57:43.965216 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:57:43.967164 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:57:43.976937 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:43.978862 [debug] [MainThread]: On master: BEGIN
[0m02:57:43.980165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:57:43.985883 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:57:43.987283 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:43.988802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:57:43.999763 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m02:57:44.002443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d6499490>]}
[0m02:57:44.003950 [debug] [MainThread]: On master: ROLLBACK
[0m02:57:44.005472 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.006722 [debug] [MainThread]: On master: BEGIN
[0m02:57:44.008464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.009654 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.011023 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.012269 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.013772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.015071 [debug] [MainThread]: On master: Close
[0m02:57:44.016623 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:57:44.017853 [info ] [MainThread]: 
[0m02:57:44.036942 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m02:57:44.038663 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m02:57:44.040538 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m02:57:44.041867 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m02:57:44.043065 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m02:57:44.060050 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:57:44.072156 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m02:57:44.076328 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:44.078236 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m02:57:44.128024 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m02:57:44.132731 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:57:44.133708 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m02:57:44.134868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:57:44.139660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.140875 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:57:44.141870 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - previous_month_mrr as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m02:57:44.145051 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "previous_month_mrr" does not exist
LINE 30:         mrr - previous_month_mrr as mrr_change
                       ^

[0m02:57:44.146296 [debug] [Thread-1  ]: On model.acme.mrr: ROLLBACK
[0m02:57:44.147434 [debug] [Thread-1  ]: finished collecting timing info
[0m02:57:44.148402 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m02:57:44.150220 [debug] [Thread-1  ]: Database Error in model mrr (models/mrr.sql)
  column "previous_month_mrr" does not exist
  LINE 30:         mrr - previous_month_mrr as mrr_change
                         ^
  compiled Code at target/run/acme/models/mrr.sql
[0m02:57:44.151323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a782aa2d-38b6-4ac3-8888-344a52799f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62468e0>]}
[0m02:57:44.152478 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model public.mrr ................................ [[31mERROR[0m in 0.11s]
[0m02:57:44.154141 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m02:57:44.156592 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:57:44.157708 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.158947 [debug] [MainThread]: On master: BEGIN
[0m02:57:44.159856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:57:44.164690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:57:44.165896 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.166966 [debug] [MainThread]: Using ***** connection "master"
[0m02:57:44.167944 [debug] [MainThread]: On master: COMMIT
[0m02:57:44.169093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:57:44.170246 [debug] [MainThread]: On master: Close
[0m02:57:44.171867 [info ] [MainThread]: 
[0m02:57:44.173719 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m02:57:44.175043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:57:44.176142 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m02:57:44.177438 [info ] [MainThread]: 
[0m02:57:44.179010 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:57:44.180174 [info ] [MainThread]: 
[0m02:57:44.181696 [error] [MainThread]: [33mDatabase Error in model mrr (models/mrr.sql)[0m
[0m02:57:44.182910 [error] [MainThread]:   column "previous_month_mrr" does not exist
[0m02:57:44.184164 [error] [MainThread]:   LINE 30:         mrr - previous_month_mrr as mrr_change
[0m02:57:44.185356 [error] [MainThread]:                          ^
[0m02:57:44.186489 [error] [MainThread]:   compiled Code at target/run/acme/models/mrr.sql
[0m02:57:44.187572 [info ] [MainThread]: 
[0m02:57:44.188603 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:57:44.189646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d59c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30d62466d0>]}
[0m02:57:44.190717 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:58:46.063956 | 9974b9be-4c7c-4799-b27d-55f90f4428b7 ==============================
[0m02:58:46.063987 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:46.067322 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'select': ['mrr'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m02:58:46.068716 [debug] [MainThread]: Tracking: tracking
[0m02:58:46.078936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae198b5b50>]}
[0m02:58:46.365834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:58:46.367445 [debug] [MainThread]: Partial parsing: updated file: acme://models/mrr.sql
[0m02:58:46.390101 [debug] [MainThread]: 1603: static parser failed on mrr.sql
[0m02:58:46.414505 [warn ] [MainThread]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:58:46.445849 [debug] [MainThread]: 1602: parser fallback to jinja rendering on mrr.sql
[0m02:58:46.584316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196770d0>]}
[0m02:58:46.587463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196ff400>]}
[0m02:58:46.588967 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:46.590265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae1964bfd0>]}
[0m02:58:46.598692 [info ] [MainThread]: 
[0m02:58:46.601127 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:46.603434 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****"
[0m02:58:46.620503 [debug] [ThreadPool]: Using ***** connection "list_*****"
[0m02:58:46.622194 [debug] [ThreadPool]: On list_*****: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****"} */

    select distinct nspname from pg_namespace
  
[0m02:58:46.623522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:46.631299 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.01 seconds
[0m02:58:46.634526 [debug] [ThreadPool]: On list_*****: Close
[0m02:58:46.637710 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:46.649293 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:46.650714 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:46.651935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:58:46.657051 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.658289 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:46.659399 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:46.663765 [debug] [ThreadPool]: SQL status: SELECT 54 in 0.0 seconds
[0m02:58:46.668112 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:46.669899 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:46.678884 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.680574 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.682081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:46.688446 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.690063 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.691149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:46.702100 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
[0m02:58:46.705129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae196cd730>]}
[0m02:58:46.706558 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:46.708868 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.712471 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.714533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:46.716148 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.717590 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.718856 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.720262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.721788 [debug] [MainThread]: On master: Close
[0m02:58:46.723524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:46.724845 [info ] [MainThread]: 
[0m02:58:46.743139 [debug] [Thread-1  ]: Began running node model.acme.mrr
[0m02:58:46.744899 [info ] [Thread-1  ]: 1 of 1 START sql view model public.mrr ......................................... [RUN]
[0m02:58:46.746889 [debug] [Thread-1  ]: Acquiring new ***** connection "model.acme.mrr"
[0m02:58:46.748330 [debug] [Thread-1  ]: Began compiling node model.acme.mrr
[0m02:58:46.749823 [debug] [Thread-1  ]: Compiling model.acme.mrr
[0m02:58:46.756671 [warn ] [Thread-1  ]: 
Warning: the `surrogate_key` macro now takes a single list argument instead of multiple string arguments. Support for multiple string arguments will be deprecated in a future release of dbt-utils. The acme.mrr model triggered this warning. 
[0m02:58:46.759906 [debug] [Thread-1  ]: Writing injected SQL for node "model.acme.mrr"
[0m02:58:46.766604 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:46.767986 [debug] [Thread-1  ]: Began executing node model.acme.mrr
[0m02:58:46.822178 [debug] [Thread-1  ]: Writing runtime sql for node "model.acme.mrr"
[0m02:58:46.839016 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.840326 [debug] [Thread-1  ]: On model.acme.mrr: BEGIN
[0m02:58:46.841547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:46.846605 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:46.848151 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.849558 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */

  create view "*****"."public"."mrr__dbt_tmp" as (
    with unioned as (

    select * from "*****"."public"."customer_revenue_by_month"

    union all

    select * from "*****"."public"."customer_churn_month"

),

-- get prior month MRR and calculate MRR change
mrr_with_changes as (

    select
        *,

        coalesce(
            lag(is_active) over (partition by customer_id order by date_month),
            false
        ) as previous_month_is_active,

        coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as previous_month_mrr,

        mrr - coalesce(
            lag(mrr) over (partition by customer_id order by date_month),
            0
        ) as mrr_change

    from unioned

),

-- classify months as new, churn, reactivation, upgrade, downgrade (or null)
-- also add an ID column
final as (

    select
        md5(cast(coalesce(cast(date_month as 
    varchar
), '') || '-' || coalesce(cast(customer_id as 
    varchar
), '') as 
    varchar
)) as id,

        *,

        case
            when is_first_month
                then 'new'
            when not(is_active) and previous_month_is_active
                then 'churn'
            when is_active and not(previous_month_is_active)
                then 'reactivation'
            when mrr_change > 0 then 'upgrade'
            when mrr_change < 0 then 'downgrade'
        end as change_category,

        least(mrr, previous_month_mrr) as renewal_amount

    from mrr_with_changes

)

select * from final
  );
[0m02:58:46.856287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
[0m02:58:46.878097 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.879866 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
alter table "*****"."public"."mrr__dbt_tmp" rename to "mrr"
[0m02:58:46.882319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:58:46.906736 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m02:58:46.908399 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.909504 [debug] [Thread-1  ]: On model.acme.mrr: COMMIT
[0m02:58:46.912542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.920554 [debug] [Thread-1  ]: Using ***** connection "model.acme.mrr"
[0m02:58:46.921692 [debug] [Thread-1  ]: On model.acme.mrr: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "model.acme.mrr"} */
drop view if exists "*****"."public"."mrr__dbt_backup" cascade
[0m02:58:46.923282 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m02:58:46.925720 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:46.926916 [debug] [Thread-1  ]: On model.acme.mrr: Close
[0m02:58:46.928645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9974b9be-4c7c-4799-b27d-55f90f4428b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d1be80>]}
[0m02:58:46.929877 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.mrr .................................... [[32mCREATE VIEW[0m in 0.18s]
[0m02:58:46.931693 [debug] [Thread-1  ]: Finished running node model.acme.mrr
[0m02:58:46.934726 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:46.935937 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.937066 [debug] [MainThread]: On master: BEGIN
[0m02:58:46.937987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:46.942711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:46.943824 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.944973 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:46.945920 [debug] [MainThread]: On master: COMMIT
[0m02:58:46.947172 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:46.948167 [debug] [MainThread]: On master: Close
[0m02:58:46.950030 [info ] [MainThread]: 
[0m02:58:46.951182 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m02:58:46.952621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:46.953585 [debug] [MainThread]: Connection 'model.acme.mrr' was properly closed.
[0m02:58:46.954705 [info ] [MainThread]: 
[0m02:58:46.955804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:46.956843 [info ] [MainThread]: 
[0m02:58:46.957893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:58:46.959028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d13610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d136a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae18d13790>]}
[0m02:58:46.960185 [debug] [MainThread]: Flushing usage events


============================== 2022-12-01 02:58:56.415066 | 6d54f8a0-b4cf-481a-b60f-22db2dc59a9e ==============================
[0m02:58:56.415095 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.417701 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['util_months'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.420986 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.431945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90dea22b20>]}


============================== 2022-12-01 02:58:56.705314 | 1e085a1d-d729-4194-bb39-d29f357a68d2 ==============================
[0m02:58:56.705615 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.776751 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['mrr'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.786709 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.861070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92eab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92ea430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a92eaac0>]}


============================== 2022-12-01 02:58:56.876464 | 9a8e7588-403c-41cb-8221-40db93c48d8a ==============================
[0m02:58:56.876725 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.880039 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_churn_month'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.888964 [debug] [MainThread]: Tracking: tracking
[0m02:58:56.907416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb91235af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8beac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8beac730>]}


============================== 2022-12-01 02:58:56.984086 | 60809037-edbb-4a68-8b54-f9f8c95ed283 ==============================
[0m02:58:56.984126 [info ] [MainThread]: Running with dbt=1.3.1
[0m02:58:56.988163 [debug] [MainThread]: running dbt with arguments {'write_json': False, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/usr/local/airflow/include/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/usr/local/airflow/include/dbt/mrr-playbook', 'target': 'dev', 'indirect_selection': 'eager', 'select': ['customer_revenue_by_month'], 'which': 'test', 'rpc_method': 'test'}
[0m02:58:56.993177 [debug] [MainThread]: Tracking: tracking
[0m02:58:57.003702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a8b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57535a8b50>]}
[0m02:58:57.250301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.252589 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.268629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de7980d0>]}
[0m02:58:57.274434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1610>]}
[0m02:58:57.277397 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.279295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d54f8a0-b4cf-481a-b60f-22db2dc59a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1850>]}
[0m02:58:57.284734 [info ] [MainThread]: 
[0m02:58:57.287186 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
[0m02:58:57.290323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90de8b1430>]}
[0m02:58:57.292633 [debug] [MainThread]: Flushing usage events
[0m02:58:57.430832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.434905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.462625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bc21fa0>]}
[0m02:58:57.469095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a5b0>]}
[0m02:58:57.472233 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.474450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a7f0>]}
[0m02:58:57.480801 [info ] [MainThread]: 
[0m02:58:57.484189 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.491167 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.535598 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.538538 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.542752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.559403 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.560459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.560964 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.563954 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.562600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.568757 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m02:58:57.574119 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.576670 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.590306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a90590d0>]}
[0m02:58:57.590576 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.594948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e610>]}
[0m02:58:57.597700 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.600916 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.602187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.603758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e850>]}
[0m02:58:57.612242 [info ] [MainThread]: 
[0m02:58:57.611743 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.615570 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.615682 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.617338 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.621255 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.630652 [debug] [MainThread]: SQL status: SELECT 8 in 0.01 seconds
[0m02:58:57.635612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8e7588-403c-41cb-8221-40db93c48d8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8bd3a400>]}
[0m02:58:57.631042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:58:57.638795 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.641016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:58:57.642887 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.645024 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.647900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.648942 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.650479 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.652231 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.653704 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.655227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.656727 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.659258 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.661179 [debug] [MainThread]: On master: Close
[0m02:58:57.663512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.662534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5753314fa0>]}
[0m02:58:57.667397 [info ] [MainThread]: 
[0m02:58:57.664867 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.672872 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.675101 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.679073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c5b0>]}
[0m02:58:57.679848 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.0 seconds
[0m02:58:57.680671 [info ] [MainThread]: Found 4 models, 21 tests, 0 snapshots, 0 analyses, 477 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics
[0m02:58:57.682540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c7f0>]}
[0m02:58:57.685436 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.685627 [info ] [MainThread]: 
[0m02:58:57.687229 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.688813 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:57.692283 [debug] [Thread-1  ]: Began running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.693631 [info ] [Thread-1  ]: 1 of 2 START test not_null_customer_churn_month_customer_id .................... [RUN]
[0m02:58:57.695546 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.696362 [debug] [ThreadPool]: Acquiring new ***** connection "list_*****_public"
[0m02:58:57.696507 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.698581 [debug] [Thread-1  ]: Compiling test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.698623 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.700990 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.702164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.708008 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.709925 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.711068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.725115 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.728716 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m02:58:57.728853 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.732236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e085a1d-d729-4194-bb39-d29f357a68d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a916e3a0>]}
[0m02:58:57.733110 [debug] [ThreadPool]: On list_*****_public: BEGIN
[0m02:58:57.734914 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.736204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:58:57.737857 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.741135 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.750335 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.755531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.759307 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.757340 [debug] [ThreadPool]: Using ***** connection "list_*****_public"
[0m02:58:57.759971 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.760977 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.771433 [debug] [ThreadPool]: On list_*****_public: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "list_*****_public"} */
select
      '*****' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      '*****' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m02:58:57.774133 [debug] [Thread-1  ]: Began executing node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.780210 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.787435 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.798173 [debug] [ThreadPool]: SQL status: SELECT 55 in 0.02 seconds
[0m02:58:57.798944 [debug] [MainThread]: On master: Close
[0m02:58:57.804787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.808555 [info ] [MainThread]: 
[0m02:58:57.807966 [debug] [ThreadPool]: On list_*****_public: ROLLBACK
[0m02:58:57.821096 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.824439 [debug] [ThreadPool]: On list_*****_public: Close
[0m02:58:57.835021 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.836639 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.841996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:58:57.847298 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.852648 [info ] [Thread-1  ]: 1 of 15 START test dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [RUN]
[0m02:58:57.849662 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.861185 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: BEGIN
[0m02:58:57.862419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:57.858699 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.865998 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.863791 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.867544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:58:57.868359 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.873352 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.885179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m02:58:57.887659 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"
[0m02:58:57.893229 [debug] [MainThread]: SQL status: SELECT 8 in 0.02 seconds
[0m02:58:57.893958 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_customer_churn_month_customer_id.99e28f508c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."customer_churn_month"
where customer_id is null



      
    ) dbt_internal_test
[0m02:58:57.897300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60809037-edbb-4a68-8b54-f9f8c95ed283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f575342c400>]}
[0m02:58:57.900280 [debug] [MainThread]: On master: ROLLBACK
[0m02:58:57.902885 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.907415 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.909199 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:57.914463 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.909605 [debug] [MainThread]: On master: BEGIN
[0m02:58:57.913993 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.915337 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: ROLLBACK
[0m02:58:57.917821 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:57.919436 [debug] [Thread-1  ]: On test.acme.not_null_customer_churn_month_customer_id.99e28f508c: Close
[0m02:58:57.918534 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:58:57.945326 [info ] [Thread-1  ]: 1 of 2 PASS not_null_customer_churn_month_customer_id .......................... [[32mPASS[0m in 0.25s]
[0m02:58:57.946753 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.948665 [debug] [Thread-1  ]: Finished running node test.acme.not_null_customer_churn_month_customer_id.99e28f508c
[0m02:58:57.950324 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:57.952188 [debug] [Thread-1  ]: Began running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.953444 [debug] [MainThread]: On master: COMMIT
[0m02:58:57.954975 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.954714 [info ] [Thread-1  ]: 2 of 2 START test unique_customer_churn_month_customer_id ...................... [RUN]
[0m02:58:57.956437 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:57.960265 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:57.960739 [debug] [MainThread]: On master: Close
[0m02:58:57.961994 [debug] [Thread-1  ]: Began compiling node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.964455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:58:57.967027 [info ] [MainThread]: 
[0m02:58:57.965039 [debug] [Thread-1  ]: Compiling test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:57.966490 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.969738 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: BEGIN
[0m02:58:57.971680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:57.980611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:57.981994 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:57.982460 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"
[0m02:58:57.985715 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as (
    select * from "*****"."public"."mrr" where 1=1
)

select
    *
from meet_condition

where not(date_month <= date_trunc('month', current_date))


      
    ) dbt_internal_test
[0m02:58:57.991387 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:57.993031 [info ] [Thread-1  ]: 1 of 1 START test dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [RUN]
[0m02:58:57.995698 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:57.997056 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:57.997485 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:57.998740 [debug] [Thread-1  ]: Began executing node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:58.000349 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.006329 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.012409 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.013935 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: BEGIN
[0m02:58:58.015100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.016386 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.03 seconds
[0m02:58:58.021637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.023394 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"
[0m02:58:58.024251 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.024962 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_customer_churn_month_customer_id.a402b7af3f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "*****"."public"."customer_churn_month"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:58:58.026616 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: ROLLBACK
[0m02:58:58.029099 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.029617 [debug] [Thread-1  ]: On test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6: Close
[0m02:58:58.035107 [info ] [Thread-1  ]: 1 of 15 PASS dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_  [[32mPASS[0m in 0.17s]
[0m02:58:58.037220 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_expression_is_true_mrr_date_month_date_trunc_month_current_date_.8e3ee48bc6
[0m02:58:58.039381 [debug] [Thread-1  ]: Began running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.039667 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.041367 [info ] [Thread-1  ]: 2 of 15 START test dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [RUN]
[0m02:58:58.043784 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.044568 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.045305 [debug] [Thread-1  ]: Began compiling node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.047040 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: ROLLBACK
[0m02:58:58.083186 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.084863 [debug] [Thread-1  ]: Compiling test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.088086 [debug] [Thread-1  ]: On test.acme.unique_customer_churn_month_customer_id.a402b7af3f: Close
[0m02:58:58.090511 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.093454 [info ] [Thread-1  ]: 2 of 2 PASS unique_customer_churn_month_customer_id ............................ [[32mPASS[0m in 0.13s]
[0m02:58:58.097947 [debug] [Thread-1  ]: Finished running node test.acme.unique_customer_churn_month_customer_id.a402b7af3f
[0m02:58:58.102563 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:58.104331 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.106114 [debug] [MainThread]: On master: BEGIN
[0m02:58:58.108020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:58.118227 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.120925 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.123213 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.125747 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.126248 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.134991 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m02:58:58.139394 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.190734 [debug] [MainThread]: On master: Close
[0m02:58:58.193935 [info ] [MainThread]: 
[0m02:58:58.196752 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m02:58:58.203367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:58.198502 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.199386 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.213397 [debug] [Thread-1  ]: Began executing node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.210886 [debug] [MainThread]: Connection 'test.acme.unique_customer_churn_month_customer_id.a402b7af3f' was properly closed.
[0m02:58:58.214282 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: BEGIN
[0m02:58:58.222851 [info ] [MainThread]: 
[0m02:58:58.224964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.225741 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.228122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:58.232658 [info ] [MainThread]: 
[0m02:58:58.236076 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m02:58:58.237413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.239183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b3d9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b3990a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb8b399040>]}
[0m02:58:58.240109 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"
[0m02:58:58.242426 [debug] [MainThread]: Flushing usage events
[0m02:58:58.243632 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."customer_revenue_by_month"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:58:58.248078 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.254432 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.253591 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: BEGIN
[0m02:58:58.257430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.262290 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.264640 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: ROLLBACK
[0m02:58:58.265468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.266764 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716: Close
[0m02:58:58.268427 [debug] [Thread-1  ]: Using ***** connection "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"
[0m02:58:58.271222 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        customer_id, date_month
    from "*****"."public"."mrr"
    group by customer_id, date_month
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m02:58:58.271443 [info ] [Thread-1  ]: 1 of 1 PASS dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month  [[32mPASS[0m in 0.28s]
[0m02:58:58.275635 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716
[0m02:58:58.282489 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:58.284553 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.286328 [debug] [MainThread]: On master: BEGIN
[0m02:58:58.287953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:58.291620 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.295372 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.296995 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.299023 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.297477 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: ROLLBACK
[0m02:58:58.301272 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:58.303847 [debug] [MainThread]: On master: COMMIT
[0m02:58:58.302596 [debug] [Thread-1  ]: On test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb: Close
[0m02:58:58.305820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:58.308676 [debug] [MainThread]: On master: Close
[0m02:58:58.311583 [info ] [MainThread]: 
[0m02:58:58.307468 [info ] [Thread-1  ]: 2 of 15 PASS dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month  [[32mPASS[0m in 0.26s]
[0m02:58:58.313832 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m02:58:58.315692 [debug] [Thread-1  ]: Finished running node test.acme.dbt_utils_unique_combination_of_columns_mrr_customer_id__date_month.7a5b0199cb
[0m02:58:58.320730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:58.322286 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.323342 [debug] [MainThread]: Connection 'test.acme.dbt_utils_unique_combination_of_columns_customer_revenue_by_month_customer_id__date_month.e8886ba716' was properly closed.
[0m02:58:58.325334 [info ] [Thread-1  ]: 3 of 15 START test not_null_mrr_customer_id .................................... [RUN]
[0m02:58:58.326603 [info ] [MainThread]: 
[0m02:58:58.328844 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.329389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:58.330288 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.332157 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.331393 [info ] [MainThread]: 
[0m02:58:58.334872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:58:58.336771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752acca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752a8b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5752a8b040>]}
[0m02:58:58.339064 [debug] [MainThread]: Flushing usage events
[0m02:58:58.352566 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.361729 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.363299 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.372862 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.378942 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.380463 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: BEGIN
[0m02:58:58.381880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.388569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.390262 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_customer_id.adf44c0fb5"
[0m02:58:58.391786 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_customer_id.adf44c0fb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "*****"."public"."mrr"
where customer_id is null



      
    ) dbt_internal_test
[0m02:58:58.404519 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.408985 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.411035 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: ROLLBACK
[0m02:58:58.413012 [debug] [Thread-1  ]: On test.acme.not_null_mrr_customer_id.adf44c0fb5: Close
[0m02:58:58.415388 [info ] [Thread-1  ]: 3 of 15 PASS not_null_mrr_customer_id .......................................... [[32mPASS[0m in 0.09s]
[0m02:58:58.418477 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_customer_id.adf44c0fb5
[0m02:58:58.420307 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.421768 [info ] [Thread-1  ]: 4 of 15 START test not_null_mrr_date_month ..................................... [RUN]
[0m02:58:58.424024 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.425470 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.427111 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.435119 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.447353 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.449380 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.455243 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.461313 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.463006 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: BEGIN
[0m02:58:58.464611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.471812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.473676 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_date_month.d7121d9ce6"
[0m02:58:58.475128 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_date_month.d7121d9ce6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_month
from "*****"."public"."mrr"
where date_month is null



      
    ) dbt_internal_test
[0m02:58:58.489876 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.493755 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.495432 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: ROLLBACK
[0m02:58:58.497088 [debug] [Thread-1  ]: On test.acme.not_null_mrr_date_month.d7121d9ce6: Close
[0m02:58:58.499495 [info ] [Thread-1  ]: 4 of 15 PASS not_null_mrr_date_month ........................................... [[32mPASS[0m in 0.08s]
[0m02:58:58.502235 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_date_month.d7121d9ce6
[0m02:58:58.503433 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.504641 [info ] [Thread-1  ]: 5 of 15 START test not_null_mrr_first_active_month ............................. [RUN]
[0m02:58:58.506495 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.508108 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.509379 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.516781 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.528282 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.530049 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.534848 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.547237 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.548679 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: BEGIN
[0m02:58:58.550155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.556920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.558679 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_first_active_month.a9078832e9"
[0m02:58:58.559966 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_first_active_month.a9078832e9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_active_month
from "*****"."public"."mrr"
where first_active_month is null



      
    ) dbt_internal_test
[0m02:58:58.575958 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:58.581209 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.583347 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: ROLLBACK
[0m02:58:58.585416 [debug] [Thread-1  ]: On test.acme.not_null_mrr_first_active_month.a9078832e9: Close
[0m02:58:58.587457 [info ] [Thread-1  ]: 5 of 15 PASS not_null_mrr_first_active_month ................................... [[32mPASS[0m in 0.08s]
[0m02:58:58.589485 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_first_active_month.a9078832e9
[0m02:58:58.591414 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.595462 [info ] [Thread-1  ]: 6 of 15 START test not_null_mrr_id ............................................. [RUN]
[0m02:58:58.598843 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.600679 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.602095 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.613151 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.620169 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.622187 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.628996 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.647919 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.649898 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: BEGIN
[0m02:58:58.651746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.659442 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.660987 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_id.45914052fb"
[0m02:58:58.662568 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_id.45914052fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "*****"."public"."mrr"
where id is null



      
    ) dbt_internal_test
[0m02:58:58.679717 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.685375 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.687622 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: ROLLBACK
[0m02:58:58.689998 [debug] [Thread-1  ]: On test.acme.not_null_mrr_id.45914052fb: Close
[0m02:58:58.692563 [info ] [Thread-1  ]: 6 of 15 PASS not_null_mrr_id ................................................... [[32mPASS[0m in 0.10s]
[0m02:58:58.695028 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_id.45914052fb
[0m02:58:58.696842 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.698462 [info ] [Thread-1  ]: 7 of 15 START test not_null_mrr_is_active ...................................... [RUN]
[0m02:58:58.700649 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.702352 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.704155 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.719411 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.727491 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.730234 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.737054 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.749050 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.751468 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: BEGIN
[0m02:58:58.753437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.765224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.767535 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_active.66e2203f7d"
[0m02:58:58.769479 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_active.66e2203f7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_active
from "*****"."public"."mrr"
where is_active is null



      
    ) dbt_internal_test
[0m02:58:58.786583 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.792888 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.795671 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: ROLLBACK
[0m02:58:58.797964 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_active.66e2203f7d: Close
[0m02:58:58.800547 [info ] [Thread-1  ]: 7 of 15 PASS not_null_mrr_is_active ............................................ [[32mPASS[0m in 0.10s]
[0m02:58:58.803163 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_active.66e2203f7d
[0m02:58:58.805100 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.807009 [info ] [Thread-1  ]: 8 of 15 START test not_null_mrr_is_first_month ................................. [RUN]
[0m02:58:58.809740 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.812261 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.813944 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.827519 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.848290 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.850714 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.859784 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.867929 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.871327 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: BEGIN
[0m02:58:58.874830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.883276 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.885429 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_first_month.97ecc2049e"
[0m02:58:58.887231 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_first_month.97ecc2049e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_first_month
from "*****"."public"."mrr"
where is_first_month is null



      
    ) dbt_internal_test
[0m02:58:58.903916 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:58.910960 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.914367 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: ROLLBACK
[0m02:58:58.917500 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_first_month.97ecc2049e: Close
[0m02:58:58.920180 [info ] [Thread-1  ]: 8 of 15 PASS not_null_mrr_is_first_month ....................................... [[32mPASS[0m in 0.11s]
[0m02:58:58.929293 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_first_month.97ecc2049e
[0m02:58:58.931449 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.933204 [info ] [Thread-1  ]: 9 of 15 START test not_null_mrr_is_last_month .................................. [RUN]
[0m02:58:58.936291 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.938745 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.940725 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.950649 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.958392 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:58.960436 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:58.968288 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.977072 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.979171 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: BEGIN
[0m02:58:58.980958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:58.990587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:58.992639 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_is_last_month.a91990c0de"
[0m02:58:58.994244 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_is_last_month.a91990c0de"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_last_month
from "*****"."public"."mrr"
where is_last_month is null



      
    ) dbt_internal_test
[0m02:58:59.018333 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:59.022339 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.024157 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: ROLLBACK
[0m02:58:59.026257 [debug] [Thread-1  ]: On test.acme.not_null_mrr_is_last_month.a91990c0de: Close
[0m02:58:59.029924 [info ] [Thread-1  ]: 9 of 15 PASS not_null_mrr_is_last_month ........................................ [[32mPASS[0m in 0.09s]
[0m02:58:59.032322 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_is_last_month.a91990c0de
[0m02:58:59.034004 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.035509 [info ] [Thread-1  ]: 10 of 15 START test not_null_mrr_last_active_month ............................. [RUN]
[0m02:58:59.037864 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.060804 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.070937 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.086889 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.098494 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.099945 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.105006 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.111100 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.112712 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: BEGIN
[0m02:58:59.114033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.120859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.122574 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_last_active_month.c5f2565121"
[0m02:58:59.124463 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_last_active_month.c5f2565121"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_active_month
from "*****"."public"."mrr"
where last_active_month is null



      
    ) dbt_internal_test
[0m02:58:59.141556 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.149898 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.152361 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: ROLLBACK
[0m02:58:59.154142 [debug] [Thread-1  ]: On test.acme.not_null_mrr_last_active_month.c5f2565121: Close
[0m02:58:59.156319 [info ] [Thread-1  ]: 10 of 15 PASS not_null_mrr_last_active_month ................................... [[32mPASS[0m in 0.12s]
[0m02:58:59.158835 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_last_active_month.c5f2565121
[0m02:58:59.160525 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.162271 [info ] [Thread-1  ]: 11 of 15 START test not_null_mrr_mrr ........................................... [RUN]
[0m02:58:59.164680 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.166489 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.168239 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.180471 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.203839 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.209999 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.218077 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.227182 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.228816 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: BEGIN
[0m02:58:59.230267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.246695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m02:58:59.248555 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr.7e419847d2"
[0m02:58:59.249954 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr.7e419847d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr
from "*****"."public"."mrr"
where mrr is null



      
    ) dbt_internal_test
[0m02:58:59.266004 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.269632 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.271328 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: ROLLBACK
[0m02:58:59.272877 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr.7e419847d2: Close
[0m02:58:59.275295 [info ] [Thread-1  ]: 11 of 15 PASS not_null_mrr_mrr ................................................. [[32mPASS[0m in 0.11s]
[0m02:58:59.278462 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr.7e419847d2
[0m02:58:59.281308 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.282680 [info ] [Thread-1  ]: 12 of 15 START test not_null_mrr_mrr_change .................................... [RUN]
[0m02:58:59.285060 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.287128 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.288589 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.298352 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.308906 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.310868 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.316047 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.327296 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.329752 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: BEGIN
[0m02:58:59.330961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.337316 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.338954 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_mrr_change.0329647bd8"
[0m02:58:59.340243 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_mrr_change.0329647bd8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select mrr_change
from "*****"."public"."mrr"
where mrr_change is null



      
    ) dbt_internal_test
[0m02:58:59.354650 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.358100 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.359648 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: ROLLBACK
[0m02:58:59.361865 [debug] [Thread-1  ]: On test.acme.not_null_mrr_mrr_change.0329647bd8: Close
[0m02:58:59.363798 [info ] [Thread-1  ]: 12 of 15 PASS not_null_mrr_mrr_change .......................................... [[32mPASS[0m in 0.08s]
[0m02:58:59.365585 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_mrr_change.0329647bd8
[0m02:58:59.367179 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.369202 [info ] [Thread-1  ]: 13 of 15 START test not_null_mrr_previous_month_is_active ...................... [RUN]
[0m02:58:59.371449 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.372815 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.374076 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.382047 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.397505 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.398895 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.405113 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.410462 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.411666 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: BEGIN
[0m02:58:59.413052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.418868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.420689 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"
[0m02:58:59.422140 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_is_active.836f1724d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_is_active
from "*****"."public"."mrr"
where previous_month_is_active is null



      
    ) dbt_internal_test
[0m02:58:59.437641 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.442334 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.443910 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: ROLLBACK
[0m02:58:59.445551 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_is_active.836f1724d2: Close
[0m02:58:59.448353 [info ] [Thread-1  ]: 13 of 15 PASS not_null_mrr_previous_month_is_active ............................ [[32mPASS[0m in 0.08s]
[0m02:58:59.453198 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_is_active.836f1724d2
[0m02:58:59.454876 [debug] [Thread-1  ]: Began running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.456224 [info ] [Thread-1  ]: 14 of 15 START test not_null_mrr_previous_month_mrr ............................ [RUN]
[0m02:58:59.459020 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.460510 [debug] [Thread-1  ]: Began compiling node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.462474 [debug] [Thread-1  ]: Compiling test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.470490 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.475990 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.477593 [debug] [Thread-1  ]: Began executing node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.486953 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.497710 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.499264 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: BEGIN
[0m02:58:59.500446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.506929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.508847 [debug] [Thread-1  ]: Using ***** connection "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"
[0m02:58:59.510092 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select previous_month_mrr
from "*****"."public"."mrr"
where previous_month_mrr is null



      
    ) dbt_internal_test
[0m02:58:59.525435 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
[0m02:58:59.532339 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.534316 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: ROLLBACK
[0m02:58:59.536084 [debug] [Thread-1  ]: On test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7: Close
[0m02:58:59.538729 [info ] [Thread-1  ]: 14 of 15 PASS not_null_mrr_previous_month_mrr .................................. [[32mPASS[0m in 0.08s]
[0m02:58:59.541935 [debug] [Thread-1  ]: Finished running node test.acme.not_null_mrr_previous_month_mrr.9a7dfac4d7
[0m02:58:59.543537 [debug] [Thread-1  ]: Began running node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.545024 [info ] [Thread-1  ]: 15 of 15 START test unique_mrr_id .............................................. [RUN]
[0m02:58:59.547558 [debug] [Thread-1  ]: Acquiring new ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.548984 [debug] [Thread-1  ]: Began compiling node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.550159 [debug] [Thread-1  ]: Compiling test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.562800 [debug] [Thread-1  ]: Writing injected SQL for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.568293 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.569875 [debug] [Thread-1  ]: Began executing node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.575638 [debug] [Thread-1  ]: Writing runtime sql for node "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.599190 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.600819 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: BEGIN
[0m02:58:59.602484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:58:59.609710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.611568 [debug] [Thread-1  ]: Using ***** connection "test.acme.unique_mrr_id.a14d6c26bd"
[0m02:58:59.613132 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "my-*****-db", "target_name": "dev", "node_id": "test.acme.unique_mrr_id.a14d6c26bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "*****"."public"."mrr"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:58:59.635411 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
[0m02:58:59.639352 [debug] [Thread-1  ]: finished collecting timing info
[0m02:58:59.642302 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: ROLLBACK
[0m02:58:59.644472 [debug] [Thread-1  ]: On test.acme.unique_mrr_id.a14d6c26bd: Close
[0m02:58:59.646329 [info ] [Thread-1  ]: 15 of 15 PASS unique_mrr_id .................................................... [[32mPASS[0m in 0.10s]
[0m02:58:59.648981 [debug] [Thread-1  ]: Finished running node test.acme.unique_mrr_id.a14d6c26bd
[0m02:58:59.652363 [debug] [MainThread]: Acquiring new ***** connection "master"
[0m02:58:59.653553 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:59.654723 [debug] [MainThread]: On master: BEGIN
[0m02:58:59.655870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:58:59.661557 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
[0m02:58:59.663125 [debug] [MainThread]: On master: COMMIT
[0m02:58:59.664365 [debug] [MainThread]: Using ***** connection "master"
[0m02:58:59.665507 [debug] [MainThread]: On master: COMMIT
[0m02:58:59.666828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:58:59.668173 [debug] [MainThread]: On master: Close
[0m02:58:59.670150 [info ] [MainThread]: 
[0m02:58:59.671938 [info ] [MainThread]: Finished running 15 tests in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m02:58:59.673840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:58:59.675906 [debug] [MainThread]: Connection 'test.acme.unique_mrr_id.a14d6c26bd' was properly closed.
[0m02:58:59.678805 [info ] [MainThread]: 
[0m02:58:59.681634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:58:59.683353 [info ] [MainThread]: 
[0m02:58:59.684921 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
[0m02:58:59.686382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87cebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87ceb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68a87ce4c0>]}
[0m02:58:59.687948 [debug] [MainThread]: Flushing usage events
